import{r as e,j as s,l as t,m,n as a,o as n,B as r,U as i,K as o,C as l,p as h,q as c,S as d,s as u,h as g}from"./react-D6UPbbTV.js";import{u as b,a as N,D as x,c as y,S as f,r as p,b as v,s as D,K as w,P as j,d as k,C as E}from"./dnd-DkbfiC5f.js";import{u as V,i as S,f as C,g as I}from"./index-r4f2dEef.js";import{L as B}from"./vendor-CKbz-9sG.js";import"./react-dom-BT3gIiCK.js";import"./supabase-BE3bwnEA.js";import"./toast-C6NSsgfd.js";const K={Clock:g,BarChart3:u,Settings:d,Users:c,Building2:h,CheckCircle:l,Shield:m,Key:o,User:i,Building:r,Cog:n,Activity:a};function P({module:e,index:t,isDragMode:m}){const{attributes:a,listeners:n,setNodeRef:r,transform:i,transition:o,isDragging:l}=k({id:e.id}),h={transform:E.Transform.toString(i),transition:o},c=K[e.icon];return e.isPlaceholder?null:s.jsxDEV("div",{ref:r,style:h,className:"transition-all duration-200 ".concat(l?"transform rotate-3 scale-105 shadow-2xl shadow-green-500/20 opacity-50 z-50":""," ").concat(m?"cursor-grabbing":""),children:s.jsxDEV("div",{...a,...n,className:"".concat(m?"cursor-grabbing":"cursor-pointer"),children:s.jsxDEV(B,{to:e.path,className:"group block",onClick:e=>{m&&(e.preventDefault(),e.stopPropagation())},children:s.jsxDEV("div",{className:"relative bg-gray-800 rounded-xl border border-gray-700 hover:border-green-400/60 transition-all duration-300 hover:transform hover:scale-[1.02] hover:shadow-xl hover:shadow-green-500/10 min-h-[140px] backdrop-blur-sm ".concat(m?"pointer-events-none":""),children:[s.jsxDEV("div",{className:"bg-gray-800 border-b border-green-600 p-4 rounded-t-xl",children:s.jsxDEV("div",{className:"flex items-center justify-between",children:[s.jsxDEV("div",{className:"flex items-center space-x-3",children:[s.jsxDEV("div",{className:"w-8 h-8 bg-gradient-to-br from-green-500 to-green-600 rounded-lg flex items-center justify-center group-hover:from-green-400 group-hover:to-green-500 transition-all duration-300",children:s.jsxDEV(c,{className:"w-5 h-5 text-white"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:119,columnNumber:21},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:118,columnNumber:19},this),s.jsxDEV("h3",{className:"text-white font-bold text-lg group-hover:text-green-100 transition-colors",children:e.name},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:121,columnNumber:19},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:117,columnNumber:17},this),s.jsxDEV("div",{className:"transition-opacity ".concat(m?"opacity-100":"opacity-0 group-hover:opacity-100"),children:s.jsxDEV("div",{className:"flex flex-col gap-1",children:[s.jsxDEV("div",{className:"w-1.5 h-1.5 bg-green-400 rounded-full"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:128,columnNumber:21},this),s.jsxDEV("div",{className:"w-1.5 h-1.5 bg-green-400 rounded-full"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:129,columnNumber:21},this),s.jsxDEV("div",{className:"w-1.5 h-1.5 bg-green-400 rounded-full"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:130,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:127,columnNumber:19},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:124,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:116,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:115,columnNumber:13},this),s.jsxDEV("div",{className:"p-6 flex flex-col items-center justify-center",children:s.jsxDEV("p",{className:"text-gray-400 text-sm text-center leading-relaxed group-hover:text-gray-300 transition-colors",children:e.description},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:139,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:137,columnNumber:13},this),m&&s.jsxDEV("div",{className:"absolute inset-0 bg-green-500/10 rounded-xl border-2 border-green-400/50 flex items-center justify-center backdrop-blur-sm",children:s.jsxDEV("div",{className:"text-green-400 font-mono text-sm font-bold",children:"拖拽模式"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:145,columnNumber:17},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:144,columnNumber:15},this),s.jsxDEV("div",{className:"absolute inset-0 rounded-xl bg-gradient-to-br from-green-500/0 via-green-500/0 to-green-500/0 group-hover:from-green-500/5 group-hover:via-transparent group-hover:to-green-500/5 transition-all duration-300"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:150,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:111,columnNumber:11},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:106,columnNumber:9},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:97,columnNumber:7},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:86,columnNumber:5},this)}function U(){var a;const{user:n,logout:r}=V(),[i,o]=e.useState(!0),[l,h]=e.useState(new Date),[c,d]=e.useState([]),[u,g]=e.useState([]),[k,E]=e.useState(!1);e.useEffect(()=>{B();const e=setInterval(()=>{h(new Date)},1e3);return()=>clearInterval(e)},[]),e.useEffect(()=>{if(n){let s=[];if(S(n.role.name))s=I();else{const e=n.permissions||[];s=C(e)}d(s);const t=localStorage.getItem("dashboard-order-".concat(n.id));if(t)try{const e=JSON.parse(t),m=e.map(e=>s.find(s=>s.id===e)).filter(Boolean),a=s.filter(s=>!e.includes(s.id));g([...m,...a])}catch(e){g(s)}else g(s)}},[n]);const B=async()=>{o(!1)},K=b(N(j,{activationConstraint:{distance:5,delay:100,tolerance:3}}),N(w,{coordinateGetter:D})),U=()=>u;return i?s.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center",children:s.jsxDEV("div",{className:"text-green-400 text-xl animate-pulse font-mono",children:"加载中..."},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:284,columnNumber:9},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:283,columnNumber:7},this):s.jsxDEV("div",{className:"min-h-screen bg-black text-green-300",children:[s.jsxDEV("header",{className:"bg-gray-900 border-b border-green-400 px-4 sm:px-6 py-4",children:s.jsxDEV("div",{className:"max-w-7xl mx-auto",children:s.jsxDEV("div",{className:"flex justify-between items-center",children:[s.jsxDEV("div",{children:[s.jsxDEV("h1",{className:"text-xl sm:text-2xl font-bold text-green-400 font-mono",children:"工时管理系统"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:298,columnNumber:15},this),s.jsxDEV("div",{className:"mt-2 flex items-center gap-2",children:[s.jsxDEV("div",{className:"text-green-300 font-mono text-sm",children:(null==n?void 0:n.name)||"未知用户"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:303,columnNumber:17},this),s.jsxDEV("span",{className:"text-green-600",children:"•"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:306,columnNumber:17},this),s.jsxDEV("div",{className:"text-green-600 font-mono text-sm",children:(null==(a=null==n?void 0:n.role)?void 0:a.name)||"未分配角色"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:307,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:302,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:297,columnNumber:13},this),s.jsxDEV("button",{onClick:async()=>{try{await r()}catch(e){}},className:"flex items-center gap-2 px-3 py-2 sm:px-4 sm:py-2 bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white font-medium rounded-lg transition-all duration-200 font-mono text-sm shadow-lg hover:shadow-xl transform hover:scale-105",children:[s.jsxDEV(t,{className:"w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:318,columnNumber:15},this),s.jsxDEV("span",{className:"hidden sm:inline",children:"退出系统"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:319,columnNumber:15},this),s.jsxDEV("span",{className:"sm:hidden",children:"退出"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:320,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:314,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:296,columnNumber:11},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:295,columnNumber:9},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:294,columnNumber:7},this),s.jsxDEV("div",{className:"max-w-7xl mx-auto p-6",children:[s.jsxDEV("div",{className:"mb-8",children:s.jsxDEV("div",{className:"mt-4 h-1 bg-gradient-to-r from-transparent via-green-400 to-transparent"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:329,columnNumber:11},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:328,columnNumber:9},this),s.jsxDEV("div",{className:"mb-8",children:[s.jsxDEV(x,{sensors:K,collisionDetection:y,onDragStart:e=>{E(!0)},onDragEnd:e=>{const{active:s,over:t}=e;if(E(!1),!t||!n||s.id===t.id)return;const m=u.findIndex(e=>e.id===s.id),a=u.findIndex(e=>e.id===t.id);if(-1!==m&&-1!==a){const e=v(u,m,a);g(e);const s=e.map(e=>e.id);localStorage.setItem("dashboard-order-".concat(n.id),JSON.stringify(s))}},children:s.jsxDEV(f,{items:U().map(e=>e.id),strategy:p,children:s.jsxDEV("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 transition-colors duration-200 ".concat(k?"select-none":""),children:U().map((e,t)=>s.jsxDEV(P,{module:e,index:t,isDragMode:k},e.id,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:351,columnNumber:19},this))},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:347,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:343,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:337,columnNumber:11},this),0===c.length&&s.jsxDEV("div",{className:"text-center py-12",children:[s.jsxDEV("div",{className:"text-green-600 mb-4",children:s.jsxDEV(m,{className:"h-16 w-16 mx-auto"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:366,columnNumber:17},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:365,columnNumber:15},this),s.jsxDEV("h3",{className:"text-lg font-medium text-green-400 mb-2 font-mono",children:"暂无可访问的模块"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:368,columnNumber:15},this),s.jsxDEV("p",{className:"text-green-600 font-mono",children:"请联系管理员为您分配相应的权限"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:369,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:364,columnNumber:13},this),c.length>0&&s.jsxDEV("div",{className:"mt-6 text-center",children:k?s.jsxDEV("div",{className:"bg-green-900/30 border border-green-500 rounded-lg p-3",children:s.jsxDEV("p",{className:"text-green-400 text-sm font-mono font-bold",children:"🎯 拖拽模式已激活 - 松开鼠标完成排序"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:378,columnNumber:19},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:377,columnNumber:17},this):s.jsxDEV("p",{className:"text-green-600 text-sm font-mono",children:"💡 提示：长按模块或拖拽一定距离来重新排列顺序"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:383,columnNumber:17},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:375,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:335,columnNumber:9},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:326,columnNumber:7},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:292,columnNumber:5},this)}export{U as default};
