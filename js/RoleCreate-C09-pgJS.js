import{f as e,r as m,j as s,n as t,v as n,H as r,X as a}from"./react-vendor-DJh0NlN6.js";import{u as i,D as o,s as l,S as u}from"./index-DXRv2NX8.js";import"./vendor-BiPrETSv.js";import"./supabase-BfQEXDvU.js";import"./ui-components-C7XcqZ4h.js";function h(){const h=e(),{user:c}=i(),[g,d]=m.useState({name:"",permissions:[]}),[N,b]=m.useState(!1),[x,y]=m.useState(null),[p,f]=m.useState(!1);return p?s.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center",children:s.jsxDEV("div",{className:"text-center",children:s.jsxDEV("div",{className:"text-green-400 text-xl animate-pulse font-mono",children:"加载中..."},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:49,columnNumber:11},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:48,columnNumber:9},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:47,columnNumber:7},this):c?s.jsxDEV("div",{className:"min-h-screen bg-black text-green-300 p-4 sm:p-6",children:s.jsxDEV("div",{className:"max-w-4xl mx-auto",children:[s.jsxDEV("div",{className:"mb-6",children:s.jsxDEV("div",{className:"flex items-center justify-between mb-3",children:[s.jsxDEV("h1",{className:"text-xl sm:text-2xl font-bold text-green-400 font-mono truncate",children:"创建角色"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:130,columnNumber:13},this),s.jsxDEV("button",{onClick:()=>h("/role-permissions"),className:"flex items-center text-green-400 hover:text-green-300 transition-colors flex-shrink-0 font-mono",children:[s.jsxDEV(t,{className:"h-5 w-5 mr-2"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:137,columnNumber:15},this),"返回"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:133,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:129,columnNumber:11},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:128,columnNumber:9},this),x&&s.jsxDEV("div",{className:"mb-4 p-3 bg-red-900/30 border border-red-400/60 rounded text-red-200 text-sm font-mono",children:x},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:144,columnNumber:11},this),s.jsxDEV("form",{onSubmit:async e=>{if(e.preventDefault(),g.name.trim()){b(!0),y(null);try{const{data:e}=await l.from("user_roles").select("id").eq("name",g.name.trim()).single();if(e)return y("角色名称已存在，请使用其他名称"),void b(!1);if(g.name.trim()===u)return y("超级管理员角色已存在，无法重复创建"),void b(!1);const{error:m}=await l.from("user_roles").insert({name:g.name.trim(),permissions:g.permissions});if(m)return void y("创建角色失败，请重试");y(""),h("/roles")}catch(m){y("创建角色时发生错误，请重试")}finally{b(!1)}}else y("角色名称不能为空")},className:"space-y-4 sm:space-y-6",children:[s.jsxDEV("div",{className:"bg-gray-900/50 border border-green-400/50 rounded p-4 sm:p-6",children:[s.jsxDEV("h2",{className:"text-lg font-bold text-green-400 font-mono mb-3 sm:mb-4",children:"基本信息"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:152,columnNumber:13},this),s.jsxDEV("div",{className:"space-y-4",children:s.jsxDEV("div",{children:[s.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-2",children:"角色名称 *"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:156,columnNumber:17},this),s.jsxDEV("div",{className:"relative",children:[s.jsxDEV(n,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400/70 w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:160,columnNumber:19},this),s.jsxDEV("input",{type:"text",value:g.name,onChange:e=>d(m=>({...m,name:e.target.value})),required:!0,className:"w-full pl-10 pr-4 py-2 sm:py-3 bg-black border border-green-400/30 rounded text-green-200 placeholder-green-700 focus:outline-none focus:border-green-400 focus:bg-gray-900/30 font-mono text-sm transition-all",placeholder:"请输入角色名称"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:161,columnNumber:19},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:159,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:155,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:154,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:151,columnNumber:11},this),s.jsxDEV("div",{className:"bg-gray-900/50 border border-green-400/50 rounded p-4 sm:p-6",children:[s.jsxDEV("h2",{className:"text-lg font-bold text-green-400 font-mono mb-3 sm:mb-4",children:"权限设置"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:178,columnNumber:13},this),s.jsxDEV("div",{className:"space-y-3",children:[s.jsxDEV("div",{className:"text-green-300 font-mono text-sm mb-4",children:"选择该角色可以访问的Dashboard模块："},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:181,columnNumber:15},this),s.jsxDEV("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:o.map(e=>s.jsxDEV("label",{className:"flex flex-col items-start gap-2 p-3 border border-green-400/20 rounded transition-colors cursor-pointer hover:bg-gray-800/30",children:[s.jsxDEV("div",{className:"flex items-center gap-2",children:[s.jsxDEV("input",{type:"checkbox",checked:g.permissions.includes(e.permission),onChange:()=>{return m=e.permission,void d(e=>({...e,permissions:e.permissions.includes(m)?e.permissions.filter(e=>e!==m):[...e.permissions,m]}));var m},className:"w-4 h-4 text-green-600 bg-black border-green-400 rounded focus:ring-green-500 focus:ring-2"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:189,columnNumber:23},this),s.jsxDEV("div",{className:"text-green-300 font-mono text-sm font-medium",children:e.name},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:195,columnNumber:23},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:188,columnNumber:21},this),s.jsxDEV("div",{className:"text-green-600 font-mono text-xs ml-6",children:e.description},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:199,columnNumber:21},this)]},e.id,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:187,columnNumber:19},this))},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:185,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:180,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:177,columnNumber:11},this),s.jsxDEV("div",{className:"flex flex-col sm:flex-row gap-3 pt-2",children:[s.jsxDEV("button",{type:"submit",disabled:N||!g.name.trim(),className:"flex items-center justify-center gap-2 px-4 py-2 sm:py-3 bg-green-600 hover:bg-green-500 disabled:bg-green-800 disabled:opacity-50 text-black font-medium rounded transition-all font-mono text-sm",children:[s.jsxDEV(r,{className:"w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:215,columnNumber:15},this),N?"创建中...":"创建角色"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:210,columnNumber:13},this),s.jsxDEV("button",{type:"button",onClick:()=>h("/role-permissions"),className:"flex items-center justify-center gap-2 px-4 py-2 sm:py-3 border border-gray-500 hover:border-gray-400 hover:bg-gray-800/30 text-gray-300 font-medium rounded transition-all font-mono text-sm",children:[s.jsxDEV(a,{className:"w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:223,columnNumber:15},this),"取消"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:218,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:209,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:149,columnNumber:9},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:126,columnNumber:7},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:125,columnNumber:5},this):s.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center",children:s.jsxDEV("div",{className:"bg-gray-900 border border-green-400 p-8 rounded-lg max-w-md w-full text-center",children:[s.jsxDEV("h2",{className:"text-xl font-semibold text-green-400 mb-2 font-mono",children:"未登录"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:61,columnNumber:11},this),s.jsxDEV("p",{className:"text-green-300 mb-6 font-mono",children:"请先登录后再访问此页面"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:62,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:60,columnNumber:9},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/RoleCreate.tsx",lineNumber:59,columnNumber:7},this)}export{h as default};
