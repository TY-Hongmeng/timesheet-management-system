import{r as e,j as m,l as t,d as s,G as n,I as i,T as o,C as a,W as r,b as c,m as l}from"./react-CJFYUZ2-.js";import{m as u,a as d}from"./index-CaFumSQp.js";import"./vendor-BGL5XM0N.js";import"./react-dom-CF0h6VJ-.js";import"./supabase-BCgBSYV2.js";import"./toast-FCEag1yS.js";const h=()=>{const[h,g]=e.useState(!1),[b,N]=e.useState(null),[x,v]=e.useState([{id:"network",name:"网络连接检测",status:"pending"},{id:"browser",name:"浏览器兼容性检测",status:"pending"},{id:"device",name:"设备性能检测",status:"pending"},{id:"optimization",name:"优化状态检测",status:"pending"},{id:"connection",name:"连接稳定性检测",status:"pending"}]),y=(e,m,t,s)=>{v(n=>n.map(n=>n.id===e?{...n,status:m,result:t,details:s}:n))},D=e=>{switch(e){case"running":return m.jsxDEV(s,{className:"w-5 h-5 animate-spin text-blue-500"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:140,columnNumber:16},void 0);case"success":return m.jsxDEV(a,{className:"w-5 h-5 text-green-500"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:142,columnNumber:16},void 0);case"error":return m.jsxDEV(l,{className:"w-5 h-5 text-red-500"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:144,columnNumber:16},void 0);default:return m.jsxDEV("div",{className:"w-5 h-5 rounded-full border-2 border-gray-300"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:146,columnNumber:16},void 0)}},w=()=>{if(!b)return[];const e=[...b.recommendations],m=u.getSuggestedSolutions();return e.push(...m),[...new Set(e)]};return m.jsxDEV("div",{className:"min-h-screen bg-gray-50 p-4",children:m.jsxDEV("div",{className:"max-w-2xl mx-auto",children:[m.jsxDEV("div",{className:"text-center mb-6",children:[m.jsxDEV("div",{className:"flex items-center justify-center mb-4",children:[m.jsxDEV(t,{className:"w-8 h-8 text-blue-500 mr-2"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:168,columnNumber:13},void 0),m.jsxDEV("h1",{className:"text-2xl font-bold text-gray-900",children:"移动端网络诊断"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:169,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:167,columnNumber:11},void 0),m.jsxDEV("p",{className:"text-gray-600",children:"检测移动端网络连接问题，提供针对性解决方案"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:171,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:166,columnNumber:9},void 0),m.jsxDEV("div",{className:"text-center mb-6",children:m.jsxDEV("button",{onClick:async()=>{var e;g(!0),N(null),v(e=>e.map(e=>({...e,status:"pending"})));try{y("network","running"),await new Promise(e=>setTimeout(e,1e3));const t=navigator.onLine,s=(null==(e=navigator.connection)?void 0:e.effectiveType)||"未知";t?y("network","success","网络连接正常","连接类型: ".concat(s)):y("network","error","网络连接异常","请检查网络设置"),y("browser","running"),await new Promise(e=>setTimeout(e,800));const n=u.getBrowserInfo();u.isProblematicBrowser()?y("browser","error","浏览器兼容性问题","".concat(n.name," ").concat(n.version," 可能存在兼容性问题")):y("browser","success","浏览器兼容性良好","".concat(n.name," ").concat(n.version)),y("device","running"),await new Promise(e=>setTimeout(e,1200));const i=navigator.deviceMemory||"未知",o=navigator.hardwareConcurrency||"未知",a="".concat(window.screen.width,"x").concat(window.screen.height);y("device","success","设备性能检测完成","内存: ".concat(i,"GB, CPU核心: ").concat(o,", 屏幕: ").concat(a)),y("optimization","running"),await new Promise(e=>setTimeout(e,1e3));const r=d.getOptimizationStatus().overallHealth;r>80?y("optimization","success","优化状态良好","健康度: ".concat(r,"%")):r>60?y("optimization","success","优化状态一般","健康度: ".concat(r,"%")):y("optimization","error","优化状态较差","健康度: ".concat(r,"%")),y("connection","running"),await new Promise(e=>setTimeout(e,1500));try{const e=await fetch(window.location.origin,{method:"HEAD",cache:"no-cache"});e.ok?y("connection","success","连接稳定性良好","测试请求成功"):y("connection","error","连接不稳定","HTTP ".concat(e.status))}catch(m){const e=m instanceof Error?m.message:"未知错误";y("connection","error","连接测试失败",e)}const c=await d.triggerDiagnostic();N(c)}catch(m){}finally{g(!1)}},disabled:h,className:"bg-blue-500 hover:bg-blue-600 disabled:bg-blue-300 text-white px-6 py-3 rounded-lg font-medium transition-colors flex items-center mx-auto",children:h?m.jsxDEV(m.Fragment,{children:[m.jsxDEV(s,{className:"w-5 h-5 mr-2 animate-spin"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:185,columnNumber:17},void 0),"正在诊断..."]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:184,columnNumber:15},void 0):m.jsxDEV(m.Fragment,{children:[m.jsxDEV(n,{className:"w-5 h-5 mr-2"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:190,columnNumber:17},void 0),"开始诊断"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:189,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:178,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:177,columnNumber:9},void 0),m.jsxDEV("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[m.jsxDEV("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[m.jsxDEV(i,{className:"w-5 h-5 mr-2 text-blue-500"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:200,columnNumber:13},void 0),"诊断步骤"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:199,columnNumber:11},void 0),m.jsxDEV("div",{className:"space-y-4",children:x.map(e=>m.jsxDEV("div",{className:"flex items-start space-x-3",children:[m.jsxDEV("div",{className:"flex-shrink-0 mt-1",children:D(e.status)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:207,columnNumber:17},void 0),m.jsxDEV("div",{className:"flex-1",children:[m.jsxDEV("div",{className:"font-medium text-gray-900",children:e.name},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:211,columnNumber:19},void 0),e.result&&m.jsxDEV("div",{className:"text-sm mt-1 ".concat("success"===e.status?"text-green-600":"error"===e.status?"text-red-600":"text-gray-600"),children:e.result},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:213,columnNumber:21},void 0),e.details&&m.jsxDEV("div",{className:"text-xs text-gray-500 mt-1",children:e.details},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:221,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:210,columnNumber:17},void 0)]},e.id,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:206,columnNumber:15},void 0))},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:204,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:198,columnNumber:9},void 0),b&&m.jsxDEV("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[m.jsxDEV("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[m.jsxDEV(o,{className:"w-5 h-5 mr-2 text-orange-500"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:233,columnNumber:15},void 0),"诊断结果"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:232,columnNumber:13},void 0),m.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[m.jsxDEV("div",{className:"bg-gray-50 p-4 rounded-lg",children:[m.jsxDEV("div",{className:"text-sm text-gray-600",children:"整体健康度"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:239,columnNumber:17},void 0),m.jsxDEV("div",{className:"text-2xl font-bold text-blue-600",children:[b.overallScore,"%"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:240,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:238,columnNumber:15},void 0),m.jsxDEV("div",{className:"bg-gray-50 p-4 rounded-lg",children:[m.jsxDEV("div",{className:"text-sm text-gray-600",children:"检测时间"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:246,columnNumber:17},void 0),m.jsxDEV("div",{className:"text-sm font-medium",children:new Date(b.timestamp).toLocaleString()},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:247,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:245,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:237,columnNumber:13},void 0),b.errorLog.length>0&&m.jsxDEV("div",{className:"mb-4",children:[m.jsxDEV("h3",{className:"font-medium text-red-600 mb-2",children:"发现的问题:"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:255,columnNumber:17},void 0),m.jsxDEV("div",{className:"bg-red-50 p-3 rounded-lg",children:b.errorLog.map((e,t)=>m.jsxDEV("div",{className:"text-sm text-red-700",children:["• ",e.message||e]},t,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:258,columnNumber:21},void 0))},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:256,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:254,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:231,columnNumber:11},void 0),b&&w().length>0&&m.jsxDEV("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[m.jsxDEV("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[m.jsxDEV(a,{className:"w-5 h-5 mr-2 text-green-500"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:272,columnNumber:15},void 0),"建议解决方案"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:271,columnNumber:13},void 0),m.jsxDEV("div",{className:"space-y-3",children:w().map((e,t)=>m.jsxDEV("div",{className:"flex items-start space-x-3",children:[m.jsxDEV("div",{className:"flex-shrink-0 w-6 h-6 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-sm font-medium",children:t+1},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:279,columnNumber:19},void 0),m.jsxDEV("div",{className:"text-gray-700",children:e},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:282,columnNumber:19},void 0)]},t,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:278,columnNumber:17},void 0))},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:276,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:270,columnNumber:11},void 0),m.jsxDEV("div",{className:"fixed bottom-4 right-4",children:m.jsxDEV("div",{className:"flex items-center space-x-2 px-3 py-2 rounded-full text-sm font-medium ".concat(navigator.onLine?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:navigator.onLine?m.jsxDEV(m.Fragment,{children:[m.jsxDEV(r,{className:"w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:298,columnNumber:17},void 0),m.jsxDEV("span",{children:"在线"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:299,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:297,columnNumber:15},void 0):m.jsxDEV(m.Fragment,{children:[m.jsxDEV(c,{className:"w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:303,columnNumber:17},void 0),m.jsxDEV("span",{children:"离线"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:304,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:302,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:291,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:290,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:164,columnNumber:7},void 0)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/MobileDiagnostic.tsx",lineNumber:163,columnNumber:5},void 0)};export{h as default};
