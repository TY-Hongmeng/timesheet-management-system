import{r as e,j as t,a as s,m,c as n,h as r,P as i,t as a,d as o,D as l,I as c,f as h}from"../libs/lib-react-CmVvENop.js";import{t as u}from"../libs/lib-toast-BLtamXt4.js";import{u as d,i as g,s as y}from"./page-admin-DIiCL3HX.js";import{T as N}from"../components/components-shared-zNXwIS8Z.js";import{u as x,L as p}from"../vendor-BPcnth7H.js";const b=Object.freeze(Object.defineProperty({__proto__:null,default:function(){var a;const{user:o,isAuthenticated:l,refreshUser:c}=d(),h=x(),[b,f]=e.useState(!0),[v,w]=e.useState([]),[_,k]=e.useState([]),[j,E]=e.useState([]),[T,D]=e.useState([]),[V,H]=e.useState([]),[R,S]=e.useState([]),[q,C]=e.useState([]),[I,L]=e.useState(null),[O,F]=e.useState([]),[z,M]=e.useState([]),[P,A]=e.useState({user_id:(null==o?void 0:o.id)||"",record_date:(new Date).toISOString().split("T")[0],production_line_id:0,supervisor_id:null,section_chief_id:null,shift_type:"白班",status:"draft",items:[]}),[B,G]=e.useState({work_type_id:0,product_id:0,process_id:"",quantity:0}),[U,W]=e.useState(""),Y=()=>({work_type_id:_.length>0?_[0].id:1,product_id:0,process_id:"",quantity:0}),[J,K]=e.useState([Y()]),[Q,X]=e.useState({}),[Z,$]=e.useState({}),[ee,te]=e.useState(""),[se,me]=e.useState(!1),[ne,re]=e.useState(!1),[ie,ae]=e.useState(!1),oe=async()=>{if(o)try{const{data:e,error:t}=await y.from("users").select("company_id").eq("id",o.id).single();if(t)throw t;L(e.company_id)}catch(e){u.error("获取用户公司信息失败")}};e.useEffect(()=>{const e=e=>{e.target.closest(".production-line-dropdown")||me(!1)};return se&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[se]),e.useEffect(()=>{o&&le()},[o]),e.useEffect(()=>{P.production_line_id?(A(e=>({...e,supervisor_id:null,section_chief_id:null})),ye(P.production_line_id.toString()),Ne(P.production_line_id.toString())):(S([]),C([]),A(e=>({...e,supervisor_id:null,section_chief_id:null})))},[P.production_line_id,v]),e.useEffect(()=>{P.production_line_id?(G(e=>({...e,work_type_id:0,product_id:0,process_id:""})),W(""),he(),ue(),de()):(k([]),E([]),D([]),G(e=>({...e,work_type_id:0,product_id:0,process_id:""})),W(""))},[P.production_line_id,v]),e.useEffect(()=>{1===v.length&&0===P.production_line_id&&A(e=>({...e,production_line_id:v[0].id}))},[v,P.production_line_id]),e.useEffect(()=>{if(P.production_line_id&&!P.supervisor_id&&V.length>0&&I){const e=V.filter(e=>{var t;if("班长"!==(null==(t=e.role)?void 0:t.name))return!1;if(e.company_id!==I)return!1;if(P.production_line_id){const e=v.find(e=>e.id===P.production_line_id);if(e)return T.filter(t=>t.production_line===e.name).length>0}return!0});1===e.length&&A(t=>({...t,supervisor_id:e[0].id}))}},[P.production_line_id,P.supervisor_id,V,I,v,T]),e.useEffect(()=>{if(P.production_line_id&&!P.section_chief_id&&V.length>0&&I){const e=V.filter(e=>{var t;if("段长"!==(null==(t=e.role)?void 0:t.name))return!1;if(e.company_id!==I)return!1;if(P.production_line_id){const e=v.find(e=>e.id===P.production_line_id);if(e)return T.filter(t=>t.production_line===e.name).length>0}return!0});1===e.length&&A(t=>({...t,section_chief_id:e[0].id}))}},[P.production_line_id,P.section_chief_id,V,I,v,T]),e.useEffect(()=>{if(_.length>0&&P.production_line_id&&T.length>0){const e=_.find(e=>e.id===B.work_type_id);if(!e&&_.length>0)return void G(e=>({...e,work_type_id:_[0].id}));if(e){const e=B.work_type_id;pe(e)}}},[_,P.production_line_id,T,B.work_type_id]),e.useEffect(()=>{1===j.length&&0===B.product_id&&G(e=>({...e,product_id:j[0].id}))},[j,B.product_id]),e.useEffect(()=>{1===T.length&&""===B.process_id&&G(e=>({...e,process_id:T[0].id}))},[T,B.process_id]);const le=async()=>{if(o)try{f(!0),await Promise.all([oe(),ce(),ge()])}catch(e){u.error("加载数据失败")}finally{f(!1)}},ce=async()=>{if(o)try{const e=g(o.role);let t=y.from("processes").select("id, production_line, company_id, is_active").eq("is_active",!0).order("production_line");if(e);else{const{data:e,error:s}=await y.from("users").select("company_id").eq("id",o.id).single();if(s)throw s;t=t.eq("company_id",e.company_id)}const{data:s,error:m}=await t;if(m)throw m;const n=new Map;null==s||s.forEach(e=>{e.production_line&&n.set(e.production_line,{company_id:e.company_id,is_active:e.is_active})});const r=Array.from(n.entries()).map(([e,t],s)=>({id:s+1,name:e,is_active:t.is_active,company_id:t.company_id}));w(r)}catch(e){u.error("加载生产线信息失败")}},he=async()=>{if(o)try{if(!P.production_line_id)return void k([]);const e=v.find(e=>e.id===P.production_line_id);if(!e)return void k([]);let t;if(g(o.role)){if(!e.company_id)return void k([]);t=e.company_id}else{const{data:e,error:s}=await y.from("users").select("company_id").eq("id",o.id).single();if(s)throw s;t=e.company_id}const{data:s,error:m}=await y.from("processes").select("production_category").eq("company_id",t).eq("production_line",e.name).eq("is_active",!0).not("production_category","is",null);if(m)throw m;const n=[...new Set((null==s?void 0:s.map(e=>e.production_category))||[])].filter(e=>e&&isNaN(Number(e))).sort().map((e,t)=>({id:t+1,name:e,is_active:!0}));k(n)}catch(e){u.error("加载工时类型数据失败")}},ue=async()=>{if(o)try{if(!P.production_line_id)return void E([]);const e=v.find(e=>e.id===P.production_line_id);if(!e)return void E([]);let t;if(g(o.role)){if(!e.company_id)return void E([]);t=e.company_id}else{const{data:e,error:s}=await y.from("users").select("company_id").eq("id",o.id).single();if(s)throw s;t=e.company_id}const{data:s,error:m}=await y.from("processes").select("id, product_name, production_line").eq("company_id",t).eq("production_line",e.name).eq("is_active",!0);if(m)throw m;const n=[...new Set((null==s?void 0:s.map(e=>e.product_name))||[])].filter(Boolean).sort().map((e,t)=>({id:t+1,name:e,code:"",is_active:!0}));E(n)}catch(e){u.error("加载产品数据失败")}},de=async()=>{if(o)try{if(!P.production_line_id)return void D([]);const e=v.find(e=>e.id===P.production_line_id);if(!e)return void D([]);let t;if(g(o.role)){if(!e.company_id)return void D([]);t=e.company_id}else{const{data:e,error:s}=await y.from("users").select("company_id").eq("id",o.id).single();if(s)throw s;t=e.company_id}const{data:s,error:m}=await y.from("processes").select("id, product_process, product_name, company_id, production_line, production_category, unit_price, is_active").eq("company_id",t).eq("production_line",e.name).eq("is_active",!0).order("product_process");if(m)throw m;const n=(null==s?void 0:s.map(e=>({id:e.id,name:e.product_process,product_name:e.product_name,company_id:e.company_id,production_line:e.production_line,production_category:e.production_category,product_process:e.product_process,unit_price:e.unit_price,is_active:e.is_active})))||[];D(n)}catch(e){u.error("加载工序数据失败")}},ge=async()=>{const{data:e,error:t}=await y.from("users").select("id, name, company_id, production_line, role:user_roles!inner(name)").eq("is_active",!0).order("name");if(t)throw t;H(e||[])},ye=async e=>{if(e)try{const t=v.find(t=>t.id===parseInt(e));if(!t)return void S([]);const{data:s,error:m}=await y.from("users").select("\n          id, \n          name, \n          production_line,\n          role:user_roles!inner(name)\n        ").eq("production_line",t.name).eq("user_roles.name","班长").eq("is_active",!0).order("name");if(m)throw m;S(s||[]),s&&1===s.length&&!P.supervisor_id&&A(e=>({...e,supervisor_id:s[0].id}))}catch(t){u.error("加载班长数据失败"),S([])}else S([])},Ne=async e=>{if(e)try{const t=v.find(t=>t.id===parseInt(e));if(!t)return void C([]);const{data:s,error:m}=await y.from("users").select("\n          id, \n          name, \n          production_line,\n          role:user_roles!inner(name)\n        ").eq("production_line",t.name).eq("user_roles.name","段长").eq("is_active",!0).order("name");if(m)throw m;C(s||[]),s&&1===s.length&&!P.section_chief_id&&A(e=>({...e,section_chief_id:s[0].id}))}catch(t){u.error("加载段长数据失败"),C([])}else C([])},xe=(e,t)=>{A(s=>{let m=t;"production_line_id"===e?m=parseInt(t)||0:"supervisor_id"!==e&&"section_chief_id"!==e||(m=t||null);const n={...s,[e]:m};return"production_line_id"===e&&(n.supervisor_id=null,n.section_chief_id=null),n})},pe=e=>{if(G(t=>({...t,work_type_id:e,product_id:0,process_id:""})),W(""),0===e)return F([]),void M([]);const t=_.find(t=>t.id===e);if(!t)return F([]),void M([]);const s=be();if(s){const e=T.filter(e=>{const m=e.production_line===s,n=e.production_category===t.name;return m&&n}).map(e=>e.product_name).filter((e,t,s)=>e&&s.indexOf(e)===t).filter(Boolean);F(e)}else F([]);M([])},be=()=>{if(P.production_line_id){const e=v.find(e=>e.id===P.production_line_id);return null==e?void 0:e.name}return null},fe=(e,t,s)=>{K(m=>{const n=[...m];let r=s;return"work_type_id"===t||"product_id"===t?r=parseInt(s)||0:"process_id"===t?r=s||"":"quantity"===t&&(r=parseFloat(s)||0),n[e]={...n[e],[t]:r},"work_type_id"===t?(n[e].product_id=0,n[e].process_id="",X(t=>({...t,[e]:""}))):"product_id"===t&&(n[e].process_id=""),n})},ve=e=>{if(!e||!P.production_line_id)return[];const t=_.find(t=>t.id===e),s=be();if(!t||!s)return[];const m=T.filter(e=>e.production_line===s&&e.production_category===t.name&&e.is_active);return[...new Set(m.map(e=>e.product_name))].map((e,t)=>({id:t+1,name:e}))},we=(e,t)=>{if(!e)return[];const s=be();if(!s)return[];const m=(t?ve(t):[]).find(t=>t.id===e);return m?T.filter(e=>e.production_line===s&&e.product_name===m.name&&e.is_active):[]},_e=async e=>{var t,s;let m;if(!o)return void u.error("❌ 用户未登录，请重新登录后再试",{duration:5e3,description:"登录状态已过期，请刷新页面重新登录"});if(!P.supervisor_id)return void u.error("❌ 请选择班长",{duration:4e3,description:"班长是必填项，请在基本信息中选择班长"});if(!P.section_chief_id)return void u.error("❌ 请选择段长",{duration:4e3,description:"段长是必填项，请在基本信息中选择段长"});const n=e||P.items;if(0!==n.length){u.loading("🔄 正在提交工时记录，请稍候...",{id:"submit-loading",description:"正在提交 ".concat(n.length," 条工时记录到审核系统")});try{f(!0);try{const{data:e,error:t}=await y.from("users").select("id").limit(1);if(t)throw new Error("数据库连接失败: ".concat(t.message))}catch(r){return void u.error("数据库连接失败，请检查网络连接")}if(!(null==o?void 0:o.id))return void u.error("用户信息无效，请重新登录");m={user_id:o.id,work_date:P.record_date,supervisor_id:P.supervisor_id,section_chief_id:P.section_chief_id,shift_type:P.shift_type,status:"pending"};const{data:t,error:s}=await y.from("timesheet_records").insert(m).select().single();if(s)throw s;const n=(e||P.items).map(e=>{const s=T.find(t=>t.id===e.process_id),m=s&&null!==s.unit_price?parseFloat(s.unit_price.toString()):0;return{timesheet_record_id:t.id,process_id:e.process_id,quantity:e.quantity,unit_price:m,amount:e.quantity*m}}),{error:i}=await y.from("timesheet_record_items").insert(n);if(i)throw i;const a=R.find(e=>e.id===P.supervisor_id);null==a||a.name,u.dismiss("submit-loading"),u.success("数据提交成功返回首页",{duration:1500}),setTimeout(()=>{h("/dashboard")},1500),K([Y()]),A({user_id:o.id,record_date:(new Date).toISOString().split("T")[0],production_line_id:0,supervisor_id:null,section_chief_id:null,shift_type:"白班",status:"draft",items:[]})}catch(i){u.dismiss("submit-loading");let e="❌ 工时记录提交失败",m="请检查网络连接后重试，如问题持续请联系管理员";"42501"===(null==i?void 0:i.code)?(e="❌ 权限不足，提交失败",m="您没有权限创建工时记录，请联系管理员检查数据库权限配置。如果您是新员工，可能需要管理员为您分配相应权限。"):"23502"===(null==i?void 0:i.code)?(e="❌ 数据验证失败",m="提交的数据缺少必填字段，请检查所有必填项（生产线、班长、段长、工时记录项）是否已正确填写。"):"23503"===(null==i?void 0:i.code)?(e="❌ 数据关联错误",m="您选择的生产线、班长或段长可能已被删除或无效，请重新选择后再试。如问题持续，请联系管理员。"):"42703"===(null==i?void 0:i.code)?(e="❌ 数据格式错误",m="提交的数据格式不正确，这可能是系统版本问题，请联系技术支持。"):(null==(t=null==i?void 0:i.message)?void 0:t.includes("网络"))||(null==(s=null==i?void 0:i.message)?void 0:s.includes("连接"))?(e="❌ 网络连接失败",m="无法连接到服务器，请检查您的网络连接，稍后再试。如果问题持续，请联系IT支持。"):(null==i?void 0:i.message)&&(e="❌ 提交失败",m="错误详情: ".concat(i.message,"。请截图此错误信息并联系管理员。")),u.error(e,{duration:8e3,description:m,action:{label:"重试",onClick:()=>{re(!0)}}})}finally{f(!1)}}else u.error("❌ 请至少添加一条工时记录",{duration:4e3,description:"工时记录不能为空，请添加至少一条有效的工时记录"})};return t.jsxDEV("div",{className:"min-h-screen bg-black text-green-400 font-mono",children:[t.jsxDEV("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[t.jsxDEV("div",{className:"mb-4 sm:mb-8",children:[t.jsxDEV("div",{className:"flex justify-between items-center mb-2 sm:mb-4",children:[t.jsxDEV("div",{className:"flex items-center",children:[t.jsxDEV(s,{className:"w-5 h-5 sm:w-8 sm:h-8 text-green-400 mr-2 sm:mr-3"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1602,columnNumber:15},this),t.jsxDEV("h1",{className:"text-xl sm:text-4xl font-bold text-green-400 font-mono",children:"工时记录"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1603,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1601,columnNumber:13},this),t.jsxDEV("div",{className:"flex items-center space-x-2",children:[t.jsxDEV("button",{onClick:async()=>{ae(!0);try{A({user_id:(null==o?void 0:o.id)||"",record_date:(new Date).toISOString().split("T")[0],production_line_id:0,supervisor_id:null,section_chief_id:null,shift_type:"白班",status:"draft",items:[]}),K([Y()]),X({}),$({}),W(""),G({work_type_id:0,product_id:0,process_id:"",quantity:0}),await le(),u.success("数据已刷新")}catch(e){u.error("刷新失败，请重试")}finally{ae(!1)}},disabled:ie,className:"flex items-center space-x-1 sm:space-x-2 px-2 py-1 sm:px-4 sm:py-2 bg-gradient-to-r from-gray-600 to-gray-800 hover:from-gray-500 hover:to-gray-700 disabled:from-gray-600 disabled:to-gray-800 text-green-300 border border-green-400 rounded-lg shadow-lg hover:shadow-xl transition-all duration-300 font-mono text-sm sm:text-base disabled:cursor-not-allowed",children:[t.jsxDEV(m,{className:"w-4 h-4 sm:w-5 sm:h-5 ".concat(ie?"animate-spin":"")},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1611,columnNumber:17},this),t.jsxDEV("span",{className:"hidden sm:inline",children:ie?"刷新中...":"刷新"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1612,columnNumber:17},this),t.jsxDEV("span",{className:"sm:hidden",children:ie?"...":"刷新"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1613,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1606,columnNumber:15},this),t.jsxDEV(p,{to:"/dashboard",className:"flex items-center space-x-1 sm:space-x-2 px-2 py-1 sm:px-4 sm:py-2 bg-gradient-to-r from-gray-600 to-gray-800 hover:from-gray-500 hover:to-gray-700 text-green-300 border border-green-400 rounded-lg shadow-lg hover:shadow-xl transition-all duration-300 font-mono text-sm sm:text-base",children:[t.jsxDEV(n,{className:"w-4 h-4 sm:w-5 sm:h-5"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1619,columnNumber:17},this),t.jsxDEV("span",{className:"hidden sm:inline",children:"返回控制台"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1620,columnNumber:17},this),t.jsxDEV("span",{className:"sm:hidden",children:"返回"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1621,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1615,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1605,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1600,columnNumber:11},this),t.jsxDEV("div",{className:"h-0.5 sm:h-1 bg-gradient-to-r from-transparent via-green-400 to-transparent"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1625,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1599,columnNumber:9},this),t.jsxDEV("div",{className:"space-y-3 sm:space-y-6",children:t.jsxDEV("div",{className:"flex flex-col lg:flex-row gap-3 sm:gap-6",children:[t.jsxDEV("div",{className:"bg-gray-900 border border-green-400 rounded-lg p-3 sm:p-6 flex-1",children:[t.jsxDEV("h2",{className:"text-lg sm:text-xl font-bold text-green-400 mb-2 sm:mb-4 flex items-center gap-2",children:[t.jsxDEV(r,{className:"w-4 h-4 sm:w-5 sm:h-5 text-green-400"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1633,columnNumber:17},this),"基本信息"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1632,columnNumber:15},this),t.jsxDEV("div",{className:"space-y-3",children:[t.jsxDEV("div",{className:"grid grid-cols-2 gap-2 sm:gap-4",children:[t.jsxDEV("div",{children:[t.jsxDEV("label",{className:"block text-green-300 text-xs font-medium mb-1",children:"记录日期"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1642,columnNumber:21},this),t.jsxDEV("input",{type:"date",value:P.record_date,onChange:e=>xe("record_date",e.target.value),className:"w-full px-2 py-1.5 sm:px-3 sm:py-2 bg-gray-800 border border-green-400 text-green-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-300 text-xs sm:text-sm"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1643,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1641,columnNumber:19},this),t.jsxDEV("div",{children:[t.jsxDEV("label",{className:"block text-green-300 text-xs font-medium mb-1",children:["生产线 ",t.jsxDEV("span",{className:"text-red-400",children:"*"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1653,columnNumber:27},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1652,columnNumber:21},this),t.jsxDEV("div",{className:"relative production-line-dropdown",children:[t.jsxDEV("input",{type:"text",value:(null==(a=v.find(e=>e.id===P.production_line_id))?void 0:a.name)||"",onChange:e=>{te(e.target.value),me(!0)},onFocus:()=>me(!0),placeholder:"搜索或选择生产线",className:"w-full px-2 py-1.5 sm:px-3 sm:py-2 bg-gray-800 border border-green-400 text-green-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-300 text-xs sm:text-sm"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1656,columnNumber:23},this),se&&t.jsxDEV("div",{className:"absolute z-20 w-full mt-1 bg-gray-800 border border-green-400 rounded-md shadow-lg max-h-48 overflow-y-auto",children:[v.filter(e=>e.name.toLowerCase().includes(ee.toLowerCase())).slice(0,10).map(e=>t.jsxDEV("div",{onClick:()=>{xe("production_line_id",e.id),te(""),me(!1)},className:"px-2 py-1.5 sm:px-3 sm:py-2 text-green-300 hover:bg-gray-700 cursor-pointer border-b border-gray-600 last:border-b-0 text-xs sm:text-sm",children:e.name},e.id,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1675,columnNumber:29},this)),0===v.filter(e=>e.name.toLowerCase().includes(ee.toLowerCase())).length&&t.jsxDEV("div",{className:"px-2 py-1.5 sm:px-3 sm:py-2 text-gray-400 text-xs sm:text-sm",children:"未找到匹配的生产线"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1690,columnNumber:29},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1668,columnNumber:25},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1655,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1651,columnNumber:19},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1640,columnNumber:17},this),t.jsxDEV("div",{className:"grid grid-cols-2 gap-2 sm:gap-4",children:[t.jsxDEV("div",{children:[t.jsxDEV("label",{className:"block text-green-300 text-xs font-medium mb-1",children:["班长 ",t.jsxDEV("span",{className:"text-red-400",children:"*"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1704,columnNumber:26},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1703,columnNumber:21},this),t.jsxDEV("select",{value:P.supervisor_id||"",onChange:e=>xe("supervisor_id",e.target.value||null),disabled:!P.production_line_id,className:"w-full px-2 py-1.5 sm:px-3 sm:py-2 bg-gray-800 border border-green-400 text-green-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-300 text-xs sm:text-sm ".concat(P.production_line_id?"":"opacity-50 cursor-not-allowed"),children:[t.jsxDEV("option",{value:"",children:(P.production_line_id,"请选择班长")},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1714,columnNumber:23},this),R.map(e=>t.jsxDEV("option",{value:e.id,children:e.name},e.id,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1718,columnNumber:25},this))]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1706,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1702,columnNumber:19},this),t.jsxDEV("div",{children:[t.jsxDEV("label",{className:"block text-green-300 text-xs font-medium mb-1",children:["段长 ",t.jsxDEV("span",{className:"text-red-400",children:"*"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1725,columnNumber:26},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1724,columnNumber:21},this),t.jsxDEV("select",{value:P.section_chief_id||"",onChange:e=>xe("section_chief_id",e.target.value||null),disabled:!P.production_line_id,className:"w-full px-2 py-1.5 sm:px-3 sm:py-2 bg-gray-800 border border-green-400 text-green-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-300 text-xs sm:text-sm ".concat(P.production_line_id?"":"opacity-50 cursor-not-allowed"),children:[t.jsxDEV("option",{value:"",children:(P.production_line_id,"请选择段长")},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1735,columnNumber:23},this),q.map(e=>t.jsxDEV("option",{value:e.id,children:e.name},e.id,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1739,columnNumber:25},this))]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1727,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1723,columnNumber:19},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1701,columnNumber:17},this),t.jsxDEV("div",{className:"grid grid-cols-1 gap-2 sm:gap-4",children:t.jsxDEV("div",{children:[t.jsxDEV("label",{className:"block text-green-300 text-xs font-medium mb-1",children:["班次 ",t.jsxDEV("span",{className:"text-red-400",children:"*"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1749,columnNumber:26},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1748,columnNumber:21},this),t.jsxDEV("select",{value:P.shift_type,onChange:e=>xe("shift_type",e.target.value),className:"w-full px-2 py-1.5 sm:px-3 sm:py-2 bg-gray-800 border border-green-400 text-green-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-300 text-xs sm:text-sm",children:[t.jsxDEV("option",{value:"白班",children:"白班"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1756,columnNumber:23},this),t.jsxDEV("option",{value:"夜班",children:"夜班"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1757,columnNumber:23},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1751,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1747,columnNumber:19},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1746,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1638,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1631,columnNumber:13},this),t.jsxDEV("div",{className:"bg-gray-900 border border-green-400 rounded-lg p-3 sm:p-6 flex-1",children:[t.jsxDEV("h2",{className:"text-lg sm:text-xl font-bold text-green-400 mb-2 sm:mb-4 flex items-center gap-2",children:[t.jsxDEV(i,{className:"w-4 h-4 sm:w-5 sm:h-5 text-green-400"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1767,columnNumber:17},this),"添加记录"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1766,columnNumber:15},this),t.jsxDEV("div",{className:"space-y-3 sm:space-y-4",children:J.map((e,s)=>t.jsxDEV("div",{className:"bg-gray-800/50 p-3 sm:p-4 rounded-lg border border-gray-700",children:[t.jsxDEV("div",{className:"flex items-center justify-between mb-3",children:[t.jsxDEV("span",{className:"text-green-400 font-medium text-sm",children:["记录 ",s+1]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1778,columnNumber:23},this),t.jsxDEV("button",{onClick:()=>(e=>{K(t=>{const s=t.filter((t,s)=>s!==e);return 0===s.length?[Y()]:s}),X(t=>{const s={...t};delete s[e];const m={};return Object.keys(s).map(e=>parseInt(e)).filter(t=>t>e).forEach(e=>{m[e-1]=s[e]}),Object.keys(s).map(e=>parseInt(e)).filter(t=>t<e).forEach(e=>{m[e]=s[e]}),m}),$(t=>{const s={...t};delete s[e];const m={};return Object.keys(s).map(e=>parseInt(e)).filter(t=>t>e).forEach(e=>{m[e-1]=s[e]}),Object.keys(s).map(e=>parseInt(e)).filter(t=>t<e).forEach(e=>{m[e]=s[e]}),m})})(s),className:"px-3 py-1 bg-red-500 text-white rounded text-xs hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors",title:"删除此行",children:"删除"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1779,columnNumber:23},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1777,columnNumber:21},this),t.jsxDEV("div",{className:"space-y-3",children:[t.jsxDEV("div",{className:"grid grid-cols-2 gap-2 sm:gap-4",children:[t.jsxDEV("div",{children:[t.jsxDEV("label",{className:"block text-green-300 text-xs font-medium mb-1",children:["工时类型 ",t.jsxDEV("span",{className:"text-red-400",children:"*"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1794,columnNumber:34},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1793,columnNumber:27},this),t.jsxDEV("select",{value:e.work_type_id||0,onChange:e=>fe(s,"work_type_id",parseInt(e.target.value)||0),className:"w-full px-2 py-1.5 sm:px-3 sm:py-2 bg-gray-800 border border-green-400 text-green-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-300 text-xs sm:text-sm",children:[t.jsxDEV("option",{value:0,children:"请选择工时类型"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1801,columnNumber:29},this),_.map(e=>t.jsxDEV("option",{value:e.id,children:e.name},e.id,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1803,columnNumber:31},this))]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1796,columnNumber:27},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1792,columnNumber:25},this),t.jsxDEV("div",{children:[t.jsxDEV("label",{className:"block text-green-300 text-xs font-medium mb-1",children:["产品名称 ",t.jsxDEV("span",{className:"text-red-400",children:"*"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1812,columnNumber:34},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1811,columnNumber:27},this),t.jsxDEV("div",{className:"relative",children:[t.jsxDEV("input",{type:"text",value:Q[s]||"",onChange:e=>{const t=e.target.value;X(e=>({...e,[s]:t})),t||fe(s,"product_id",0)},onBlur:t=>{setTimeout(()=>{$(e=>({...e,[s]:!1}))},200);const m=t.target.value,n=ve(e.work_type_id).find(e=>e.name===m);n&&fe(s,"product_id",n.id)},onClick:t=>{e.work_type_id&&(t.currentTarget.focus(),$(e=>({...e,[s]:!0})))},onFocus:()=>{e.work_type_id&&$(e=>({...e,[s]:!0}))},className:"w-full px-2 py-1.5 sm:px-3 sm:py-2 bg-gray-800 border border-green-400 text-green-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-300 text-xs sm:text-sm ".concat(e.work_type_id?"":"opacity-50 cursor-not-allowed"),placeholder:e.work_type_id?"请输入产品名称":"请先选择工时类型",disabled:!e.work_type_id},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1815,columnNumber:29},this),Z[s]&&e.work_type_id&&t.jsxDEV("div",{className:"absolute z-10 w-full mt-1 bg-gray-800 border border-green-400 rounded-md shadow-lg max-h-40 overflow-y-auto",children:ve(e.work_type_id).filter(e=>e.name.toLowerCase().includes((Q[s]||"").toLowerCase())).map(e=>t.jsxDEV("div",{onClick:()=>{X(t=>({...t,[s]:e.name})),fe(s,"product_id",e.id),$(e=>({...e,[s]:!1}))},className:"px-2 py-1.5 sm:px-3 sm:py-2 text-green-300 hover:bg-gray-700 cursor-pointer border-b border-gray-600 last:border-b-0 text-xs sm:text-sm",children:e.name},e.id,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1868,columnNumber:35},this))},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1862,columnNumber:31},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1814,columnNumber:27},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1810,columnNumber:25},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1791,columnNumber:23},this),t.jsxDEV("div",{className:"grid grid-cols-2 gap-2 sm:gap-4",children:[t.jsxDEV("div",{children:[t.jsxDEV("label",{className:"block text-green-300 text-xs font-medium mb-1",children:["工序名称 ",t.jsxDEV("span",{className:"text-red-400",children:"*"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1890,columnNumber:34},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1889,columnNumber:27},this),t.jsxDEV("select",{value:e.process_id||"",onChange:e=>fe(s,"process_id",e.target.value||""),className:"w-full px-2 py-1.5 sm:px-3 sm:py-2 bg-gray-800 border border-green-400 text-green-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-300 text-xs sm:text-sm ".concat(e.product_id?"":"opacity-50 cursor-not-allowed"),disabled:!e.product_id,children:[t.jsxDEV("option",{value:"",children:e.product_id?"请选择工序名称":"请先选择产品"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1900,columnNumber:29},this),we(e.product_id,e.work_type_id).map(e=>t.jsxDEV("option",{value:e.id,children:e.product_process},e.id,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1904,columnNumber:31},this))]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1892,columnNumber:27},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1888,columnNumber:25},this),t.jsxDEV("div",{children:[t.jsxDEV("label",{className:"block text-green-300 text-xs font-medium mb-1",children:["数量 ",t.jsxDEV("span",{className:"text-red-400",children:"*"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1913,columnNumber:32},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1912,columnNumber:27},this),t.jsxDEV("input",{type:"number",value:e.quantity||"",onChange:e=>fe(s,"quantity",parseFloat(e.target.value)||0),onWheel:e=>e.currentTarget.blur(),className:"w-full px-2 py-1.5 sm:px-3 sm:py-2 bg-gray-800 border border-green-400 text-green-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-300 text-xs sm:text-sm [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",placeholder:"请输入数量",min:"0",step:"0.01"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1915,columnNumber:27},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1911,columnNumber:25},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1887,columnNumber:23},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1789,columnNumber:21},this)]},s,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1776,columnNumber:19},this))},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1774,columnNumber:15},this),t.jsxDEV("div",{className:"mt-4 sm:mt-6 grid grid-cols-2 gap-2 sm:flex sm:justify-between sm:items-center",children:[t.jsxDEV("button",{onClick:()=>{K(e=>[...e,Y()]);const e=J.length;X(t=>({...t,[e]:""})),$(t=>({...t,[e]:!1}))},className:"px-2 py-2 sm:px-4 sm:py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 transition-colors flex items-center justify-center gap-1 sm:gap-2 text-xs sm:text-sm",children:[t.jsxDEV(i,{className:"w-3 h-3 sm:w-4 sm:h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1938,columnNumber:19},this),t.jsxDEV("span",{className:"hidden sm:inline",children:"添加新记录项"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1939,columnNumber:19},this),t.jsxDEV("span",{className:"sm:hidden",children:"添加记录"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1940,columnNumber:19},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1934,columnNumber:17},this),t.jsxDEV("button",{onClick:()=>{if(!P.supervisor_id)return void u.error("❌ 请选择班长",{duration:4e3,description:"班长是必填项，请在基本信息中选择班长"});if(!P.section_chief_id)return void u.error("❌ 请选择段长",{duration:4e3,description:"段长是必填项，请在基本信息中选择段长"});const e=J.filter(e=>e.work_type_id&&e.process_id&&e.quantity>0);for(let t=0;t<e.length;t++){const s=e[t],m=j.find(e=>e.id===s.product_id);if(!m||!m.name||""===m.name.trim())return void u.error("❌ 产品名称不完整",{duration:4e3,description:"第 ".concat(J.indexOf(s)+1," 条记录的产品名称不完整，请重新选择产品")})}re(!0)},className:"px-2 py-2 sm:px-6 sm:py-2 rounded-md focus:outline-none focus:ring-2 transition-colors text-xs sm:text-sm font-medium ".concat(0!==J.filter(e=>e.work_type_id&&e.process_id&&e.quantity>0).length&&P.supervisor_id&&P.section_chief_id?"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500":"bg-gray-500 text-gray-300 cursor-not-allowed"),disabled:0===J.filter(e=>e.work_type_id&&e.process_id&&e.quantity>0).length||!P.supervisor_id||!P.section_chief_id,children:"提交审核"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1942,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1933,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1765,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1629,columnNumber:11},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1627,columnNumber:9},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1597,columnNumber:7},this),t.jsxDEV(N,{isOpen:ne,onClose:()=>re(!1),onConfirm:async()=>{re(!1),await(async()=>{const e=J.filter(e=>e.work_type_id&&e.process_id&&e.quantity>0),t=[...P.items,...e.map(e=>({...e,total_amount:e.quantity}))];e.length>0&&u.success("成功添加 ".concat(e.length," 条工时记录")),await _e(t)})()},record:P,items:J.filter(e=>e.work_type_id&&e.process_id&&e.quantity>0),productionLines:v,supervisors:R,sectionLeaders:q,workTypes:_,products:j,processes:T},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1965,columnNumber:7},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetRecord.tsx",lineNumber:1596,columnNumber:5},this)}},Symbol.toStringTag,{value:"Module"})),f=Object.freeze(Object.defineProperty({__proto__:null,default:function(){var n,r,i,g,N,x;const{user:p}=d(),[b,f]=e.useState(!0),[v,w]=e.useState(!1),[_,k]=e.useState([]),[j,E]=e.useState([]),[T,D]=e.useState([]),[V,H]=e.useState({startDate:new Date(Date.now()-2592e6).toISOString().split("T")[0],endDate:(new Date).toISOString().split("T")[0],status:"",productionLineId:"",workTypeId:"",productId:""}),[R,S]=e.useState([]),[q,C]=e.useState(null),[I,L]=e.useState(!1),[O,F]=e.useState(null),[z,M]=e.useState(!1),[P,A]=e.useState(!1),[B,G]=e.useState(1),[U,W]=e.useState(1),[Y,J]=e.useState(0);e.useEffect(()=>{K()},[]),e.useEffect(()=>{$()},[B]);const K=async()=>{try{f(!0),await Promise.all([Q(),X(),Z()]),await $()}catch(e){u.error("加载数据失败")}finally{f(!1)}},Q=async()=>{try{const{data:e,error:t}=await y.from("processes").select("production_line");if(t)throw t;const s=(e?[...new Set(e.map(e=>e.production_line).filter(Boolean))]:[]).map((e,t)=>({id:t+1,name:e}));k(s)}catch(e){k([])}},X=async()=>{const{data:e,error:t}=await y.from("work_types").select("id, name").eq("is_active",!0).order("name");if(t)throw t;E(e||[])},Z=async()=>{const{data:e,error:t}=await y.from("products").select("id, name, code").eq("is_active",!0).order("name");if(t)throw t;D(e||[])},$=async(e=!1)=>{if(p)try{w(!0),e&&G(1);const t=10*((e?1:B)-1);let s=y.from("timesheet_records").select("*",{count:"exact"}).eq("user_id",p.id).gte("record_date",V.startDate).lte("record_date",V.endDate).order("record_date",{ascending:!1}).order("created_at",{ascending:!1}).range(t,t+10-1);V.status&&(s=s.eq("status",V.status)),V.productionLineId&&(s=s.eq("production_line_id",parseInt(V.productionLineId)));const{data:m,error:n,count:r}=await s;if(n)throw n;const i=(null==m?void 0:m.map(e=>e.id))||[];let a=[];if(i.length>0){const{data:e,error:t}=await y.from("timesheet_record_items").select("*").in("timesheet_record_id",i);if(t)throw t;a=e||[]}const o=(null==m?void 0:m.map(e=>{const t=a.filter(t=>t.timesheet_record_id===e.id);return{...e,items:t,total_amount:t.reduce((e,t)=>e+t.quantity*t.unit_price,0)||0}}))||[];S(o),J(r||0),W(Math.ceil((r||0)/10))}catch(t){u.error("查询失败，请重试")}finally{w(!1)}},ee=(e,t)=>{H(s=>({...s,[e]:t}))},te=()=>{M(!1),F(null)},se=e=>{switch(e){case"draft":return"草稿";case"submitted":return"已提交";case"approved":return"已审核";case"rejected":return"已拒绝";default:return e}},me=e=>{switch(e){case"draft":default:return"bg-gray-600 text-gray-300";case"submitted":return"bg-yellow-600 text-yellow-100";case"approved":return"bg-green-600 text-green-100";case"rejected":return"bg-red-600 text-red-100"}};return b?t.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center",children:t.jsxDEV("div",{className:"text-green-400 text-xl animate-pulse font-mono",children:"加载中..."},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:346,columnNumber:9},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:345,columnNumber:7},this):t.jsxDEV("div",{className:"min-h-screen bg-black text-green-300",children:[t.jsxDEV("header",{className:"bg-gray-900 border-b border-green-400 px-6 py-4",children:t.jsxDEV("div",{className:"max-w-7xl mx-auto",children:[t.jsxDEV("h1",{className:"text-2xl font-bold text-green-400 font-mono flex items-center gap-2",children:[t.jsxDEV(s,{className:"w-8 h-8"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:359,columnNumber:13},this),"工时记录历史"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:358,columnNumber:11},this),t.jsxDEV("p",{className:"text-green-600 text-sm font-mono mt-1",children:"TIMESHEET HISTORY MANAGEMENT"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:362,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:357,columnNumber:9},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:356,columnNumber:7},this),t.jsxDEV("div",{className:"max-w-7xl mx-auto p-6",children:[t.jsxDEV("div",{className:"bg-gray-900 border border-green-400 rounded-lg p-6 mb-6",children:[t.jsxDEV("h2",{className:"text-xl font-bold text-green-400 font-mono mb-4 flex items-center gap-2",children:[t.jsxDEV(a,{className:"w-5 h-5"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:372,columnNumber:13},this),"查询条件"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:371,columnNumber:11},this),t.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4",children:[t.jsxDEV("div",{children:[t.jsxDEV("label",{className:"block text-green-300 font-mono text-sm mb-2",children:"开始日期"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:378,columnNumber:15},this),t.jsxDEV("input",{type:"date",value:V.startDate,onChange:e=>ee("startDate",e.target.value),className:"w-full px-3 py-2 bg-gray-800 border border-green-600 rounded text-green-300 font-mono focus:outline-none focus:border-green-400"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:381,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:377,columnNumber:13},this),t.jsxDEV("div",{children:[t.jsxDEV("label",{className:"block text-green-300 font-mono text-sm mb-2",children:"结束日期"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:390,columnNumber:15},this),t.jsxDEV("input",{type:"date",value:V.endDate,onChange:e=>ee("endDate",e.target.value),className:"w-full px-3 py-2 bg-gray-800 border border-green-600 rounded text-green-300 font-mono focus:outline-none focus:border-green-400"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:393,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:389,columnNumber:13},this),t.jsxDEV("div",{children:[t.jsxDEV("label",{className:"block text-green-300 font-mono text-sm mb-2",children:"状态"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:402,columnNumber:15},this),t.jsxDEV("select",{value:V.status,onChange:e=>ee("status",e.target.value),className:"w-full px-3 py-2 bg-gray-800 border border-green-600 rounded text-green-300 font-mono focus:outline-none focus:border-green-400",children:[t.jsxDEV("option",{value:"",children:"全部状态"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:410,columnNumber:17},this),t.jsxDEV("option",{value:"draft",children:"草稿"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:411,columnNumber:17},this),t.jsxDEV("option",{value:"submitted",children:"已提交"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:412,columnNumber:17},this),t.jsxDEV("option",{value:"approved",children:"已审核"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:413,columnNumber:17},this),t.jsxDEV("option",{value:"rejected",children:"已拒绝"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:414,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:405,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:401,columnNumber:13},this),t.jsxDEV("div",{children:[t.jsxDEV("label",{className:"block text-green-300 font-mono text-sm mb-2",children:"生产线"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:419,columnNumber:15},this),t.jsxDEV("select",{value:V.productionLineId,onChange:e=>ee("productionLineId",e.target.value),className:"w-full px-3 py-2 bg-gray-800 border border-green-600 rounded text-green-300 font-mono focus:outline-none focus:border-green-400",children:[t.jsxDEV("option",{value:"",children:"全部生产线"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:427,columnNumber:17},this),_.map(e=>t.jsxDEV("option",{value:e.id,children:e.name},e.id,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:429,columnNumber:19},this))]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:422,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:418,columnNumber:13},this),t.jsxDEV("div",{children:[t.jsxDEV("label",{className:"block text-green-300 font-mono text-sm mb-2",children:"工时类型"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:435,columnNumber:15},this),t.jsxDEV("select",{value:V.workTypeId,onChange:e=>ee("workTypeId",e.target.value),className:"w-full px-3 py-2 bg-gray-800 border border-green-600 rounded text-green-300 font-mono focus:outline-none focus:border-green-400",children:[t.jsxDEV("option",{value:"",children:"全部类型"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:443,columnNumber:17},this),j.map(e=>t.jsxDEV("option",{value:e.id,children:e.name},e.id,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:445,columnNumber:19},this))]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:438,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:434,columnNumber:13},this),t.jsxDEV("div",{children:[t.jsxDEV("label",{className:"block text-green-300 font-mono text-sm mb-2",children:"产品"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:451,columnNumber:15},this),t.jsxDEV("select",{value:V.productId,onChange:e=>ee("productId",e.target.value),className:"w-full px-3 py-2 bg-gray-800 border border-green-600 rounded text-green-300 font-mono focus:outline-none focus:border-green-400",children:[t.jsxDEV("option",{value:"",children:"全部产品"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:459,columnNumber:17},this),T.map(e=>t.jsxDEV("option",{value:e.id,children:[e.name," (",e.code,")"]},e.id,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:461,columnNumber:19},this))]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:454,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:450,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:376,columnNumber:11},this),t.jsxDEV("div",{className:"flex gap-2",children:[t.jsxDEV("button",{onClick:()=>{$(!0)},disabled:v,className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-500 disabled:bg-gray-600 text-white font-bold rounded transition-colors font-mono",children:[t.jsxDEV(o,{className:"w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:473,columnNumber:15},this),v?"查询中...":"查询"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:468,columnNumber:13},this),t.jsxDEV("button",{onClick:()=>{H({startDate:new Date(Date.now()-2592e6).toISOString().split("T")[0],endDate:(new Date).toISOString().split("T")[0],status:"",productionLineId:"",workTypeId:"",productId:""}),G(1)},className:"flex items-center gap-2 px-4 py-2 bg-gray-600 hover:bg-gray-500 text-white font-bold rounded transition-colors font-mono",children:[t.jsxDEV(m,{className:"w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:481,columnNumber:15},this),"重置"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:477,columnNumber:13},this),t.jsxDEV("button",{onClick:async()=>{try{u.info("导出功能开发中...")}catch(e){u.error("导出失败")}},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white font-bold rounded transition-colors font-mono",children:[t.jsxDEV(l,{className:"w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:489,columnNumber:15},this),"导出"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:485,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:467,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:370,columnNumber:9},this),t.jsxDEV("div",{className:"bg-gray-900 border border-green-400 rounded-lg p-4 mb-6",children:t.jsxDEV("div",{className:"flex justify-between items-center",children:[t.jsxDEV("div",{className:"text-green-300 font-mono",children:["共找到 ",t.jsxDEV("span",{className:"text-green-400 font-bold",children:Y},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:499,columnNumber:19},this)," 条记录"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:498,columnNumber:13},this),t.jsxDEV("div",{className:"text-green-300 font-mono",children:["总金额: ",t.jsxDEV("span",{className:"text-green-400 font-bold",children:["￥",R.reduce((e,t)=>e+(t.total_amount||0),0).toFixed(2)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:502,columnNumber:20},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:501,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:497,columnNumber:11},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:496,columnNumber:9},this),t.jsxDEV("div",{className:"bg-gray-900 border border-green-400 rounded-lg overflow-hidden",children:t.jsxDEV("div",{className:"overflow-x-auto",children:t.jsxDEV("table",{className:"w-full",children:[t.jsxDEV("thead",{className:"bg-gray-800 border-b border-green-600",children:t.jsxDEV("tr",{children:[t.jsxDEV("th",{className:"px-4 py-3 text-left text-green-400 font-mono text-sm",children:"记录日期"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:513,columnNumber:19},this),t.jsxDEV("th",{className:"px-4 py-3 text-left text-green-400 font-mono text-sm",children:"生产线"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:514,columnNumber:19},this),t.jsxDEV("th",{className:"px-4 py-3 text-left text-green-400 font-mono text-sm",children:"工时项数"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:515,columnNumber:19},this),t.jsxDEV("th",{className:"px-4 py-3 text-left text-green-400 font-mono text-sm",children:"总金额"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:516,columnNumber:19},this),t.jsxDEV("th",{className:"px-4 py-3 text-left text-green-400 font-mono text-sm",children:"状态"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:517,columnNumber:19},this),t.jsxDEV("th",{className:"px-4 py-3 text-left text-green-400 font-mono text-sm",children:"创建时间"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:518,columnNumber:19},this),t.jsxDEV("th",{className:"px-4 py-3 text-left text-green-400 font-mono text-sm",children:"操作"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:519,columnNumber:19},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:512,columnNumber:17},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:511,columnNumber:15},this),t.jsxDEV("tbody",{children:0===R.length?t.jsxDEV("tr",{children:t.jsxDEV("td",{colSpan:7,className:"px-4 py-8 text-center",children:[t.jsxDEV(s,{className:"w-12 h-12 text-green-600 mx-auto mb-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:526,columnNumber:23},this),t.jsxDEV("p",{className:"text-green-600 font-mono",children:"暂无工时记录"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:527,columnNumber:23},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:525,columnNumber:21},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:524,columnNumber:19},this):R.map(e=>{var s,m;return t.jsxDEV("tr",{className:"border-b border-green-800 hover:bg-gray-800 transition-colors",children:[t.jsxDEV("td",{className:"px-4 py-3 text-green-300 font-mono text-sm",children:e.record_date},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:533,columnNumber:23},this),t.jsxDEV("td",{className:"px-4 py-3 text-green-300 font-mono text-sm",children:null==(s=e.production_line)?void 0:s.name},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:536,columnNumber:23},this),t.jsxDEV("td",{className:"px-4 py-3 text-green-300 font-mono text-sm",children:(null==(m=e.items)?void 0:m.length)||0},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:539,columnNumber:23},this),t.jsxDEV("td",{className:"px-4 py-3 text-green-300 font-mono text-sm",children:["￥",(e.total_amount||0).toFixed(2)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:542,columnNumber:23},this),t.jsxDEV("td",{className:"px-4 py-3",children:t.jsxDEV("span",{className:"px-2 py-1 rounded text-xs font-mono ".concat(me(e.status)),children:se(e.status)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:546,columnNumber:25},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:545,columnNumber:23},this),t.jsxDEV("td",{className:"px-4 py-3 text-green-300 font-mono text-sm",children:new Date(e.created_at).toLocaleString("zh-CN")},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:550,columnNumber:23},this),t.jsxDEV("td",{className:"px-4 py-3",children:t.jsxDEV("div",{className:"flex items-center gap-2",children:[t.jsxDEV("button",{onClick:()=>(e=>{C(e),L(!0)})(e),className:"p-1 text-blue-400 hover:text-blue-300 transition-colors",title:"查看详情",children:t.jsxDEV(c,{className:"w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:560,columnNumber:29},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:555,columnNumber:27},this),"draft"===e.status&&t.jsxDEV("button",{onClick:()=>(e=>{"draft"===e.status?(F(e),M(!0)):u.error("只有草稿状态的工时记录可以删除")})(e),className:"p-1 text-red-400 hover:text-red-300 transition-colors",title:"删除记录",children:t.jsxDEV(h,{className:"w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:568,columnNumber:31},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:563,columnNumber:29},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:554,columnNumber:25},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:553,columnNumber:23},this)]},e.id,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:532,columnNumber:21},this)})},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:522,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:510,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:509,columnNumber:11},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:508,columnNumber:9},this),U>1&&t.jsxDEV("div",{className:"flex justify-center items-center gap-2 mt-6",children:[t.jsxDEV("button",{onClick:()=>G(e=>Math.max(1,e-1)),disabled:1===B,className:"px-3 py-2 bg-gray-700 hover:bg-gray-600 disabled:bg-gray-800 text-green-300 font-mono rounded transition-colors",children:"上一页"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:584,columnNumber:13},this),t.jsxDEV("span",{className:"text-green-300 font-mono",children:["第 ",B," 页，共 ",U," 页"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:592,columnNumber:13},this),t.jsxDEV("button",{onClick:()=>G(e=>Math.min(U,e+1)),disabled:B===U,className:"px-3 py-2 bg-gray-700 hover:bg-gray-600 disabled:bg-gray-800 text-green-300 font-mono rounded transition-colors",children:"下一页"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:596,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:583,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:368,columnNumber:7},this),I&&q&&t.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:t.jsxDEV("div",{className:"bg-gray-900 border border-green-400 rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:t.jsxDEV("div",{className:"p-6",children:[t.jsxDEV("div",{className:"flex justify-between items-center mb-6",children:[t.jsxDEV("h2",{className:"text-xl font-bold text-green-400 font-mono",children:"工时记录详情"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:613,columnNumber:17},this),t.jsxDEV("button",{onClick:()=>L(!1),className:"text-green-400 hover:text-green-300 transition-colors",children:"✕"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:616,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:612,columnNumber:15},this),t.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[t.jsxDEV("div",{className:"space-y-2",children:[t.jsxDEV("div",{className:"text-green-300 font-mono text-sm",children:[t.jsxDEV("span",{className:"text-green-600",children:"记录日期:"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:628,columnNumber:21},this)," ",q.record_date]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:627,columnNumber:19},this),t.jsxDEV("div",{className:"text-green-300 font-mono text-sm",children:[t.jsxDEV("span",{className:"text-green-600",children:"生产线:"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:631,columnNumber:21},this)," ",null==(n=q.production_line)?void 0:n.name]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:630,columnNumber:19},this),t.jsxDEV("div",{className:"text-green-300 font-mono text-sm",children:[t.jsxDEV("span",{className:"text-green-600",children:"班长:"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:634,columnNumber:21},this)," ",(null==(r=q.supervisor)?void 0:r.name)||"未指定"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:633,columnNumber:19},this),t.jsxDEV("div",{className:"text-green-300 font-mono text-sm",children:[t.jsxDEV("span",{className:"text-green-600",children:"段长:"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:637,columnNumber:21},this)," ",(null==(i=q.section_chief)?void 0:i.name)||"未指定"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:636,columnNumber:19},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:626,columnNumber:17},this),t.jsxDEV("div",{className:"space-y-2",children:[t.jsxDEV("div",{className:"text-green-300 font-mono text-sm",children:[t.jsxDEV("span",{className:"text-green-600",children:"状态:"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:642,columnNumber:21},this),t.jsxDEV("span",{className:"ml-2 px-2 py-1 rounded text-xs ".concat(me(q.status)),children:se(q.status)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:643,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:641,columnNumber:19},this),t.jsxDEV("div",{className:"text-green-300 font-mono text-sm",children:[t.jsxDEV("span",{className:"text-green-600",children:"创建时间:"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:648,columnNumber:21},this)," ",new Date(q.created_at).toLocaleString("zh-CN")]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:647,columnNumber:19},this),t.jsxDEV("div",{className:"text-green-300 font-mono text-sm",children:[t.jsxDEV("span",{className:"text-green-600",children:"更新时间:"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:651,columnNumber:21},this)," ",new Date(q.updated_at).toLocaleString("zh-CN")]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:650,columnNumber:19},this),t.jsxDEV("div",{className:"text-green-300 font-mono text-sm",children:[t.jsxDEV("span",{className:"text-green-600",children:"总金额:"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:654,columnNumber:21},this)," ￥",(q.total_amount||0).toFixed(2)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:653,columnNumber:19},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:640,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:625,columnNumber:15},this),t.jsxDEV("div",{children:[t.jsxDEV("h3",{className:"text-lg font-bold text-green-400 font-mono mb-4",children:"工时明细"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:661,columnNumber:17},this),t.jsxDEV("div",{className:"overflow-x-auto",children:t.jsxDEV("table",{className:"w-full",children:[t.jsxDEV("thead",{className:"bg-gray-800 border-b border-green-600",children:t.jsxDEV("tr",{children:[t.jsxDEV("th",{className:"px-4 py-2 text-left text-green-400 font-mono text-sm",children:"工时类型"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:668,columnNumber:25},this),t.jsxDEV("th",{className:"px-4 py-2 text-left text-green-400 font-mono text-sm",children:"产品"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:669,columnNumber:25},this),t.jsxDEV("th",{className:"px-4 py-2 text-left text-green-400 font-mono text-sm",children:"工序"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:670,columnNumber:25},this),t.jsxDEV("th",{className:"px-4 py-2 text-left text-green-400 font-mono text-sm",children:"数量"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:671,columnNumber:25},this),t.jsxDEV("th",{className:"px-4 py-2 text-left text-green-400 font-mono text-sm",children:"单位"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:672,columnNumber:25},this),t.jsxDEV("th",{className:"px-4 py-2 text-left text-green-400 font-mono text-sm",children:"单价"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:673,columnNumber:25},this),t.jsxDEV("th",{className:"px-4 py-2 text-left text-green-400 font-mono text-sm",children:"小计"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:674,columnNumber:25},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:667,columnNumber:23},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:666,columnNumber:21},this),t.jsxDEV("tbody",{children:(null==(g=q.items)?void 0:g.map((e,s)=>{var m,n,r,i;return t.jsxDEV("tr",{className:"border-b border-green-800",children:[t.jsxDEV("td",{className:"px-4 py-2 text-green-300 font-mono text-sm",children:null==(m=e.work_type)?void 0:m.name},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:680,columnNumber:27},this),t.jsxDEV("td",{className:"px-4 py-2 text-green-300 font-mono text-sm",children:[null==(n=e.product)?void 0:n.name," (",null==(r=e.product)?void 0:r.code,")"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:683,columnNumber:27},this),t.jsxDEV("td",{className:"px-4 py-2 text-green-300 font-mono text-sm",children:null==(i=e.process)?void 0:i.name},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:686,columnNumber:27},this),t.jsxDEV("td",{className:"px-4 py-2 text-green-300 font-mono text-sm",children:e.quantity},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:689,columnNumber:27},this),t.jsxDEV("td",{className:"px-4 py-2 text-green-300 font-mono text-sm",children:e.unit},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:692,columnNumber:27},this),t.jsxDEV("td",{className:"px-4 py-2 text-green-300 font-mono text-sm",children:["￥",e.unit_price.toFixed(2)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:695,columnNumber:27},this),t.jsxDEV("td",{className:"px-4 py-2 text-green-300 font-mono text-sm",children:["￥",(e.quantity*e.unit_price).toFixed(2)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:698,columnNumber:27},this)]},e.id||s,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:679,columnNumber:25},this)}))||[]},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:677,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:665,columnNumber:19},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:664,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:660,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:611,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:610,columnNumber:11},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:609,columnNumber:9},this),z&&O&&t.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:t.jsxDEV("div",{className:"bg-gray-900 border border-red-400 rounded-lg max-w-md w-full",children:t.jsxDEV("div",{className:"p-6",children:[t.jsxDEV("div",{className:"flex justify-between items-center mb-4",children:[t.jsxDEV("h2",{className:"text-xl font-bold text-red-400 font-mono",children:"确认删除"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:718,columnNumber:17},this),t.jsxDEV("button",{onClick:te,className:"text-red-400 hover:text-red-300 transition-colors",disabled:P,children:"✕"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:721,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:717,columnNumber:15},this),t.jsxDEV("div",{className:"mb-6",children:[t.jsxDEV("p",{className:"text-red-300 font-mono mb-2",children:"您确定要删除以下工时记录吗？"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:731,columnNumber:17},this),t.jsxDEV("div",{className:"bg-gray-800 border border-red-600 rounded p-3",children:t.jsxDEV("div",{className:"text-green-300 font-mono text-sm space-y-1",children:[t.jsxDEV("div",{children:[t.jsxDEV("span",{className:"text-red-400",children:"记录日期:"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:736,columnNumber:26},this)," ",O.record_date]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:736,columnNumber:21},this),t.jsxDEV("div",{children:[t.jsxDEV("span",{className:"text-red-400",children:"生产线:"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:737,columnNumber:26},this)," ",null==(N=O.production_line)?void 0:N.name]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:737,columnNumber:21},this),t.jsxDEV("div",{children:[t.jsxDEV("span",{className:"text-red-400",children:"工时项数:"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:738,columnNumber:26},this)," ",(null==(x=O.items)?void 0:x.length)||0]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:738,columnNumber:21},this),t.jsxDEV("div",{children:[t.jsxDEV("span",{className:"text-red-400",children:"总金额:"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:739,columnNumber:26},this)," ￥",(O.total_amount||0).toFixed(2)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:739,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:735,columnNumber:19},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:734,columnNumber:17},this),t.jsxDEV("p",{className:"text-red-400 font-mono text-sm mt-3",children:"⚠️ 此操作将同时删除所有相关的工时明细和审核历史，且无法恢复！"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:742,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:730,columnNumber:15},this),t.jsxDEV("div",{className:"flex justify-end gap-3",children:[t.jsxDEV("button",{onClick:te,disabled:P,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 disabled:bg-gray-800 text-green-300 font-mono rounded transition-colors",children:"取消"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:748,columnNumber:17},this),t.jsxDEV("button",{onClick:async()=>{if(O)try{A(!0);const{error:e}=await y.from("timesheet_records").delete().eq("id",O.id).eq("user_id",null==p?void 0:p.id);if(e)throw e;u.success("工时记录删除成功"),await $(),M(!1),F(null)}catch(e){u.error("删除失败，请重试")}finally{A(!1)}},disabled:P,className:"px-4 py-2 bg-red-600 hover:bg-red-500 disabled:bg-red-800 text-white font-mono rounded transition-colors flex items-center gap-2",children:P?t.jsxDEV(t.Fragment,{children:[t.jsxDEV("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:762,columnNumber:23},this),"删除中..."]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:761,columnNumber:21},this):t.jsxDEV(t.Fragment,{children:[t.jsxDEV(h,{className:"w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:767,columnNumber:23},this),"确认删除"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:766,columnNumber:21},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:755,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:747,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:716,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:715,columnNumber:11},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:714,columnNumber:9},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/TimesheetHistory.tsx",lineNumber:354,columnNumber:5},this)}},Symbol.toStringTag,{value:"Module"}));export{b as T,f as a};
