var e=Object.defineProperty,s=Object.defineProperties,n=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,m=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,a=(s,n,t)=>n in s?e(s,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[n]=t,o=(e,s)=>{for(var n in s||(s={}))m.call(s,n)&&a(e,n,s[n]);if(t)for(var n of t(s))r.call(s,n)&&a(e,n,s[n]);return e},i=(e,t)=>s(e,n(t)),l=(e,s,n)=>new Promise((t,m)=>{var r=e=>{try{o(n.next(e))}catch(s){m(s)}},a=e=>{try{o(n.throw(e))}catch(s){m(s)}},o=e=>e.done?t(e.value):Promise.resolve(e.value).then(r,a);o((n=n.apply(e,s)).next())});import{r as c,d as u,j as d,U as g,f as h,l as N,G as x,D as p,X as b,P as y,k as f,B as v,h as w,s as k,I as E,O as j,T as _,J as D}from"./react-core-CEw6lU7H.js";import{u as U,s as M,i as V}from"./index-B8HpeRWN.js";import{t as R}from"./ui-BmDV7GQB.js";import"./vendor-Dj0T90Ik.js";import"./supabase-DInoECZ_.js";function q(){var e,s,n,t,m,r,a,q,$,S,C,P,O,L,I,T,z,G,A,B,F,J;const[H,K]=c.useState([]),[Q,W]=c.useState([]),[X,Y]=c.useState([]),[Z,ee]=c.useState([]),[se,ne]=c.useState(!1),[te,me]=c.useState(!0),[re,ae]=c.useState(""),[oe,ie]=c.useState(!1),[le,ce]=c.useState(null),[ue,de]=c.useState({phone:"",id_card:"",name:"",company_id:"",role_id:"",production_line:"",is_active:!1}),[ge,he]=c.useState(!1),[Ne,xe]=c.useState(!1),[pe,be]=c.useState(null),[ye,fe]=c.useState(!1),[ve,we]=c.useState({user:null,oldRole:null,newRole:null,pendingRecords:[],sameRoleUsers:[],userNames:[]}),[ke,Ee]=c.useState(""),[je,_e]=c.useState(!1),[De,Ue]=c.useState({user:null,oldProductionLine:"",newProductionLine:"",role:null,pendingRecords:[],sameRoleUsers:[],userNames:[]}),[Me,Ve]=c.useState(""),[Re,qe]=c.useState(""),{user:$e,loading:Se}=U(),Ce=u();if(c.useEffect(()=>{if(!Se&&!$e)return console.log("ç”¨æˆ·æœªç™»å½•ï¼Œé‡å®šå‘åˆ°ç™»å½•é¡µé¢"),void Ce("/login")},[$e,Se,Ce]),Se)return d.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center",children:d.jsxDEV("div",{className:"text-center",children:[d.jsxDEV("div",{className:"text-green-400 text-2xl font-mono mb-4",children:"åŠ è½½ä¸­..."},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:101,columnNumber:11},this),d.jsxDEV("div",{className:"text-green-600 font-mono",children:"æ­£åœ¨éªŒè¯ç”¨æˆ·èº«ä»½"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:102,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:100,columnNumber:9},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:99,columnNumber:7},this);c.useEffect(()=>{Pe()},[]);const Pe=()=>l(this,null,function*(){var e,s,n;try{if(!$e)return console.error("fetchData: ç”¨æˆ·ä¿¡æ¯ä¸å­˜åœ¨"),void R.error("ç”¨æˆ·ä¿¡æ¯ä¸å­˜åœ¨");let t=M.from("users").select("\n          *,\n          company:companies(name),\n          role:user_roles(name, permissions)\n        ");if(V($e.role))console.log("fetchData: è¶…çº§ç®¡ç†å‘˜ï¼Œä¸æ·»åŠ å…¬å¸è¿‡æ»¤");else{if(!(null==(e=$e.company)?void 0:e.id))return console.error("fetchData: ç”¨æˆ·æ²¡æœ‰å…³è”çš„å…¬å¸ID"),void R.error("ç”¨æˆ·æ²¡æœ‰å…³è”çš„å…¬å¸ï¼Œè¯·è”ç³»ç®¡ç†å‘˜");t=t.eq("company_id",$e.company.id),console.log("fetchData: æ·»åŠ å…¬å¸è¿‡æ»¤æ¡ä»¶",$e.company.id)}const{data:m,error:r}=yield t.order("created_at",{ascending:!1});if(r)throw r;let a=M.from("companies").select("*");V($e.role)||(a=a.eq("id",null==(s=$e.company)?void 0:s.id));const{data:l,error:c}=yield a.order("name");if(c)throw c;const{data:u,error:d}=yield M.from("user_roles").select("*").order("name");if(d)throw d;K(m||[]),W(l||[]),Y(u||[]),!V($e.role)&&(null==(n=$e.company)?void 0:n.id)&&de(e=>i(o({},e),{company_id:$e.company.id}))}catch(t){console.error("è·å–æ•°æ®å¤±è´¥:",t),qe("è·å–æ•°æ®å¤±è´¥")}finally{me(!1)}}),Oe=e=>l(this,null,function*(){var s,n;console.log("handleDelete å‡½æ•°è¢«è°ƒç”¨ï¼Œç”¨æˆ·æ•°æ®:",e),console.log("å½“å‰ç™»å½•ç”¨æˆ·:",$e),console.log("ç”¨æˆ·è§’è‰²:",null==$e?void 0:$e.role);try{if(V($e.role))console.log("è¶…çº§ç®¡ç†å‘˜ï¼Œè·³è¿‡å…¬å¸æƒé™æ£€æŸ¥");else{if(console.log("éè¶…çº§ç®¡ç†å‘˜ï¼Œæ£€æŸ¥å…¬å¸æƒé™"),e.company_id!==(null==(s=$e.company)?void 0:s.id))return console.log("æƒé™æ£€æŸ¥å¤±è´¥ï¼šç”¨æˆ·å…¬å¸IDä¸åŒ¹é…",e.company_id,null==(n=$e.company)?void 0:n.id),void R.error("æ‚¨åªèƒ½åˆ é™¤è‡ªå·±å…¬å¸çš„ç”¨æˆ·");console.log("æƒé™æ£€æŸ¥é€šè¿‡")}const m=X.find(s=>s.id===e.role_id);if(console.log("ç”¨æˆ·è§’è‰²ä¿¡æ¯:",m),m&&"è¶…çº§ç®¡ç†å‘˜"===m.name)return console.log("é˜»æ­¢åˆ é™¤è¶…çº§ç®¡ç†å‘˜"),void R.error("è¶…çº§ç®¡ç†å‘˜è§’è‰²ä¸èƒ½è¢«åˆ é™¤ï¼Œè¿™æ˜¯ç³»ç»Ÿä¿æŠ¤æœºåˆ¶");if(m&&("ç­é•¿"===m.name||"æ®µé•¿"===m.name))try{console.log("æ£€æŸ¥ç­é•¿/æ®µé•¿çš„å¾…å®¡æ ¸æ•°æ®");let s=M.from("timesheet_records").select("id, user_id, status");"ç­é•¿"===m.name?s=s.eq("supervisor_id",e.id):"æ®µé•¿"===m.name&&(s=s.eq("section_chief_id",e.id));const{data:n,error:t}=yield s;if(console.log("æ‰€æœ‰ç›¸å…³å·¥æ—¶è®°å½•:",n,"é”™è¯¯:",t),n&&n.length>0){const e=n.reduce((e,s)=>(e[s.status]=(e[s.status]||0)+1,e),{});console.log("çŠ¶æ€ç»Ÿè®¡:",e)}let r=M.from("timesheet_records").select("id, user_id, status");if("ç­é•¿"===m.name)r=r.in("status",["pending","å¾…å®¡æ ¸","submitted","å·²æäº¤"]).eq("supervisor_id",e.id);else if("æ®µé•¿"===m.name){console.log("=== æ®µé•¿åˆ é™¤è°ƒè¯•å¼€å§‹ ==="),console.log("æ®µé•¿ç”¨æˆ·ä¿¡æ¯:",{id:e.id,name:e.name,production_line:e.production_line});const{data:s,error:n}=yield M.from("timesheet_records").select("id, user_id, status, section_chief_id, supervisor_id, work_date, created_at").eq("section_chief_id",e.id);if(console.log("è¯¥æ®µé•¿çš„æ‰€æœ‰ç›¸å…³è®°å½•:",s),console.log("æŸ¥è¯¢æ‰€æœ‰è®°å½•çš„é”™è¯¯:",n),s){console.log("è®°å½•æ€»æ•°:",s.length);const e=s.reduce((e,s)=>(e[s.status]=(e[s.status]||0)+1,e),{});console.log("å„çŠ¶æ€è®°å½•æ•°é‡:",e),s.forEach(e=>{console.log(`è®°å½• ${e.id}: status=${e.status}, section_chief_id=${e.section_chief_id}, user_id=${e.user_id}, work_date=${e.work_date}`)})}console.log("æ‰§è¡Œæ®µé•¿å¾…å®¡æ ¸è®°å½•æŸ¥è¯¢ï¼Œæ¡ä»¶: status=approved, section_chief_id=",e.id),r=r.eq("status","approved").eq("section_chief_id",e.id)}const{data:a,error:l}=yield r;if(console.log("å¾…å®¡æ ¸æ•°æ®æŸ¥è¯¢ç»“æœ:",a,"é”™è¯¯:",l),console.log("æŸ¥è¯¢æ¡ä»¶ - è§’è‰²:",m.name,"ç”¨æˆ·ID:",e.id),"æ®µé•¿"===m.name&&(console.log("=== æ®µé•¿å¾…å®¡æ ¸æŸ¥è¯¢ç»“æœåˆ†æ ==="),console.log("æŸ¥è¯¢åˆ°çš„å¾…å®¡æ ¸è®°å½•æ•°é‡:",(null==a?void 0:a.length)||0),a&&a.length>0?(console.log("å¾…å®¡æ ¸è®°å½•è¯¦æƒ…:"),a.forEach(e=>{console.log(`  è®°å½• ${e.id}: status=${e.status}, user_id=${e.user_id}`)})):console.log("æ²¡æœ‰æŸ¥è¯¢åˆ°å¾…å®¡æ ¸è®°å½•"),console.log("=== æ®µé•¿åˆ é™¤è°ƒè¯•ç»“æŸ ===")),l)return console.error("æ£€æŸ¥å¾…å®¡æ ¸æ•°æ®å¤±è´¥:",l),void R.error("æ£€æŸ¥å¾…å®¡æ ¸æ•°æ®å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•");if(a&&a.length>0){console.log("å‘ç°å¾…å®¡æ ¸æ•°æ®ï¼Œå¼€å§‹å¤„ç†...","æ•°é‡:",a.length),console.log("å¾…å®¡æ ¸è®°å½•è¯¦æƒ…:",a.map(e=>({id:e.id,status:e.status,user_id:e.user_id})));const{data:s,error:n}=yield M.from("timesheet_records").select("\n              id, user_id, status, work_date, created_at, updated_at,\n              user:users!user_id(id, name, is_active)\n            ").in("id",a.map(e=>e.id));console.log("å¾…å®¡æ ¸è®°å½•è¯¦ç»†ä¿¡æ¯:",s),n&&console.error("æŸ¥è¯¢è®°å½•è¯¦æƒ…å¤±è´¥:",n);const t=(null==s?void 0:s.filter(e=>{const s=e.user,n=null==s?void 0:s.is_active,t=e.work_date&&new Date(e.work_date)<=new Date;return console.log(`è®°å½• ${e.id}: ç”¨æˆ·æ¿€æ´»=${n}, æœ‰æ•ˆæ—¥æœŸ=${t}, ç”¨æˆ·=${null==s?void 0:s.name}`),n&&t}))||[];if(console.log("æœ‰æ•ˆçš„å¾…å®¡æ ¸è®°å½•æ•°é‡:",t.length),console.log("æœ‰æ•ˆè®°å½•è¯¦æƒ…:",t),0!==t.length){const s=t,n=[...new Set(s.map(e=>e.user_id))];console.log("æ¶‰åŠçš„ç”¨æˆ·ID:",n);const{data:r}=yield M.from("users").select("name").in("id",n),a=r?r.map(e=>e.name):[];console.log("æ¶‰åŠçš„ç”¨æˆ·åç§°:",a),console.log("æŸ¥æ‰¾åŒç”Ÿäº§çº¿åŒè§’è‰²ç”¨æˆ·ï¼Œå‚æ•°:",{company_id:e.company_id,production_line:e.production_line,role_id:e.role_id,exclude_user_id:e.id});const{data:l,error:c}=yield M.from("users").select("id, name, phone").eq("company_id",e.company_id).eq("production_line",e.production_line).eq("role_id",e.role_id).eq("is_active",!0).neq("id",e.id);if(console.log("åŒè§’è‰²ç”¨æˆ·æŸ¥è¯¢ç»“æœ:",l,"é”™è¯¯:",c),c)return console.error("æŸ¥æ‰¾åŒè§’è‰²ç”¨æˆ·å¤±è´¥:",c),void R.error("æŸ¥æ‰¾æ¥æ”¶äººå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•");if(!l||0===l.length){console.log("æ²¡æœ‰æ‰¾åˆ°åˆé€‚çš„æ¥æ”¶äººï¼Œæ˜¾ç¤ºé”™è¯¯æç¤º"),console.log("ğŸš¨ ERROR: æ²¡æœ‰æ‰¾åˆ°åˆé€‚çš„æ¥æ”¶äºº - ç”¨æˆ·åˆ é™¤");const e=`æ— æ³•åˆ é™¤${m.name}ï¼šè¿˜æœ‰${s.length}æ¡å¾…å®¡æ ¸çš„å·¥æ—¶è®°å½•éœ€è¦å¤„ç†ï¼Œä½†è¯¥ç”Ÿäº§çº¿æ²¡æœ‰å…¶ä»–æ¿€æ´»çš„${m.name}å¯ä»¥æ¥æ”¶è¿™äº›æ•°æ®ã€‚æ¶‰åŠå‘˜å·¥ï¼š${a.join("ã€")}ã€‚è¯·å…ˆåœ¨è¯¥ç”Ÿäº§çº¿æ·»åŠ å…¶ä»–${m.name}æˆ–æ‰‹åŠ¨å¤„ç†è¿™äº›å¾…å®¡æ ¸æ•°æ®ã€‚`;return console.log("ğŸš¨ ERROR MESSAGE:",e),R.error(e),void console.log("ğŸš¨ Toast.error å·²è°ƒç”¨")}return console.log("æ‰¾åˆ°æ¥æ”¶äººï¼Œå‡†å¤‡è®¾ç½®åˆ é™¤ç¡®è®¤å¯¹è¯æ¡†"),be(i(o({},e),{role:m,pendingRecords:s,sameRoleUsers:l,userNames:a})),console.log("è®¾ç½®userToDeleteå®Œæˆï¼Œå‡†å¤‡æ˜¾ç¤ºåˆ é™¤ç¡®è®¤å¯¹è¯æ¡†"),xe(!0),void console.log("åˆ é™¤ç¡®è®¤å¯¹è¯æ¡†åº”è¯¥å·²æ˜¾ç¤º")}{console.log("æ‰€æœ‰å¾…å®¡æ ¸è®°å½•éƒ½æ— æ•ˆï¼Œç»§ç»­åˆ é™¤æµç¨‹");const e=a.filter(e=>!t.find(s=>s.id===e.id)).map(e=>e.id);e.length>0&&console.warn("å‘ç°æ— æ•ˆçš„å¾…å®¡æ ¸è®°å½•ï¼Œå»ºè®®æ¸…ç†:",e)}}else console.log("æ²¡æœ‰å‘ç°å¾…å®¡æ ¸æ•°æ®ï¼Œç»§ç»­åˆ é™¤æµç¨‹")}catch(t){return console.error("æ£€æŸ¥å¾…å®¡æ ¸æ•°æ®æ—¶å‡ºé”™:",t),void R.error("æ£€æŸ¥å¾…å®¡æ ¸æ•°æ®æ—¶å‡ºé”™ï¼Œè¯·ç¨åé‡è¯•")}console.log("ç­é•¿/æ®µé•¿æ²¡æœ‰å¾…å®¡æ ¸æ•°æ®ï¼Œç›´æ¥æ˜¾ç¤ºåˆ é™¤ç¡®è®¤å¯¹è¯æ¡†"),console.log("æ˜¾ç¤ºåˆ é™¤ç¡®è®¤å¯¹è¯æ¡†"),be(i(o({},e),{role:m})),console.log("è®¾ç½®userToDeleteå®Œæˆ"),xe(!0),console.log("åˆ é™¤ç¡®è®¤å¯¹è¯æ¡†åº”è¯¥å·²æ˜¾ç¤º")}catch(t){console.error("handleDeleteå‡½æ•°æ‰§è¡Œå¤±è´¥:",t),R.error("æ“ä½œå¤±è´¥ï¼š"+(t.message||"æœªçŸ¥é”™è¯¯"))}console.log("handleDeleteå‡½æ•°æ‰§è¡Œå®Œæˆ")}),[Le,Ie]=c.useState(""),Te=e=>l(this,null,function*(){var s;const n=!e.is_active;try{if(!V($e.role)&&e.company_id!==(null==(s=$e.company)?void 0:s.id))return void R.error("æ‚¨åªèƒ½ä¿®æ”¹è‡ªå·±å…¬å¸ç”¨æˆ·çš„çŠ¶æ€");console.log("æ­£åœ¨åˆ‡æ¢ç”¨æˆ·çŠ¶æ€:",e.id,e.name,"ä»",e.is_active,"åˆ°",n);const{data:t,error:m}=yield M.from("users").update({is_active:n,updated_at:(new Date).toISOString()}).eq("id",e.id).select("*");if(console.log("çŠ¶æ€åˆ‡æ¢æ“ä½œè¯¦æƒ…:",{data:t,error:m,userId:e.id,newStatus:n}),m)throw console.error("æ›´æ–°ç”¨æˆ·çŠ¶æ€å¤±è´¥:",m),m;if(!t||0===t.length)throw console.error("çŠ¶æ€æ›´æ–°æ“ä½œæ²¡æœ‰è¿”å›æ•°æ®ï¼Œè¿™é€šå¸¸è¡¨ç¤ºæƒé™é—®é¢˜æˆ–è®°å½•ä¸å­˜åœ¨"),new Error("çŠ¶æ€æ›´æ–°å¤±è´¥ï¼šæ— æ³•è·å–æ›´æ–°åçš„æ•°æ®ï¼Œè¯·æ£€æŸ¥æƒé™è®¾ç½®");console.log("çŠ¶æ€åˆ‡æ¢æˆåŠŸ:",e.name,"æ–°çŠ¶æ€:",n),R.success("ç”¨æˆ·çŠ¶æ€æ›´æ–°æˆåŠŸ"),yield Pe()}catch(t){console.error("æ›´æ–°ç”¨æˆ·çŠ¶æ€å¤±è´¥:",t),qe(t.message||"æ›´æ–°çŠ¶æ€å¤±è´¥"),R.error("æ›´æ–°ç”¨æˆ·çŠ¶æ€å¤±è´¥")}}),ze=e=>l(this,null,function*(){try{const{data:s,error:n}=yield M.from("processes").select("production_line").eq("company_id",e).not("production_line","is",null);if(n)throw n;const t=[...new Set((null==s?void 0:s.map(e=>e.production_line).filter(Boolean))||[])];ee(t)}catch(s){console.error("è·å–ç”Ÿäº§çº¿æ•°æ®å¤±è´¥:",s),ee([])}}),Ge=()=>{var e;const s={phone:"",id_card:"",name:"",company_id:"",role_id:"",production_line:"",is_active:!1};!V($e.role)&&(null==(e=$e.company)?void 0:e.id)&&(s.company_id=$e.company.id),de(s),ce(null),ie(!1),ne(!1),ee([]),qe("")},Ae=e=>{const{name:s,value:n}=e.target;if(de(i(o({},ue),{[s]:n})),"role_id"===s){const e=X.find(e=>e.id===n),s="ç­é•¿"===(null==e?void 0:e.name)||"æ®µé•¿"===(null==e?void 0:e.name);ne(s),s&&ue.company_id?ze(ue.company_id):(ee([]),de(e=>i(o({},e),{production_line:""})))}"company_id"===s&&(se&&n?ze(n):ee([]),de(e=>i(o({},e),{production_line:""})))},Be=H.filter(e=>{var s;return e.name.toLowerCase().includes(re.toLowerCase())||e.phone.includes(re)||e.id_card.includes(re)||(null==(s=e.company)?void 0:s.name)&&e.company.name.toLowerCase().includes(re.toLowerCase())}),Fe=Be.reduce((e,s)=>{var n;const t=(null==(n=s.company)?void 0:n.name)||"æœªåˆ†é…å…¬å¸";return e[t]||(e[t]=[]),e[t].push(s),e},{}),Je=Object.keys(Fe).sort();return te?d.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center",children:d.jsxDEV("div",{className:"text-green-400 text-xl animate-pulse font-mono",children:"åŠ è½½ä¸­..."},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1289,columnNumber:9},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1288,columnNumber:7},this):d.jsxDEV("div",{className:"min-h-screen bg-black text-green-300 p-6",children:d.jsxDEV("div",{className:"max-w-7xl mx-auto",children:[d.jsxDEV("div",{className:"mb-8",children:[d.jsxDEV("div",{className:"flex justify-between items-center mb-4",children:[d.jsxDEV("div",{className:"flex items-center",children:[d.jsxDEV(g,{className:"w-8 h-8 text-green-400 mr-3"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1303,columnNumber:15},this),d.jsxDEV("h1",{className:"text-4xl font-bold text-green-400 font-mono",children:"ç”¨æˆ·ç®¡ç†"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1304,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1302,columnNumber:13},this),d.jsxDEV(h,{to:"/dashboard",className:"flex items-center gap-2 px-3 py-2 sm:px-4 sm:py-2 bg-gradient-to-r from-gray-700 to-gray-800 hover:from-gray-600 hover:to-gray-700 text-green-300 hover:text-green-200 rounded-lg font-mono transition-all duration-200 shadow-md hover:shadow-lg border border-gray-600 hover:border-green-500/50",children:[d.jsxDEV(N,{className:"w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1310,columnNumber:15},this),d.jsxDEV("span",{className:"hidden sm:inline",children:"è¿”å›æ§åˆ¶å°"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1311,columnNumber:15},this),d.jsxDEV("span",{className:"sm:hidden",children:"è¿”å›"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1312,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1306,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1301,columnNumber:11},this),d.jsxDEV("div",{className:"h-1 bg-gradient-to-r from-transparent via-green-400 to-transparent"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1315,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1300,columnNumber:9},this),Re&&d.jsxDEV("div",{className:"mb-6 p-4 bg-red-900/50 border border-red-400 rounded text-red-300",children:Re},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1319,columnNumber:11},this),d.jsxDEV("div",{className:"mb-6 flex flex-col sm:flex-row gap-4 justify-between items-start sm:items-center",children:[d.jsxDEV("div",{className:"relative flex-1 max-w-md",children:[d.jsxDEV(x,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1328,columnNumber:13},this),d.jsxDEV("input",{type:"text",value:re,onChange:e=>ae(e.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-900 border border-green-400 rounded text-green-300 placeholder-green-600 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono text-sm",placeholder:"æœç´¢ç”¨æˆ·å§“åã€æ‰‹æœºå·ã€èº«ä»½è¯å·æˆ–å…¬å¸..."},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1329,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1327,columnNumber:11},this),d.jsxDEV("button",{onClick:()=>{Ge(),ie(!0)},className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-500 text-black font-bold rounded transition-colors font-mono",children:[d.jsxDEV(p,{className:"w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1346,columnNumber:13},this),"æ–°å¢ç”¨æˆ·"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1339,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1325,columnNumber:9},this),oe&&d.jsxDEV("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",children:d.jsxDEV("div",{className:"bg-gray-900 border border-green-400 rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[d.jsxDEV("div",{className:"flex justify-between items-center mb-6",children:[d.jsxDEV("h2",{className:"text-2xl font-bold text-green-400 font-mono",children:le?"ç¼–è¾‘ç”¨æˆ·":"æ–°å¢ç”¨æˆ·"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1356,columnNumber:17},this),d.jsxDEV("button",{onClick:Ge,className:"text-green-400 hover:text-green-300",children:d.jsxDEV(b,{className:"w-6 h-6"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1363,columnNumber:19},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1359,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1355,columnNumber:15},this),d.jsxDEV("form",{onSubmit:e=>l(this,null,function*(){var s,n;e.preventDefault(),he(!0),qe("");try{if(!V($e.role)){if(ue.company_id!==(null==(s=$e.company)?void 0:s.id))return R.error("æ‚¨åªèƒ½æ“ä½œè‡ªå·±å…¬å¸çš„ç”¨æˆ·"),void he(!1);if(le&&le.company_id!==(null==(n=$e.company)?void 0:n.id))return R.error("æ‚¨åªèƒ½ç¼–è¾‘è‡ªå·±å…¬å¸çš„ç”¨æˆ·"),void he(!1)}if(le){const e=X.find(e=>e.id===le.role_id),s=X.find(e=>e.id===ue.role_id),n=le.production_line!==ue.production_line;if(("ç­é•¿"===(null==e?void 0:e.name)||"æ®µé•¿"===(null==e?void 0:e.name))&&e.id!==(null==s?void 0:s.id)){console.log("æ£€æµ‹åˆ°ç­é•¿/æ®µé•¿è§’è‰²ä¿®æ”¹ï¼Œæ£€æŸ¥å¾…å®¡æ ¸æ•°æ®...");let n=M.from("timesheet_records").select("id, user_id, status").in("status",["pending","å¾…å®¡æ ¸","submitted","å·²æäº¤"]);"ç­é•¿"===e.name?n=n.eq("supervisor_id",le.id):"æ®µé•¿"===e.name&&(n=n.eq("section_chief_id",le.id));const{data:t,error:m}=yield n;if(m)throw console.error("æ£€æŸ¥å¾…å®¡æ ¸æ•°æ®å¤±è´¥:",m),new Error("æ£€æŸ¥å¾…å®¡æ ¸æ•°æ®å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•");if(t&&t.length>0){const{data:n}=yield M.from("timesheet_records").select("\n                id, user_id, status, work_date,\n                user:users!user_id(id, name, is_active)\n              ").in("id",t.map(e=>e.id)),m=(null==n?void 0:n.filter(e=>{const s=e.user,n=null==s?void 0:s.is_active,t=e.work_date&&new Date(e.work_date)<=new Date;return n&&t}))||[];if(m.length>0){const{data:n}=yield M.from("users").select("id, name, phone").eq("company_id",le.company_id).eq("production_line",le.production_line).eq("role_id",le.role_id).eq("is_active",!0).neq("id",le.id);if(!n||0===n.length){const s=[...new Set(m.map(e=>{var s;return null==(s=e.user)?void 0:s.name}))].join("ã€");console.log("è§’è‰²ä¿®æ”¹ - æ²¡æœ‰æ‰¾åˆ°æ¥æ”¶äººï¼Œæ˜¾ç¤ºé”™è¯¯æç¤º"),console.log("ğŸš¨ ERROR: æ²¡æœ‰æ‰¾åˆ°åˆé€‚çš„æ¥æ”¶äºº - è§’è‰²ä¿®æ”¹");const n=`æ— æ³•ä¿®æ”¹${e.name}è§’è‰²ï¼šè¿˜æœ‰${m.length}æ¡å¾…å®¡æ ¸çš„å·¥æ—¶è®°å½•éœ€è¦å¤„ç†ï¼Œä½†è¯¥ç”Ÿäº§çº¿æ²¡æœ‰å…¶ä»–æ¿€æ´»çš„${e.name}å¯ä»¥æ¥æ”¶è¿™äº›æ•°æ®ã€‚æ¶‰åŠå‘˜å·¥ï¼š${s}ã€‚è¯·å…ˆåœ¨è¯¥ç”Ÿäº§çº¿æ·»åŠ å…¶ä»–${e.name}æˆ–æ‰‹åŠ¨å¤„ç†è¿™äº›å¾…å®¡æ ¸æ•°æ®ã€‚`;return console.log("ğŸš¨ ERROR MESSAGE:",n),R.error(n),console.log("ğŸš¨ Toast.error å·²è°ƒç”¨"),void he(!1)}const t=[...new Set(m.map(e=>{var s;return null==(s=e.user)?void 0:s.name}))];return we({user:le,oldRole:e,newRole:s,pendingRecords:m,sameRoleUsers:n||[],userNames:t}),fe(!0),void he(!1)}}}if(("ç­é•¿"===(null==e?void 0:e.name)||"æ®µé•¿"===(null==e?void 0:e.name))&&n){console.log("æ£€æµ‹åˆ°ç­é•¿/æ®µé•¿ç”Ÿäº§çº¿å˜æ›´ï¼Œæ£€æŸ¥å¾…å®¡æ ¸æ•°æ®..."),console.log("ç”Ÿäº§çº¿å˜æ›´è¯¦æƒ…:",{oldProductionLine:le.production_line,newProductionLine:ue.production_line,role:e.name,userId:le.id});let s=M.from("timesheet_records").select("id, user_id, status");"ç­é•¿"===e.name?s=s.eq("supervisor_id",le.id).in("status",["pending","å¾…å®¡æ ¸","submitted","å·²æäº¤"]):"æ®µé•¿"===e.name&&(s=s.eq("section_chief_id",le.id).in("status",["approved"])),console.log("ç”Ÿäº§çº¿å˜æ›´ - å¾…å®¡æ ¸æ•°æ®æŸ¥è¯¢æ¡ä»¶:",{role:e.name,userId:le.id,statusFilter:"ç­é•¿"===e.name?["pending","å¾…å®¡æ ¸","submitted","å·²æäº¤"]:["approved"]});const{data:n,error:t}=yield s;if(console.log("ç”Ÿäº§çº¿å˜æ›´ - å¾…å®¡æ ¸æ•°æ®æŸ¥è¯¢ç»“æœ:",{pendingRecords:n,pendingError:t}),t)throw console.error("æ£€æŸ¥å¾…å®¡æ ¸æ•°æ®å¤±è´¥:",t),new Error("æ£€æŸ¥å¾…å®¡æ ¸æ•°æ®å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•");if(n&&n.length>0){console.log("ç”Ÿäº§çº¿å˜æ›´ - æ‰¾åˆ°å¾…å®¡æ ¸è®°å½•ï¼ŒæŸ¥è¯¢è¯¦ç»†ä¿¡æ¯...");const{data:s}=yield M.from("timesheet_records").select("\n                id, user_id, status, work_date,\n                user:users!user_id(id, name, is_active)\n              ").in("id",n.map(e=>e.id));console.log("ç”Ÿäº§çº¿å˜æ›´ - è¯¦ç»†è®°å½•æŸ¥è¯¢ç»“æœ:",s);const t=(null==s?void 0:s.filter(e=>{const s=e.user,n=null==s?void 0:s.is_active,t=e.work_date&&new Date(e.work_date)<=new Date;return console.log(`ç”Ÿäº§çº¿å˜æ›´ - è®°å½• ${e.id}: ç”¨æˆ·æ¿€æ´»=${n}, æœ‰æ•ˆæ—¥æœŸ=${t}`),n&&t}))||[];if(console.log("ç”Ÿäº§çº¿å˜æ›´ - æœ‰æ•ˆè®°å½•æ•°é‡:",t.length),t.length>0){console.log("ç”Ÿäº§çº¿å˜æ›´ - æŸ¥æ‰¾åŸç”Ÿäº§çº¿æ¥æ”¶äºº...");const{data:s,error:n}=yield M.from("users").select("id, name, phone").eq("company_id",le.company_id).eq("production_line",le.production_line).eq("role_id",le.role_id).eq("is_active",!0).neq("id",le.id);if(console.log("ç”Ÿäº§çº¿å˜æ›´ - æ¥æ”¶äººæŸ¥è¯¢ç»“æœ:",{sameRoleUsers:s,sameRoleError:n}),console.log("ç”Ÿäº§çº¿å˜æ›´ - æŸ¥è¯¢æ¡ä»¶:",{company_id:le.company_id,production_line:le.production_line,role_id:le.role_id,exclude_user_id:le.id}),!s||0===s.length){const s=[...new Set(t.map(e=>{var s;return null==(s=e.user)?void 0:s.name}))].join("ã€");console.log("ç”Ÿäº§çº¿å˜æ›´ - æ²¡æœ‰æ‰¾åˆ°æ¥æ”¶äººï¼Œæ˜¾ç¤ºé”™è¯¯æç¤º"),console.log("ğŸš¨ ERROR: æ²¡æœ‰æ‰¾åˆ°åˆé€‚çš„æ¥æ”¶äºº - ç”Ÿäº§çº¿å˜æ›´");const n=`æ— æ³•æ›´æ¢ç”Ÿäº§çº¿ï¼šè¿˜æœ‰${t.length}æ¡å¾…å®¡æ ¸çš„å·¥æ—¶è®°å½•éœ€è¦å¤„ç†ï¼Œä½†åŸç”Ÿäº§çº¿(${le.production_line})æ²¡æœ‰å…¶ä»–æ¿€æ´»çš„${e.name}å¯ä»¥æ¥æ”¶è¿™äº›æ•°æ®ã€‚æ¶‰åŠå‘˜å·¥ï¼š${s}ã€‚è¯·å…ˆåœ¨åŸç”Ÿäº§çº¿æ·»åŠ å…¶ä»–${e.name}æˆ–æ‰‹åŠ¨å¤„ç†è¿™äº›å¾…å®¡æ ¸æ•°æ®ã€‚`;return console.log("ğŸš¨ ERROR MESSAGE:",n),R.error(n),console.log("ğŸš¨ Toast.error å·²è°ƒç”¨"),void he(!1)}console.log("ç”Ÿäº§çº¿å˜æ›´ - æ‰¾åˆ°æ¥æ”¶äººï¼Œè®¾ç½®ç¡®è®¤å¯¹è¯æ¡†");const m=[...new Set(t.map(e=>{var s;return null==(s=e.user)?void 0:s.name}))];return Ue({user:le,oldProductionLine:le.production_line,newProductionLine:ue.production_line,role:e,pendingRecords:t,sameRoleUsers:s||[],userNames:m}),_e(!0),he(!1),void console.log("ç”Ÿäº§çº¿å˜æ›´ - ç¡®è®¤å¯¹è¯æ¡†å·²è®¾ç½®ï¼Œå‡½æ•°è¿”å›")}console.log("ç”Ÿäº§çº¿å˜æ›´ - æ²¡æœ‰æœ‰æ•ˆçš„å¾…å®¡æ ¸è®°å½•ï¼Œç»§ç»­æ›´æ–°ç”¨æˆ·")}else console.log("ç”Ÿäº§çº¿å˜æ›´ - æ²¡æœ‰æ‰¾åˆ°å¾…å®¡æ ¸è®°å½•ï¼Œç»§ç»­æ›´æ–°ç”¨æˆ·")}console.log("æ­£åœ¨æ›´æ–°ç”¨æˆ·:",le.id,"æ–°æ•°æ®:",ue);const{data:t,error:m}=yield M.from("users").update({phone:ue.phone,id_card:ue.id_card,name:ue.name,company_id:ue.company_id,role_id:ue.role_id,production_line:ue.production_line||null,is_active:ue.is_active,updated_at:(new Date).toISOString()}).eq("id",le.id).select("*");if(console.log("æ›´æ–°æ“ä½œè¯¦æƒ…:",{data:t,error:m,formData:ue,userId:le.id}),m)throw console.error("æ›´æ–°ç”¨æˆ·å¤±è´¥:",m),m;if(!t||0===t.length)throw console.error("æ›´æ–°æ“ä½œæ²¡æœ‰è¿”å›æ•°æ®ï¼Œè¿™é€šå¸¸è¡¨ç¤ºæƒé™é—®é¢˜æˆ–è®°å½•ä¸å­˜åœ¨"),new Error("æ›´æ–°å¤±è´¥ï¼šæ— æ³•è·å–æ›´æ–°åçš„æ•°æ®ï¼Œè¯·æ£€æŸ¥æƒé™è®¾ç½®");console.log("æ›´æ–°æˆåŠŸï¼Œè¿”å›æ•°æ®:",t)}else{const{data:e}=yield M.from("users").select("id").or(`phone.eq.${ue.phone},id_card.eq.${ue.id_card}`).single();if(e)throw new Error("æ‰‹æœºå·æˆ–èº«ä»½è¯å·å·²å­˜åœ¨");const s="123456",{data:n,error:t}=yield M.from("users").insert([{phone:ue.phone,password_hash:s,id_card:ue.id_card,name:ue.name,company_id:ue.company_id,role_id:ue.role_id,production_line:ue.production_line||null,is_active:ue.is_active}]).select("*");if(t)throw console.error("åˆ›å»ºç”¨æˆ·å¤±è´¥:",t),t;if(!n||0===n.length)throw console.error("åˆ›å»ºæ“ä½œæ²¡æœ‰è¿”å›æ•°æ®ï¼Œè¿™é€šå¸¸è¡¨ç¤ºæƒé™é—®é¢˜"),new Error("åˆ›å»ºå¤±è´¥ï¼šæ— æ³•è·å–åˆ›å»ºåçš„æ•°æ®ï¼Œè¯·æ£€æŸ¥æƒé™è®¾ç½®");console.log("åˆ›å»ºæˆåŠŸï¼Œè¿”å›æ•°æ®:",n)}const e=le?"ç”¨æˆ·ä¿¡æ¯æ›´æ–°æˆåŠŸï¼":"ç”¨æˆ·åˆ›å»ºæˆåŠŸï¼";console.log(e),console.log("é‡æ–°è·å–ç”¨æˆ·åˆ—è¡¨..."),yield Pe(),Ge(),console.log("æ“ä½œå®Œæˆï¼Œè¡¨å•å·²é‡ç½®")}catch(t){console.error("ä¿å­˜ç”¨æˆ·ä¿¡æ¯å¤±è´¥:",t),qe(t.message||"ä¿å­˜å¤±è´¥")}finally{he(!1)}}),className:"space-y-4",children:[d.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxDEV("div",{children:[d.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-1",children:"å§“å *"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1370,columnNumber:21},this),d.jsxDEV("div",{className:"relative",children:[d.jsxDEV(g,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1374,columnNumber:23},this),d.jsxDEV("input",{type:"text",name:"name",value:ue.name,onChange:Ae,required:!0,className:"w-full pl-10 pr-4 py-2 bg-black border border-green-400 rounded text-green-300 placeholder-green-600 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono text-sm",placeholder:"è¯·è¾“å…¥å§“å"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1375,columnNumber:23},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1373,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1369,columnNumber:19},this),d.jsxDEV("div",{children:[d.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-1",children:"æ‰‹æœºå· *"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1388,columnNumber:21},this),d.jsxDEV("div",{className:"relative",children:[d.jsxDEV(y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1392,columnNumber:23},this),d.jsxDEV("input",{type:"tel",name:"phone",value:ue.phone,onChange:Ae,required:!0,className:"w-full pl-10 pr-4 py-2 bg-black border border-green-400 rounded text-green-300 placeholder-green-600 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono text-sm",placeholder:"è¯·è¾“å…¥æ‰‹æœºå·",maxLength:11},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1393,columnNumber:23},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1391,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1387,columnNumber:19},this),d.jsxDEV("div",{children:[d.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-1",children:"èº«ä»½è¯å· *"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1407,columnNumber:21},this),d.jsxDEV("div",{className:"relative",children:[d.jsxDEV(f,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1411,columnNumber:23},this),d.jsxDEV("input",{type:"text",name:"id_card",value:ue.id_card,onChange:Ae,required:!0,className:"w-full pl-10 pr-4 py-2 bg-black border border-green-400 rounded text-green-300 placeholder-green-600 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono text-sm",placeholder:"è¯·è¾“å…¥èº«ä»½è¯å·",maxLength:18},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1412,columnNumber:23},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1410,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1406,columnNumber:19},this),d.jsxDEV("div",{children:[d.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-1",children:"æ‰€å±å…¬å¸ *"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1428,columnNumber:21},this),d.jsxDEV("div",{className:"relative",children:[d.jsxDEV(v,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1432,columnNumber:23},this),V($e.role)&&!le?d.jsxDEV("select",{name:"company_id",value:ue.company_id,onChange:Ae,required:!0,className:"w-full pl-10 pr-4 py-2 bg-black border border-green-400 rounded text-green-300 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono text-sm",children:[d.jsxDEV("option",{value:"",children:"è¯·é€‰æ‹©å…¬å¸"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1441,columnNumber:27},this),Q.map(e=>d.jsxDEV("option",{value:e.id,children:e.name},e.id,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1443,columnNumber:29},this))]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1434,columnNumber:25},this):d.jsxDEV("div",{className:"w-full pl-10 pr-4 py-2 bg-gray-800 border border-green-400 rounded text-green-300 font-mono text-sm",children:[(null==(e=Q.find(e=>e.id===ue.company_id))?void 0:e.name)||(null==(s=$e.company)?void 0:s.name)||"å½“å‰å…¬å¸",le&&d.jsxDEV("span",{className:"ml-2 text-yellow-400 text-xs",children:"(ç¼–è¾‘æ—¶ä¸å¯ä¿®æ”¹)"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1452,columnNumber:29},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1449,columnNumber:25},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1431,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1427,columnNumber:19},this),d.jsxDEV("div",{children:[d.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-1",children:"ç”¨æˆ·è§’è‰² *"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1460,columnNumber:21},this),d.jsxDEV("div",{className:"relative",children:[d.jsxDEV(w,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1464,columnNumber:23},this),d.jsxDEV("select",{name:"role_id",value:ue.role_id,onChange:Ae,required:!0,className:"w-full pl-10 pr-4 py-2 bg-black border border-green-400 rounded text-green-300 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono text-sm",children:[d.jsxDEV("option",{value:"",children:"è¯·é€‰æ‹©è§’è‰²"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1472,columnNumber:25},this),X.map(e=>d.jsxDEV("option",{value:e.id,children:e.name},e.id,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1474,columnNumber:27},this))]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1465,columnNumber:23},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1463,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1459,columnNumber:19},this),se&&d.jsxDEV("div",{children:[d.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-1",children:"ç”Ÿäº§çº¿ *"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1485,columnNumber:23},this),d.jsxDEV("select",{name:"production_line",value:ue.production_line||"",onChange:Ae,className:"w-full px-3 py-2 bg-black border border-green-400 rounded text-green-300 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono text-sm",required:!0,children:[d.jsxDEV("option",{value:"",children:"è¯·é€‰æ‹©ç”Ÿäº§çº¿"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1495,columnNumber:25},this),Z.map(e=>d.jsxDEV("option",{value:e,children:e},e,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1497,columnNumber:27},this))]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1488,columnNumber:23},this),0===Z.length&&ue.company_id&&d.jsxDEV("div",{className:"mt-1 text-yellow-400 text-xs font-mono",children:"è¯¥å…¬å¸æš‚æ— å¯ç”¨ç”Ÿäº§çº¿"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1503,columnNumber:25},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1484,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1368,columnNumber:17},this),d.jsxDEV("div",{children:[d.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-1",children:"ç”¨æˆ·çŠ¶æ€"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1512,columnNumber:19},this),d.jsxDEV("div",{className:"relative",children:[d.jsxDEV(k,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1516,columnNumber:21},this),d.jsxDEV("select",{name:"is_active",value:ue.is_active.toString(),onChange:e=>de(i(o({},ue),{is_active:"true"===e.target.value})),className:"w-full pl-10 pr-4 py-2 bg-black border border-green-400 rounded text-green-300 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono text-sm",children:[d.jsxDEV("option",{value:"true",children:"æ¿€æ´»"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1523,columnNumber:23},this),d.jsxDEV("option",{value:"false",children:"ç¦ç”¨"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1524,columnNumber:23},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1517,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1515,columnNumber:19},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1511,columnNumber:17},this),d.jsxDEV("div",{className:"flex gap-3 pt-4",children:[d.jsxDEV("button",{type:"submit",disabled:ge,className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-500 disabled:bg-green-800 text-black font-bold rounded transition-colors font-mono",children:[d.jsxDEV(E,{className:"w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1535,columnNumber:21},this),ge?"ä¿å­˜ä¸­...":"ä¿å­˜"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1530,columnNumber:19},this),d.jsxDEV("button",{type:"button",onClick:Ge,className:"px-4 py-2 bg-gray-600 hover:bg-gray-500 text-white font-bold rounded transition-colors font-mono",children:"å–æ¶ˆ"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1538,columnNumber:19},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1529,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1367,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1354,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1353,columnNumber:11},this),Je.length>0?d.jsxDEV("div",{className:"space-y-6",children:Je.map(e=>{const s=Fe[e];return d.jsxDEV("div",{className:"bg-gray-900 border border-green-400 rounded-lg overflow-hidden",children:[d.jsxDEV("div",{className:"bg-green-900/50 px-4 py-3 border-b border-green-400",children:d.jsxDEV("div",{className:"flex items-center justify-between",children:[d.jsxDEV("h3",{className:"text-lg font-mono font-bold text-green-300 flex items-center gap-2",children:[d.jsxDEV(v,{className:"w-5 h-5"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1562,columnNumber:25},this),e]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1561,columnNumber:23},this),d.jsxDEV("span",{className:"text-sm font-mono text-green-400 bg-green-900/30 px-2 py-1 rounded",children:[s.length," åç”¨æˆ·"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1565,columnNumber:23},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1560,columnNumber:21},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1559,columnNumber:19},this),d.jsxDEV("div",{className:"overflow-x-auto",children:d.jsxDEV("table",{className:"w-full",children:[d.jsxDEV("thead",{className:"bg-green-900/30",children:d.jsxDEV("tr",{children:[d.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"åºå·"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1576,columnNumber:27},this),d.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"å§“å"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1577,columnNumber:27},this),d.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"æ‰‹æœºå·"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1578,columnNumber:27},this),d.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"èº«ä»½è¯å·"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1579,columnNumber:27},this),d.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"è§’è‰²"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1580,columnNumber:27},this),d.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"ç”Ÿäº§çº¿"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1581,columnNumber:27},this),d.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"çŠ¶æ€"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1582,columnNumber:27},this),d.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"æ“ä½œ"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1583,columnNumber:27},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1575,columnNumber:25},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1574,columnNumber:23},this),d.jsxDEV("tbody",{className:"divide-y divide-green-800",children:s.map((e,s)=>{var n;return d.jsxDEV("tr",{className:"hover:bg-green-900/10",children:[d.jsxDEV("td",{className:"px-4 py-3 whitespace-nowrap",children:d.jsxDEV("span",{className:"text-sm font-mono font-medium text-green-300",children:s+1},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1590,columnNumber:31},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1589,columnNumber:29},this),d.jsxDEV("td",{className:"px-4 py-3 whitespace-nowrap",children:d.jsxDEV("div",{className:"flex items-center",children:[d.jsxDEV(g,{className:"w-4 h-4 text-green-400 mr-2"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1596,columnNumber:33},this),d.jsxDEV("span",{className:"text-sm font-mono font-medium text-green-300",children:e.name},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1597,columnNumber:33},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1595,columnNumber:31},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1594,columnNumber:29},this),d.jsxDEV("td",{className:"px-4 py-3 whitespace-nowrap",children:d.jsxDEV("span",{className:"text-sm font-mono text-green-300",children:e.phone},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1603,columnNumber:31},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1602,columnNumber:29},this),d.jsxDEV("td",{className:"px-4 py-3 whitespace-nowrap",children:d.jsxDEV("span",{className:"text-sm font-mono text-green-300",children:e.id_card},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1608,columnNumber:31},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1607,columnNumber:29},this),d.jsxDEV("td",{className:"px-4 py-3 whitespace-nowrap",children:d.jsxDEV("span",{className:"text-sm font-mono text-green-300",children:(null==(n=e.role)?void 0:n.name)||"æœªåˆ†é…"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1613,columnNumber:31},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1612,columnNumber:29},this),d.jsxDEV("td",{className:"px-4 py-3 whitespace-nowrap",children:d.jsxDEV("span",{className:"text-sm font-mono text-green-300",children:e.production_line||"-"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1618,columnNumber:31},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1617,columnNumber:29},this),d.jsxDEV("td",{className:"px-4 py-3 whitespace-nowrap",children:d.jsxDEV("button",{onClick:()=>Te(e),className:"inline-flex px-2 py-1 text-xs font-mono font-semibold rounded-full "+(e.is_active?"bg-green-900/50 text-green-300 border border-green-400":"bg-red-900/50 text-red-300 border border-red-400"),children:e.is_active?"æ¿€æ´»":"ç¦ç”¨"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1623,columnNumber:31},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1622,columnNumber:29},this),d.jsxDEV("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium",children:d.jsxDEV("div",{className:"flex gap-2",children:[d.jsxDEV("button",{onClick:()=>(e=>{var s;if(!V($e.role)&&e.company_id!==(null==(s=$e.company)?void 0:s.id))return void R.error("æ‚¨åªèƒ½ç¼–è¾‘è‡ªå·±å…¬å¸çš„ç”¨æˆ·");ce(e),de({phone:e.phone,id_card:e.id_card,name:e.name,company_id:e.company_id,role_id:e.role_id,production_line:e.production_line||"",is_active:e.is_active});const n=X.find(s=>s.id===e.role_id),t="ç­é•¿"===(null==n?void 0:n.name)||"æ®µé•¿"===(null==n?void 0:n.name);ne(t),t&&e.company_id&&ze(e.company_id),ie(!0)})(e),className:"text-green-400 hover:text-green-300 transition-colors",title:"ç¼–è¾‘",children:d.jsxDEV(j,{className:"w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1641,columnNumber:35},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1636,columnNumber:33},this),d.jsxDEV("button",{onClick:()=>Oe(e),className:"text-red-400 hover:text-red-300 transition-colors",title:"åˆ é™¤",children:d.jsxDEV(_,{className:"w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1648,columnNumber:35},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1643,columnNumber:33},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1635,columnNumber:31},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1634,columnNumber:29},this)]},e.id,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1588,columnNumber:27},this)})},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1586,columnNumber:23},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1573,columnNumber:21},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1572,columnNumber:19},this)]},e,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1557,columnNumber:17},this)})},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1553,columnNumber:11},this):d.jsxDEV("div",{className:"bg-gray-900 border border-green-400 rounded-lg overflow-hidden",children:d.jsxDEV("div",{className:"overflow-x-auto",children:d.jsxDEV("table",{className:"w-full",children:[d.jsxDEV("thead",{className:"bg-green-900/30",children:d.jsxDEV("tr",{children:[d.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"åºå·"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1667,columnNumber:21},this),d.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"å§“å"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1668,columnNumber:21},this),d.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"æ‰‹æœºå·"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1669,columnNumber:21},this),d.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"èº«ä»½è¯å·"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1670,columnNumber:21},this),d.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"å…¬å¸"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1671,columnNumber:21},this),d.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"è§’è‰²"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1672,columnNumber:21},this),d.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"ç”Ÿäº§çº¿"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1673,columnNumber:21},this),d.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"çŠ¶æ€"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1674,columnNumber:21},this),d.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"æ“ä½œ"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1675,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1666,columnNumber:19},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1665,columnNumber:17},this),d.jsxDEV("tbody",{className:"divide-y divide-green-800"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1678,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1664,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1663,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1662,columnNumber:11},this),0===Be.length&&d.jsxDEV("div",{className:"text-center py-12",children:[d.jsxDEV(g,{className:"w-16 h-16 text-green-600 mx-auto mb-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1688,columnNumber:13},this),d.jsxDEV("p",{className:"text-green-400 text-lg font-mono",children:re?"æœªæ‰¾åˆ°åŒ¹é…çš„ç”¨æˆ·":"æš‚æ— ç”¨æˆ·æ•°æ®"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1689,columnNumber:13},this),d.jsxDEV("p",{className:"text-green-600 text-sm font-mono mt-2",children:re?"è¯·å°è¯•å…¶ä»–æœç´¢å…³é”®è¯":"ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æ·»åŠ ç¬¬ä¸€ä¸ªç”¨æˆ·"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1692,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1687,columnNumber:11},this),ye&&ve&&d.jsxDEV("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",children:d.jsxDEV("div",{className:"bg-gray-900 border border-yellow-400 rounded-lg p-6 w-full max-w-md",children:[d.jsxDEV("div",{className:"flex items-center gap-3 mb-4",children:[d.jsxDEV(D,{className:"text-yellow-400 w-8 h-8"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1703,columnNumber:17},this),d.jsxDEV("h2",{className:"text-xl font-bold text-yellow-400 font-mono",children:"ç¡®è®¤è§’è‰²ä¿®æ”¹"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1704,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1702,columnNumber:15},this),d.jsxDEV("div",{className:"mb-6",children:[d.jsxDEV("p",{className:"text-green-300 font-mono mb-2",children:["ç¡®å®šè¦å°†ç”¨æˆ· ",d.jsxDEV("span",{className:"text-green-400 font-bold",children:['"',ve.user.name,'"']},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1711,columnNumber:26},this)," çš„è§’è‰²ä»",d.jsxDEV("span",{className:"text-blue-400 font-bold",children:['"',ve.oldRole.name,'"']},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1712,columnNumber:19},this)," ä¿®æ”¹ä¸º",d.jsxDEV("span",{className:"text-purple-400 font-bold",children:['"',ve.newRole.name,'"']},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1713,columnNumber:19},this)," å—ï¼Ÿ"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1710,columnNumber:17},this),ve.pendingRecords&&ve.pendingRecords.length>0?d.jsxDEV("div",{className:"space-y-3",children:[d.jsxDEV("div",{className:"text-yellow-300 font-mono text-sm p-3 bg-yellow-900/20 border border-yellow-600 rounded",children:[d.jsxDEV("p",{className:"mb-1",children:"âš ï¸ æ•°æ®è½¬ç§»ï¼š"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1719,columnNumber:23},this),d.jsxDEV("p",{className:"text-xs mb-2",children:["æ£€æµ‹åˆ°",ve.pendingRecords.length,"æ¡å¾…å®¡æ ¸å·¥æ—¶è®°å½•éœ€è¦è½¬ç§»ã€‚"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1720,columnNumber:23},this),d.jsxDEV("p",{className:"text-yellow-200 text-xs",children:["æ¶‰åŠå‘˜å·¥ï¼š",null==(n=ve.userNames)?void 0:n.join("ã€")]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1721,columnNumber:23},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1718,columnNumber:21},this),d.jsxDEV("div",{children:[d.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-2",children:"é€‰æ‹©æ•°æ®æ¥æ”¶äººï¼š"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1726,columnNumber:23},this),d.jsxDEV("select",{value:ke,onChange:e=>Ee(e.target.value),className:"w-full px-3 py-2 bg-black border border-green-400 rounded text-green-300 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono text-sm",required:!0,children:[d.jsxDEV("option",{value:"",children:"è¯·é€‰æ‹©æ¥æ”¶äºº"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1735,columnNumber:25},this),null==(t=ve.sameRoleUsers)?void 0:t.map(e=>d.jsxDEV("option",{value:e.id,children:e.name},e.id,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1737,columnNumber:27},this))]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1729,columnNumber:23},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1725,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1717,columnNumber:19},this):d.jsxDEV("div",{className:"text-green-300 font-mono text-sm mb-2 p-3 bg-green-900/20 border border-green-600 rounded",children:[d.jsxDEV("p",{className:"mb-1",children:"âœ… å®‰å…¨ä¿®æ”¹ï¼š"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1746,columnNumber:21},this),d.jsxDEV("p",{className:"text-xs",children:["è¯¥",ve.oldRole.name,"æ²¡æœ‰å¾…å®¡æ ¸çš„å·¥æ—¶è®°å½•ï¼Œå¯ä»¥å®‰å…¨ä¿®æ”¹è§’è‰²ã€‚"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1747,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1745,columnNumber:19},this),d.jsxDEV("p",{className:"text-yellow-300 font-mono text-sm mt-2",children:"è§’è‰²ä¿®æ”¹åå°†å½±å“ç”¨æˆ·çš„æƒé™å’ŒåŠŸèƒ½è®¿é—®ã€‚"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1751,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1709,columnNumber:15},this),d.jsxDEV("div",{className:"flex gap-3",children:[d.jsxDEV("button",{onClick:()=>l(this,null,function*(){var e,s;if(ve.user&&ke)try{console.log("æ‰§è¡Œè§’è‰²ä¿®æ”¹æ•°æ®è½¬ç§»...");const n="ç­é•¿"===(null==(e=ve.oldRole)?void 0:e.name)?"supervisor_id":"section_chief_id",{error:t}=yield M.from("timesheet_records").update({[n]:ke}).in("id",ve.pendingRecords.map(e=>e.id));if(t)throw console.error("æ•°æ®è½¬ç§»å¤±è´¥:",t),new Error("æ•°æ®è½¬ç§»å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•");const{error:m}=yield M.from("users").update({phone:ue.phone,id_card:ue.id_card,name:ue.name,company_id:ue.company_id,role_id:ue.role_id,production_line:ue.production_line||null,is_active:ue.is_active,updated_at:(new Date).toISOString()}).eq("id",ve.user.id);if(m)throw console.error("è§’è‰²ä¿®æ”¹å¤±è´¥:",m),m;const r=null==(s=ve.sameRoleUsers.find(e=>e.id===ke))?void 0:s.name;R.success(`è§’è‰²ä¿®æ”¹æˆåŠŸï¼å·²å°†${ve.pendingRecords.length}æ¡å¾…å®¡æ ¸æ•°æ®è½¬ç§»ç»™${r}`),fe(!1),we({user:null,oldRole:null,newRole:null,pendingRecords:[],sameRoleUsers:[],userNames:[]}),Ee(""),Ge(),yield Pe()}catch(n){console.error("è§’è‰²ä¿®æ”¹å¤±è´¥:",n),R.error(n.message||"è§’è‰²ä¿®æ”¹å¤±è´¥")}else R.error("è¯·é€‰æ‹©æ•°æ®æ¥æ”¶äºº")}),disabled:(null==(m=ve.pendingRecords)?void 0:m.length)>0&&!ke,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-yellow-600 hover:bg-yellow-500 disabled:bg-yellow-800 disabled:cursor-not-allowed text-white font-bold rounded transition-colors font-mono",children:[d.jsxDEV(j,{className:"w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1762,columnNumber:19},this),"ç¡®è®¤ä¿®æ”¹"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1757,columnNumber:17},this),d.jsxDEV("button",{onClick:()=>{fe(!1),we({user:null,oldRole:null,newRole:null,pendingRecords:[],sameRoleUsers:[],userNames:[]}),Ee(""),he(!1)},className:"flex-1 px-4 py-2 bg-gray-600 hover:bg-gray-500 text-white font-bold rounded transition-colors font-mono",children:"å–æ¶ˆ"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1765,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1756,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1701,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1700,columnNumber:11},this),Ne&&pe&&d.jsxDEV("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",children:d.jsxDEV("div",{className:"bg-gray-900 border border-red-400 rounded-lg p-6 w-full max-w-md",children:[d.jsxDEV("div",{className:"flex items-center gap-3 mb-4",children:[d.jsxDEV(D,{className:"text-red-400 w-8 h-8"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1781,columnNumber:17},this),d.jsxDEV("h2",{className:"text-xl font-bold text-red-400 font-mono",children:"ç¡®è®¤åˆ é™¤"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1782,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1780,columnNumber:15},this),d.jsxDEV("div",{className:"mb-6",children:[d.jsxDEV("p",{className:"text-green-300 font-mono mb-2",children:["ç¡®å®šè¦åˆ é™¤ç”¨æˆ· ",d.jsxDEV("span",{className:"text-green-400 font-bold",children:['"',pe.name,'"']},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1789,columnNumber:27},this)," å—ï¼Ÿ"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1788,columnNumber:17},this),"å‘˜å·¥"===(null==(r=pe.role)?void 0:r.name)?d.jsxDEV("div",{className:"text-blue-300 font-mono text-sm mb-2 p-3 bg-blue-900/20 border border-blue-600 rounded",children:[d.jsxDEV("p",{className:"mb-1",children:"â„¹ï¸ å‘˜å·¥å¤„ç†å½±å“ï¼š"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1795,columnNumber:21},this),d.jsxDEV("ul",{className:"list-disc list-inside space-y-1 text-xs",children:[d.jsxDEV("li",{children:"ä¿ç•™å†å²å·¥æ—¶è®°å½•å’Œå®¡æ‰¹å†å²è®°å½•"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1797,columnNumber:23},this),d.jsxDEV("li",{children:"æ–­å¼€æ•°æ®å…³è”ï¼Œè´¦æˆ·è®¾ä¸ºéæ¿€æ´»çŠ¶æ€"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1798,columnNumber:23},this),d.jsxDEV("li",{children:"é‡æ–°ç”³è¯·æ—¶ä¸å…³è”æ—§æ•°æ®"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1799,columnNumber:23},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1796,columnNumber:21},this),d.jsxDEV("p",{className:"text-blue-200 text-xs mt-2",children:"å‘˜å·¥å¤„ç†å¯¹ç³»ç»Ÿæ•°æ®å½±å“è¾ƒå°ï¼Œæ•°æ®å®Œæ•´æ€§å¾—åˆ°ä¿æŠ¤"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1801,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1794,columnNumber:19},this):"ç­é•¿"===(null==(a=pe.role)?void 0:a.name)||"æ®µé•¿"===(null==(q=pe.role)?void 0:q.name)?pe.pendingRecords&&pe.pendingRecords.length>0?d.jsxDEV("div",{className:"space-y-3",children:[d.jsxDEV("div",{className:"text-yellow-300 font-mono text-sm p-3 bg-yellow-900/20 border border-yellow-600 rounded",children:[d.jsxDEV("p",{className:"mb-1",children:"âš ï¸ æ•°æ®è½¬ç§»ï¼š"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1807,columnNumber:25},this),d.jsxDEV("p",{className:"text-xs mb-2",children:["æ£€æµ‹åˆ°",pe.pendingRecords.length,"æ¡å¾…å®¡æ ¸å·¥æ—¶è®°å½•éœ€è¦è½¬ç§»ã€‚"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1808,columnNumber:25},this),d.jsxDEV("p",{className:"text-yellow-200 text-xs",children:["æ¶‰åŠå‘˜å·¥ï¼š",null==($=pe.userNames)?void 0:$.join("ã€")]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1809,columnNumber:25},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1806,columnNumber:23},this),d.jsxDEV("div",{children:[d.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-2",children:"é€‰æ‹©æ•°æ®æ¥æ”¶äººï¼š"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1814,columnNumber:25},this),d.jsxDEV("select",{value:Le,onChange:e=>Ie(e.target.value),className:"w-full px-3 py-2 bg-black border border-green-400 rounded text-green-300 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono text-sm",required:!0,children:[d.jsxDEV("option",{value:"",children:"è¯·é€‰æ‹©æ¥æ”¶äºº"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1823,columnNumber:27},this),null==(S=pe.sameRoleUsers)?void 0:S.map(e=>d.jsxDEV("option",{value:e.id,children:e.name},e.id,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1825,columnNumber:29},this))]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1817,columnNumber:25},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1813,columnNumber:23},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1805,columnNumber:21},this):d.jsxDEV("div",{className:"text-green-300 font-mono text-sm mb-2 p-3 bg-green-900/20 border border-green-600 rounded",children:[d.jsxDEV("p",{className:"mb-1",children:"âœ… å®‰å…¨åˆ é™¤ï¼š"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1834,columnNumber:23},this),d.jsxDEV("p",{className:"text-xs",children:["è¯¥",null==(C=pe.role)?void 0:C.name,"æ²¡æœ‰å¾…å®¡æ ¸çš„å·¥æ—¶è®°å½•ï¼Œå¯ä»¥å®‰å…¨åˆ é™¤ã€‚"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1835,columnNumber:23},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1833,columnNumber:21},this):"ç”Ÿäº§ç»ç†"===(null==(P=pe.role)?void 0:P.name)||"è´¢åŠ¡"===(null==(O=pe.role)?void 0:O.name)?d.jsxDEV("div",{className:"text-purple-300 font-mono text-sm mb-2 p-3 bg-purple-900/20 border border-purple-600 rounded",children:[d.jsxDEV("p",{className:"mb-1",children:["â„¹ï¸ ",null==(L=pe.role)?void 0:L.name,"åˆ é™¤å½±å“ï¼š"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1840,columnNumber:21},this),d.jsxDEV("ul",{className:"list-disc list-inside space-y-1 text-xs",children:[d.jsxDEV("li",{children:"ç›´æ¥åˆ é™¤ç”¨æˆ·è´¦æˆ·ï¼Œä¸å½±å“å·¥æ—¶æ•°æ®"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1842,columnNumber:23},this),d.jsxDEV("li",{children:"æ¸…ç†ç›¸å…³çš„å®¡æ‰¹å†å²è®°å½•å¼•ç”¨"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1843,columnNumber:23},this),d.jsxDEV("li",{children:"ä¸éœ€è¦æ•°æ®è½¬ç§»æˆ–ç‰¹æ®Šå¤„ç†"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1844,columnNumber:23},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1841,columnNumber:21},this),d.jsxDEV("p",{className:"text-purple-200 text-xs mt-2",children:[null==(I=pe.role)?void 0:I.name,"åˆ é™¤å¯¹å·¥æ—¶ç®¡ç†ç³»ç»Ÿå½±å“è¾ƒå°"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1846,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1839,columnNumber:19},this):d.jsxDEV("div",{className:"text-yellow-300 font-mono text-sm mb-2 p-3 bg-yellow-900/20 border border-yellow-600 rounded",children:[d.jsxDEV("p",{className:"mb-1",children:"âš ï¸ åˆ é™¤æ“ä½œå°†ä¼šï¼š"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1850,columnNumber:21},this),d.jsxDEV("ul",{className:"list-disc list-inside space-y-1 text-xs",children:[d.jsxDEV("li",{children:"æ¸…ç†è¯¥ç”¨æˆ·åœ¨å·¥æ—¶è®°å½•ä¸­çš„ç›¸å…³å¼•ç”¨"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1852,columnNumber:23},this),d.jsxDEV("li",{children:"åˆ é™¤è¯¥ç”¨æˆ·çš„å®¡æ‰¹å†å²è®°å½•"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1853,columnNumber:23},this),d.jsxDEV("li",{children:"æ°¸ä¹…åˆ é™¤ç”¨æˆ·è´¦æˆ·ä¿¡æ¯"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1854,columnNumber:23},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1851,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1849,columnNumber:19},this),d.jsxDEV("p",{className:"text-red-300 font-mono text-sm mt-2",children:"æ­¤æ“ä½œä¸å¯æ¢å¤ï¼Œè¯·è°¨æ…æ“ä½œã€‚"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1859,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1787,columnNumber:15},this),d.jsxDEV("div",{className:"flex gap-3",children:[d.jsxDEV("button",{onClick:()=>l(this,null,function*(){var e,s,n,t;if(pe)try{console.log("æ­£åœ¨åˆ é™¤ç”¨æˆ·:",pe.id,pe.name);const m=pe.role;if(pe.pendingRecords&&pe.pendingRecords.length>0){if(!Le)return void R.error("è¯·é€‰æ‹©æ•°æ®æ¥æ”¶äºº");console.log("æ‰§è¡Œæ•°æ®è½¬ç§»...");const n="ç­é•¿"===(null==m?void 0:m.name)?"supervisor_id":"section_chief_id",t="ç­é•¿"===(null==m?void 0:m.name)?["pending","å¾…å®¡æ ¸","submitted","å·²æäº¤"]:["approved"],{error:r}=yield M.from("timesheet_records").update({[n]:Le}).eq(n,pe.id).in("status",t);if(r)return console.error("æ•°æ®è½¬ç§»å¤±è´¥:",r),void R.error("æ•°æ®è½¬ç§»å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•");const a=null==(s=null==(e=pe.sameRoleUsers)?void 0:e.find(e=>e.id===Le))?void 0:s.name;console.log(`æ•°æ®è½¬ç§»æˆåŠŸï¼š${pe.pendingRecords.length}æ¡è®°å½•è½¬ç§»ç»™${a}`)}if(console.log("å¼€å§‹äº‹åŠ¡æ€§åˆ é™¤æ“ä½œ..."),"å‘˜å·¥"===(null==m?void 0:m.name)){console.log("å‘˜å·¥è§’è‰²åˆ é™¤ï¼šä¿ç•™å†å²æ•°æ®ä½†æ–­å¼€å…³è”ï¼Œå½»åº•åˆ é™¤ç”¨æˆ·è´¦æˆ·"),console.log("æ–­å¼€å·¥æ—¶è®°å½•ä¸­çš„ç”¨æˆ·å…³è”...");const{error:e}=yield M.from("timesheet_records").update({user_id:null}).eq("user_id",pe.id);if(e)throw console.error("æ–­å¼€å·¥æ—¶è®°å½•ç”¨æˆ·å…³è”å¤±è´¥:",e),new Error("æ–­å¼€å·¥æ—¶è®°å½•å…³è”å¤±è´¥ï¼š"+e.message);console.log("æ–­å¼€å®¡æ‰¹å†å²ä¸­çš„å®¡æ ¸äººå…³è”...");const{error:s}=yield M.from("approval_history").update({approver_id:null}).eq("approver_id",pe.id);if(s)throw console.error("æ–­å¼€å®¡æ‰¹å†å²å®¡æ ¸äººå…³è”å¤±è´¥:",s),new Error("æ–­å¼€å®¡æ‰¹å†å²å…³è”å¤±è´¥ï¼š"+s.message);console.log("å‘˜å·¥æ•°æ®å…³è”æ–­å¼€å®Œæˆï¼Œå‡†å¤‡åˆ é™¤ç”¨æˆ·è´¦æˆ·")}else{console.log("éå‘˜å·¥è§’è‰²åˆ é™¤ï¼šæ¸…ç†å¤–é”®å¼•ç”¨"),console.log("æ¸…ç†å·¥æ—¶è®°å½•ä¸­çš„å¤–é”®å¼•ç”¨...");const{error:e}=yield M.from("timesheet_records").update({supervisor_id:null}).eq("supervisor_id",pe.id);if(e)throw console.error("æ¸…ç†supervisor_idå¼•ç”¨å¤±è´¥:",e),new Error("æ¸…ç†å·¥æ—¶è®°å½•å¼•ç”¨å¤±è´¥ï¼š"+e.message);const{error:s}=yield M.from("timesheet_records").update({section_chief_id:null}).eq("section_chief_id",pe.id);if(s)throw console.error("æ¸…ç†section_chief_idå¼•ç”¨å¤±è´¥:",s),new Error("æ¸…ç†å·¥æ—¶è®°å½•å¼•ç”¨å¤±è´¥ï¼š"+s.message);const{error:n}=yield M.from("approval_history").update({approver_id:null}).eq("approver_id",pe.id);if(n)throw console.error("æ¸…ç†å®¡æ ¸å†å²å¼•ç”¨å¤±è´¥:",n),new Error("æ¸…ç†å®¡æ ¸å†å²å¼•ç”¨å¤±è´¥ï¼š"+n.message);console.log("å¤–é”®å¼•ç”¨æ¸…ç†å®Œæˆ")}console.log("æ›´æ–°å†å²è®°å½•ä¸­çš„å§“åå­—æ®µ...");const{error:r}=yield M.rpc("update_user_names_before_delete",{user_id_to_delete:pe.id});if(r)throw console.error("æ›´æ–°å§“åå­—æ®µå¤±è´¥:",r),new Error("æ›´æ–°å†å²è®°å½•å§“åå­—æ®µå¤±è´¥ï¼š"+r.message);console.log("å†å²è®°å½•å§“åå­—æ®µæ›´æ–°å®Œæˆ"),console.log("æ‰§è¡Œç¡¬åˆ é™¤ç”¨æˆ·...");const{data:a,error:o}=yield M.from("users").delete().eq("id",pe.id).select("*");if(console.log("ç¡¬åˆ é™¤æ“ä½œè¯¦æƒ…:",{data:a,error:o,userId:pe.id}),o)throw console.error("ç¡¬åˆ é™¤ç”¨æˆ·å¤±è´¥:",o),o;if(console.log("ç¡¬åˆ é™¤æˆåŠŸ:",pe.name),pe.pendingRecords&&pe.pendingRecords.length>0){const e=null==(t=null==(n=pe.sameRoleUsers)?void 0:n.find(e=>e.id===Le))?void 0:t.name;R.success(`ç”¨æˆ·åˆ é™¤æˆåŠŸï¼Œå·²å°†${pe.pendingRecords.length}æ¡å¾…å®¡æ ¸å·¥æ—¶è®°å½•è½¬ç§»ç»™${e}ï¼Œå†å²è®°å½•å·²ä¿ç•™å§“åä¿¡æ¯`)}else R.success(`${(null==m?void 0:m.name)||"ç”¨æˆ·"} ${pe.name} åˆ é™¤æˆåŠŸï¼šç”¨æˆ·è´¦æˆ·å·²æ°¸ä¹…åˆ é™¤ï¼Œå†å²è®°å½•å·²ä¿ç•™å§“åä¿¡æ¯`);xe(!1),be(null),Ie(""),yield Pe()}catch(m){console.error("åˆ é™¤ç”¨æˆ·å¤±è´¥:",m);let e="åˆ é™¤ç”¨æˆ·å¤±è´¥";m.message&&(e=m.message.includes("foreign key constraint")?"åˆ é™¤å¤±è´¥ï¼šè¯¥ç”¨æˆ·ä»æœ‰å…³è”çš„æ•°æ®è®°å½•ï¼Œè¯·è”ç³»ç³»ç»Ÿç®¡ç†å‘˜":m.message.includes("permission denied")?"åˆ é™¤å¤±è´¥ï¼šæƒé™ä¸è¶³ï¼Œè¯·æ£€æŸ¥æ‚¨çš„æ“ä½œæƒé™":m.message.includes("æ¸…ç†å·¥æ—¶è®°å½•å¼•ç”¨å¤±è´¥")?"åˆ é™¤å¤±è´¥ï¼šæ¸…ç†å·¥æ—¶è®°å½•å…³è”æ•°æ®æ—¶å‡ºé”™":m.message.includes("æ¸…ç†å®¡æ ¸å†å²å¼•ç”¨å¤±è´¥")?"åˆ é™¤å¤±è´¥ï¼šæ¸…ç†å®¡æ ¸å†å²æ•°æ®æ—¶å‡ºé”™":`åˆ é™¤å¤±è´¥ï¼š${m.message}`),qe(e),R.error(e),xe(!1),be(null)}}),disabled:(null==(T=pe.pendingRecords)?void 0:T.length)>0&&!Le,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-red-600 hover:bg-red-500 disabled:bg-red-800 disabled:cursor-not-allowed text-white font-bold rounded transition-colors font-mono",children:[d.jsxDEV(_,{className:"w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1870,columnNumber:19},this),"å‘˜å·¥"===(null==(z=pe.role)?void 0:z.name)?"ç¡®è®¤å¤„ç†":"ç¡®è®¤åˆ é™¤"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1865,columnNumber:17},this),d.jsxDEV("button",{onClick:()=>{xe(!1),be(null)},className:"flex-1 px-4 py-2 bg-gray-600 hover:bg-gray-500 text-white font-bold rounded transition-colors font-mono",children:"å–æ¶ˆ"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1873,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1864,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1779,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1778,columnNumber:11},this),je&&De&&d.jsxDEV("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",children:d.jsxDEV("div",{className:"bg-gray-900 border border-blue-400 rounded-lg p-6 w-full max-w-md",children:[d.jsxDEV("div",{className:"flex items-center gap-3 mb-4",children:[d.jsxDEV(D,{className:"text-blue-400 w-8 h-8"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1889,columnNumber:17},this),d.jsxDEV("h2",{className:"text-xl font-bold text-blue-400 font-mono",children:"ç¡®è®¤ç”Ÿäº§çº¿å˜æ›´"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1890,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1888,columnNumber:15},this),d.jsxDEV("div",{className:"mb-6",children:[d.jsxDEV("p",{className:"text-green-300 font-mono mb-2",children:["ç¡®å®šè¦å°†ç”¨æˆ· ",d.jsxDEV("span",{className:"text-green-400 font-bold",children:['"',De.user.name,'"']},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1897,columnNumber:26},this)," çš„ç”Ÿäº§çº¿ä»",d.jsxDEV("span",{className:"text-blue-400 font-bold",children:['"',De.oldProductionLine,'"']},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1898,columnNumber:19},this)," å˜æ›´ä¸º",d.jsxDEV("span",{className:"text-purple-400 font-bold",children:['"',De.newProductionLine,'"']},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1899,columnNumber:19},this)," å—ï¼Ÿ"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1896,columnNumber:17},this),De.pendingRecords&&De.pendingRecords.length>0?d.jsxDEV("div",{className:"space-y-3",children:[d.jsxDEV("div",{className:"text-yellow-300 font-mono text-sm p-3 bg-yellow-900/20 border border-yellow-600 rounded",children:[d.jsxDEV("p",{className:"mb-1",children:"âš ï¸ æ•°æ®è½¬ç§»ï¼š"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1905,columnNumber:23},this),d.jsxDEV("p",{className:"text-xs mb-2",children:["æ£€æµ‹åˆ°",De.pendingRecords.length,"æ¡å¾…å®¡æ ¸å·¥æ—¶è®°å½•éœ€è¦è½¬ç§»åˆ°åŸç”Ÿäº§çº¿(",De.oldProductionLine,")çš„ç›¸åŒè§’è‰²ä¸‹ã€‚"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1906,columnNumber:23},this),d.jsxDEV("p",{className:"text-yellow-200 text-xs",children:["æ¶‰åŠå‘˜å·¥ï¼š",null==(G=De.userNames)?void 0:G.join("ã€")]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1907,columnNumber:23},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1904,columnNumber:21},this),d.jsxDEV("div",{children:[d.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-2",children:["é€‰æ‹©åŸç”Ÿäº§çº¿çš„",null==(A=De.role)?void 0:A.name,"ä½œä¸ºæ•°æ®æ¥æ”¶äººï¼š"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1912,columnNumber:23},this),d.jsxDEV("select",{value:Me,onChange:e=>Ve(e.target.value),className:"w-full px-3 py-2 bg-black border border-green-400 rounded text-green-300 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono text-sm",required:!0,children:[d.jsxDEV("option",{value:"",children:"è¯·é€‰æ‹©æ¥æ”¶äºº"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1921,columnNumber:25},this),null==(B=De.sameRoleUsers)?void 0:B.map(e=>d.jsxDEV("option",{value:e.id,children:e.name},e.id,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1923,columnNumber:27},this))]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1915,columnNumber:23},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1911,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1903,columnNumber:19},this):d.jsxDEV("div",{className:"text-green-300 font-mono text-sm mb-2 p-3 bg-green-900/20 border border-green-600 rounded",children:[d.jsxDEV("p",{className:"mb-1",children:"âœ… å®‰å…¨å˜æ›´ï¼š"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1932,columnNumber:21},this),d.jsxDEV("p",{className:"text-xs",children:["è¯¥",null==(F=De.role)?void 0:F.name,"æ²¡æœ‰å¾…å®¡æ ¸çš„å·¥æ—¶è®°å½•ï¼Œå¯ä»¥å®‰å…¨å˜æ›´ç”Ÿäº§çº¿ã€‚"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1933,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1931,columnNumber:19},this),d.jsxDEV("p",{className:"text-blue-300 font-mono text-sm mt-2",children:"ç”Ÿäº§çº¿å˜æ›´åå°†å½±å“ç”¨æˆ·çš„å·¥ä½œèŒƒå›´å’Œå®¡æ‰¹æƒé™ã€‚"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1937,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1895,columnNumber:15},this),d.jsxDEV("div",{className:"flex gap-3",children:[d.jsxDEV("button",{onClick:()=>l(this,null,function*(){var e,s,n,t;if(De.user&&Me)try{if(console.log("æ‰§è¡Œç”Ÿäº§çº¿å˜æ›´æ•°æ®è½¬ç§»..."),De.pendingRecords&&De.pendingRecords.length>0){console.log("æ‰§è¡Œæ•°æ®è½¬ç§»...");const t="ç­é•¿"===(null==(e=De.role)?void 0:e.name)?"supervisor_id":"section_chief_id",m="ç­é•¿"===(null==(s=De.role)?void 0:s.name)?["pending","å¾…å®¡æ ¸","submitted","å·²æäº¤"]:["approved"],{error:r}=yield M.from("timesheet_records").update({[t]:Me}).eq(t,De.user.id).in("status",m);if(r)throw console.error("æ•°æ®è½¬ç§»å¤±è´¥:",r),new Error("æ•°æ®è½¬ç§»å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•");console.log("æ·»åŠ å®¡æ‰¹å†å²è®°å½•...");const a=null==(n=De.sameRoleUsers.find(e=>e.id===Me))?void 0:n.name;for(const e of De.pendingRecords){const{error:s}=yield M.from("approval_history").insert({timesheet_record_id:e.id,approver_id:$e.id,approver_name:$e.name,action:"transfer",comment:`ç”Ÿäº§çº¿å˜æ›´ï¼šå°†å®¡æ ¸æƒé™ä» ${De.user.name}(${De.oldProductionLine}) è½¬ç§»ç»™ ${a}(${De.oldProductionLine})`,created_at:(new Date).toISOString()});s&&console.error("æ·»åŠ å®¡æ‰¹å†å²å¤±è´¥:",s)}console.log(`æ•°æ®è½¬ç§»æˆåŠŸï¼š${De.pendingRecords.length}æ¡è®°å½•è½¬ç§»ç»™${a}`)}const{error:m}=yield M.from("users").update({phone:ue.phone,id_card:ue.id_card,name:ue.name,company_id:ue.company_id,role_id:ue.role_id,production_line:ue.production_line||null,is_active:ue.is_active,updated_at:(new Date).toISOString()}).eq("id",De.user.id);if(m)throw console.error("ç”Ÿäº§çº¿å˜æ›´å¤±è´¥:",m),m;if(De.pendingRecords&&De.pendingRecords.length>0){const e=null==(t=De.sameRoleUsers.find(e=>e.id===Me))?void 0:t.name;R.success(`ç”Ÿäº§çº¿å˜æ›´æˆåŠŸï¼å·²å°†${De.pendingRecords.length}æ¡å¾…å®¡æ ¸æ•°æ®è½¬ç§»ç»™${e}`)}else R.success("ç”Ÿäº§çº¿å˜æ›´æˆåŠŸï¼");_e(!1),Ue({user:null,oldProductionLine:"",newProductionLine:"",role:null,pendingRecords:[],sameRoleUsers:[],userNames:[]}),Ve(""),Ge(),yield Pe()}catch(m){console.error("ç”Ÿäº§çº¿å˜æ›´å¤±è´¥:",m),R.error(m.message||"ç”Ÿäº§çº¿å˜æ›´å¤±è´¥")}else R.error("è¯·é€‰æ‹©æ•°æ®æ¥æ”¶äºº")}),disabled:(null==(J=De.pendingRecords)?void 0:J.length)>0&&!Me,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-500 disabled:bg-blue-800 disabled:cursor-not-allowed text-white font-bold rounded transition-colors font-mono",children:[d.jsxDEV(j,{className:"w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1948,columnNumber:19},this),"ç¡®è®¤å˜æ›´"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1943,columnNumber:17},this),d.jsxDEV("button",{onClick:()=>{_e(!1),Ue({user:null,oldProductionLine:"",newProductionLine:"",role:null,pendingRecords:[],sameRoleUsers:[],userNames:[]}),Ve(""),he(!1)},className:"flex-1 px-4 py-2 bg-gray-600 hover:bg-gray-500 text-white font-bold rounded transition-colors font-mono",children:"å–æ¶ˆ"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1951,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1942,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1887,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1886,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1298,columnNumber:7},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/UserManagement.tsx",lineNumber:1297,columnNumber:5},this)}export{q as default};
