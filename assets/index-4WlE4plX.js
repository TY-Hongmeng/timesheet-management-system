const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-i1CnOG7R.js","assets/react-core-CmOG7fiH.js","assets/vendor-Dj0T90Ik.js","assets/dnd-DpnmCEtS.js","assets/supabase-k270UWii.js","assets/ui-BpXc_XmY.js","assets/TimesheetRecord-agVQD3vY.js","assets/TimesheetHistory-BXA1O3Ab.js","assets/CompanyManagement-CVk5owa0.js","assets/UserManagement-vPPQ1ncq.js","assets/CollapsibleSection-CtE4fUOM.js","assets/ProcessManagement-Cmqao3Md.js","assets/xlsx-DfDjAMCE.js","assets/RoleList-LH6xm066.js","assets/RoleEdit-CltqzvBa.js","assets/RoleCreate-BH3l902D.js","assets/SupervisorApproval-DNVTcrg8.js","assets/SectionChiefApproval-DOkgBdhY.js","assets/Reports-Bg2HCkWp.js","assets/History-DJ9J3S3c.js","assets/ToastTest-BDOXtG0N.js","assets/LazyLoadTest-CDAZx7fT.js"])))=>i.map(i=>d[i]);
var e=Object.defineProperty,t=Object.defineProperties,s=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,m=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,i=(t,s,n)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,o=(e,t)=>{for(var s in t||(t={}))m.call(t,s)&&i(e,s,t[s]);if(n)for(var s of n(t))r.call(t,s)&&i(e,s,t[s]);return e},a=(e,n)=>t(e,s(n)),l=(e,t,s)=>i(e,"symbol"!=typeof t?t+"":t,s),c=(e,t,s)=>new Promise((n,m)=>{var r=e=>{try{o(s.next(e))}catch(t){m(t)}},i=e=>{try{o(s.throw(e))}catch(t){m(t)}},o=e=>e.done?n(e.value):Promise.resolve(e.value).then(r,i);o((s=s.apply(e,t)).next())});import{r as u,j as h,u as d,N as g,d as N,P as p,L as b,E as y,e as x,X as f,U as v,f as w,C as E,h as k,i as D,A as j,k as V,B as R,S,l as _,m as P,n as A,o as L,p as C}from"./react-core-CmOG7fiH.js";import{c as I,_ as T}from"./supabase-k270UWii.js";import{T as O}from"./ui-BpXc_XmY.js";import"./vendor-Dj0T90Ik.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const M="https://agesdprmugyybtqrvqks.supabase.co";console.log("Supabase配置详情:",{url:"已配置",urlValue:"https://agesdprmugyybtqrvqks.supabase.co".substring(0,50)+"...",key:"已配置",keyValue:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFnZXNkcHJtdWd5eWJ0cXJ2cWtzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUxNDY0OTIsImV4cCI6MjA3MDcyMjQ5Mn0.bfo_xb818yMd7-u6cJhDoJrqmDwcGY1nBDJIesFSfWk".substring(0,50)+"...",env:"production",isDev:!0,isProd:!1}),console.log("✅ Supabase配置正常，连接到:",M);const z=I(M,"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFnZXNkcHJtdWd5eWJ0cXJ2cWtzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUxNDY0OTIsImV4cCI6MjA3MDcyMjQ5Mn0.bfo_xb818yMd7-u6cJhDoJrqmDwcGY1nBDJIesFSfWk",{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"pkce"},global:{headers:{"X-Client-Info":"supabase-js-web-mobile-safari-optimized"},fetch:(e,t)=>c(void 0,null,function*(){try{const s=new AbortController,n=setTimeout(()=>s.abort(),1e4),m=yield fetch(e,a(o({},t),{signal:s.signal}));return clearTimeout(n),m}catch(s){throw console.error("Fetch failed:",s),s}})},db:{schema:"public"},realtime:{params:{eventsPerSecond:3}}});function q(e){return c(this,null,function*(){try{return yield function(e,t=3,s=1e3){return c(this,null,function*(){let n;for(let r=1;r<=t;r++)try{return yield e()}catch(m){if(n=m,console.warn(`操作失败，第 ${r} 次尝试:`,m),r===t)break;const e=s*Math.pow(2,r-1);yield new Promise(t=>setTimeout(t,e))}throw n})}(e,2,500)}catch(t){return console.error("数据库查询失败:",t),{data:null,error:{message:"网络连接异常，请检查网络设置或稍后重试",code:"NETWORK_ERROR",details:t}}}})}const F={USER_READ:"user:read",USER_MANAGE:"user:manage",USER_CREATE:"user:create",USER_DELETE:"user:delete",COMPANY_READ:"company:read",COMPANY_MANAGE:"company:manage",COMPANY_CREATE:"company:create",COMPANY_DELETE:"company:delete",PROCESS_READ:"process:read",PROCESS_MANAGE:"process:manage",PROCESS_CREATE:"process:create",PROCESS_DELETE:"process:delete",ROLE_MANAGE:"role:manage",SYSTEM_CONFIG:"system:config",TIME_RECORD:"time_record",REPORTS:"reports",HISTORY:"history",PROCESS_MANAGEMENT:"process_management",USER_MANAGEMENT:"user_management",COMPANY_MANAGEMENT:"company_management",SUPERVISOR_REVIEW:"supervisor_review",MANAGER_REVIEW:"manager_review",PERMISSION_MANAGEMENT:"permission_management"},J="超级管理员",W=[{id:"time_record",name:"记录工时",description:"记录和管理工作时间",icon:"Clock",path:"/timesheet-record",permission:F.TIME_RECORD,color:"from-green-400 to-green-600"},{id:"reports",name:"查看报表",description:"查看工时统计和分析报表",icon:"BarChart3",path:"/reports",permission:F.REPORTS,color:"from-blue-400 to-blue-600"},{id:"history",name:"历史记录",description:"查看个人工时历史记录",icon:"Activity",path:"/history",permission:F.HISTORY,color:"from-cyan-400 to-cyan-600"},{id:"process_management",name:"工序管理",description:"管理生产工序和流程",icon:"Settings",path:"/process-management",permission:F.PROCESS_MANAGEMENT,color:"from-purple-400 to-purple-600"},{id:"user_management",name:"用户管理",description:"管理系统用户和权限",icon:"Users",path:"/user-management",permission:F.USER_MANAGEMENT,color:"from-orange-400 to-orange-600"},{id:"company_management",name:"公司管理",description:"管理公司信息和部门",icon:"Building2",path:"/company-management",permission:F.COMPANY_MANAGEMENT,color:"from-teal-400 to-teal-600"},{id:"supervisor_review",name:"班长审核",description:"班长审核工时记录",icon:"CheckCircle",path:"/supervisor-approval",permission:F.SUPERVISOR_REVIEW,color:"from-indigo-400 to-indigo-600"},{id:"section_chief_review",name:"段长审核",description:"段长审核工时记录",icon:"Shield",path:"/section-chief-approval",permission:F.MANAGER_REVIEW,color:"from-pink-400 to-pink-600"},{id:"permission_management",name:"权限管理",description:"管理用户角色和权限",icon:"Key",path:"/role-permissions",permission:F.PERMISSION_MANAGEMENT,color:"from-red-400 to-red-600"}];function B(e,t){return c(this,null,function*(){try{return(yield $(e)).includes(t)}catch(s){return console.error("权限检查异常:",s),!1}})}let G=null;const U=6e5;function $(e){return c(this,null,function*(){try{if(G&&G.userId===e&&Date.now()-G.timestamp<U)return G.permissions;const{data:t,error:s}=yield q(()=>c(this,null,function*(){return yield z.from("users").select("\n          id,\n          role_id,\n          user_roles (\n            id,\n            name,\n            permissions\n          )\n        ").eq("id",e).single()}));if(s||!t)return console.error("获取用户信息失败:",s),[];let n=[];return t.user_roles&&H(t.user_roles.name)?n=Z():t.user_roles&&t.user_roles.permissions&&(n=t.user_roles.permissions),G={permissions:n,timestamp:Date.now(),userId:e},n}catch(t){return console.error("获取用户权限异常:",t),[]}})}function Y(e){return W.filter(t=>e.includes(t.permission))}function H(e){return"object"==typeof e&&null!==e?"超级管理员"===e.name:"超级管理员"===e}function X(){return W}const K=(e,t)=>{if(!e)return!1;if(H(e.role||e.user_roles))return!0;const s=e.role||e.user_roles;return!(!s||!s.permissions)&&s.permissions.includes(t)},Z=()=>Object.values(F),Q=u.createContext(void 0);function ee({children:e}){const[t,s]=u.useState(null),[n,m]=u.useState(!0);u.useEffect(()=>{(()=>{c(this,null,function*(){try{const t=localStorage.getItem("auth_user"),n=localStorage.getItem("last_login_time");if(t&&n){const r=JSON.parse(t),i=parseInt(n),o=Date.now();if(o-i>864e5)return console.warn("会话已过期，清除本地数据"),localStorage.removeItem("auth_user"),localStorage.removeItem("last_login_time"),s(null),void m(!1);if(!navigator.onLine)return s(r),void m(!1);try{const{data:e,error:t}=yield Promise.race([z.from("users").select("\n                  *,\n                  company:companies(*),\n                  role:user_roles(*)\n                ").eq("id",r.id).eq("is_active",!0).single(),new Promise((e,t)=>setTimeout(()=>t(new Error("验证超时")),8e3))]);if(e&&!t){const t=yield $(e.id),n={id:e.id,phone:e.phone,name:e.name,id_card:e.id_card,company:e.company,role:e.role,department_id:e.department_id,is_active:e.is_active,permissions:t};s(n),localStorage.setItem("auth_user",JSON.stringify(n)),localStorage.setItem("last_login_time",o.toString())}else console.warn("用户验证失败，清除本地数据"),localStorage.removeItem("auth_user"),localStorage.removeItem("last_login_time"),s(null)}catch(e){console.warn("用户验证网络错误，使用本地数据:",e),s(r)}}else s(null)}catch(t){console.error("检查用户状态失败:",t),localStorage.removeItem("auth_user"),localStorage.removeItem("last_login_time"),s(null)}finally{m(!1)}})})();const e=setInterval(()=>{const e=localStorage.getItem("last_login_time");if(e){const t=parseInt(e);Date.now()-t>864e5&&(console.warn("会话过期，自动登出"),localStorage.removeItem("auth_user"),localStorage.removeItem("last_login_time"),s(null),window.location.href="/login")}},6e4),{data:{subscription:t}}=z.auth.onAuthStateChange((e,t)=>c(this,null,function*(){"SIGNED_OUT"===e&&(s(null),localStorage.removeItem("auth_user"),localStorage.removeItem("last_login_time"))}));return()=>{t.unsubscribe(),clearInterval(e)}},[]);const r=(e,t,n=0)=>c(this,null,function*(){var m,i,o,a,l,u,h,d;try{if(!navigator.onLine)return{success:!1,error:"网络连接已断开，请检查网络后重试"};const{data:n,error:m}=yield Promise.race([z.from("users").select("\n            *,\n            company:companies(*),\n            role:user_roles(*)\n          ").eq("phone",e).eq("is_active",!0).single(),new Promise((e,t)=>setTimeout(()=>t(new Error("请求超时")),1e4))]);if(m){if(console.error("用户查询错误:",m),"PGRST116"===m.code)return{success:!1,error:"用户不存在或已被禁用"};throw m}if(!n)return{success:!1,error:"用户不存在或已被禁用"};if(n.password_hash!==t)return{success:!1,error:"密码错误"};let r=[];n.role&&"超级管理员"===n.role.name?r=Object.values(F):setTimeout(()=>c(this,null,function*(){try{const e=yield $(n.id),t=JSON.parse(localStorage.getItem("auth_user")||"{}");t.id===n.id&&(t.permissions=e,localStorage.setItem("auth_user",JSON.stringify(t)),s(t))}catch(e){console.warn("异步获取权限失败:",e)}}),100);const i={id:n.id,phone:n.phone,name:n.name,id_card:n.id_card,company:n.company,role:n.role,department_id:n.department_id,is_active:n.is_active,permissions:r};return s(i),localStorage.setItem("auth_user",JSON.stringify(i)),localStorage.setItem("last_login_time",Date.now().toString()),{success:!0}}catch(g){console.error("登录失败:",g);const s=(null==(m=g.message)?void 0:m.includes("fetch"))||(null==(i=g.message)?void 0:i.includes("network"))||(null==(o=g.message)?void 0:o.includes("CONNECTION_CLOSED"))||(null==(a=g.message)?void 0:a.includes("ERR_NETWORK_CHANGED"))||(null==(l=g.message)?void 0:l.includes("ERR_ABORTED"))||(null==(u=g.message)?void 0:u.includes("ERR_CONNECTION_CLOSED"))||(null==(h=g.message)?void 0:h.includes("请求超时"))||(null==(d=g.message)?void 0:d.includes("Failed to fetch"))||"NETWORK_ERROR"===g.code||"TypeError"===g.name||!navigator.onLine;return n<5&&s?(console.log(`网络错误，重试登录，第 ${n+1} 次，错误:`,g.message),yield new Promise(e=>setTimeout(e,1e3*Math.pow(2,n))),r(e,t,n+1)):s?{success:!1,error:`网络连接不稳定，已重试${n}次，请检查网络后重试`}:{success:!1,error:g.message||"登录失败，请稍后重试"}}}),i={user:t,loading:n,login:r,register:e=>c(this,null,function*(){try{const{data:t,error:s}=yield z.from("users").select("id").eq("id_card",e.id_card).maybeSingle();if(s&&"PGRST116"!==s.code)return{success:!1,error:"系统错误，请稍后重试"};const{data:n,error:m}=yield z.from("users").select("id").eq("phone",e.phone).maybeSingle();if(m&&"PGRST116"!==m.code)return{success:!1,error:"系统错误，请稍后重试"};if(t||n){if(t)return{success:!1,error:"该身份证号已被注册"};if(n)return{success:!1,error:"该手机号已被注册"}}const r=crypto.randomUUID();console.log("创建用户账号，用户ID:",r);const{error:i}=yield z.from("users").insert({id:r,phone:e.phone,id_card:e.id_card,name:e.name,company_id:e.company_id,role_id:e.role_id,password_hash:e.password,production_line:e.production_line,is_active:!1});if(i)return{success:!1,error:"用户信息创建失败"};const{data:o}=yield z.from("users").select("\n          *,\n          company:companies(*),\n          role:user_roles(*)\n        ").eq("id",r).single();return console.log("用户注册成功，账号状态为禁用，需要管理员激活"),{success:!0}}catch(t){return{success:!1,error:t.message||"注册失败，请重试"}}}),logout:()=>c(this,null,function*(){try{s(null),localStorage.removeItem("auth_user"),localStorage.removeItem("last_login_time"),console.log("用户已成功登出")}catch(e){console.error("登出错误:",e),s(null),localStorage.removeItem("auth_user"),localStorage.removeItem("last_login_time")}}),resetPassword:(e,t)=>c(this,null,function*(){var s;try{const{data:s,error:n}=yield Promise.race([z.from("users").select("id, phone, name").eq("id_card",e).eq("is_active",!0).single(),new Promise((e,t)=>setTimeout(()=>t(new Error("查询超时")),8e3))]);if(n)return console.error("用户查询错误:",n),"PGRST116"===n.code?{success:!1,error:"未找到该身份证号对应的用户"}:{success:!1,error:"查询用户失败，请重试"};if(!s)return{success:!1,error:"未找到该身份证号对应的用户"};if(!t)return{success:!0,user:{id:s.id,phone:s.phone,name:s.name}};const{error:m}=yield Promise.race([z.from("users").update({password_hash:t}).eq("id",s.id),new Promise((e,t)=>setTimeout(()=>t(new Error("更新超时")),8e3))]);return m?(console.error("密码更新错误:",m),{success:!1,error:"密码重置失败，请重试"}):{success:!0}}catch(n){return console.error("重置密码失败:",n),(null==(s=n.message)?void 0:s.includes("超时"))?{success:!1,error:"网络超时，请检查网络连接后重试"}:{success:!1,error:n.message||"密码重置失败"}}}),refreshUser:()=>c(this,null,function*(){if(null==t?void 0:t.id)try{const{data:e,error:n}=yield z.from("users").select("\n          *,\n          company:companies(*),\n          role:user_roles(*)\n        ").eq("id",t.id).eq("is_active",!0).single();if(e&&!n){const t=yield $(e.id),n={id:e.id,phone:e.phone,name:e.name,id_card:e.id_card,company:e.company,role:e.role,department_id:e.department_id,is_active:e.is_active,permissions:t};s(n),localStorage.setItem("auth_user",JSON.stringify(n))}}catch(e){console.error("刷新用户信息失败:",e)}}),isAuthenticated:()=>!!(t&&t.id&&t.is_active)};return h.jsxDEV(Q.Provider,{value:i,children:e},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/contexts/AuthContext.tsx",lineNumber:498,columnNumber:10},this)}function te(){const e=u.useContext(Q);if(void 0===e)throw new Error("useAuth must be used within an AuthProvider");return e}function se({children:e,requireAuth:t=!0}){const{user:s,loading:n,isAuthenticated:m}=te(),r=d();return n?h.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center",children:h.jsxDEV("div",{className:"text-green-400 text-xl animate-pulse font-mono",children:"加载中..."},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ProtectedRoute.tsx",lineNumber:17,columnNumber:9},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ProtectedRoute.tsx",lineNumber:16,columnNumber:7},this):t&&!m()?h.jsxDEV(g,{to:"/login",state:{from:r},replace:!0},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ProtectedRoute.tsx",lineNumber:26,columnNumber:12},this):!t&&m()?h.jsxDEV(g,{to:"/dashboard",replace:!0},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ProtectedRoute.tsx",lineNumber:31,columnNumber:12},this):h.jsxDEV(h.Fragment,{children:e},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ProtectedRoute.tsx",lineNumber:34,columnNumber:10},this)}function ne({children:e,allowedRoles:t,fallbackPath:s="/dashboard"}){var n;const{user:m,loading:r}=te(),i=d();if(r)return h.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center",children:h.jsxDEV("div",{className:"text-green-400 text-xl animate-pulse font-mono",children:"加载中..."},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RoleProtectedRoute.tsx",lineNumber:22,columnNumber:9},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RoleProtectedRoute.tsx",lineNumber:21,columnNumber:7},this);if(!m)return h.jsxDEV(g,{to:"/login",state:{from:i},replace:!0},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RoleProtectedRoute.tsx",lineNumber:31,columnNumber:12},this);const o=null==(n=m.role)?void 0:n.name,a=t.some(e=>o===e||(null==o?void 0:o.toLowerCase())===e.toLowerCase());return console.log("🔍 RoleProtectedRoute 权限检查:",{userRole:o,allowedRoles:t,hasPermission:a,currentPath:i.pathname}),a?h.jsxDEV(h.Fragment,{children:e},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RoleProtectedRoute.tsx",lineNumber:70,columnNumber:10},this):h.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center",children:h.jsxDEV("div",{className:"text-center",children:[h.jsxDEV("div",{className:"text-red-400 text-6xl mb-4",children:"🚫"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RoleProtectedRoute.tsx",lineNumber:54,columnNumber:11},this),h.jsxDEV("h1",{className:"text-2xl font-bold text-red-400 mb-2 font-mono",children:"访问被拒绝"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RoleProtectedRoute.tsx",lineNumber:55,columnNumber:11},this),h.jsxDEV("p",{className:"text-green-300 mb-6 font-mono",children:["您没有权限访问此页面。需要角色: ",t.join(", ")]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RoleProtectedRoute.tsx",lineNumber:56,columnNumber:11},this),h.jsxDEV("button",{onClick:()=>window.history.back(),className:"px-6 py-2 bg-green-600 hover:bg-green-500 text-black font-bold rounded font-mono transition-colors",children:"返回上一页"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RoleProtectedRoute.tsx",lineNumber:59,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RoleProtectedRoute.tsx",lineNumber:53,columnNumber:9},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RoleProtectedRoute.tsx",lineNumber:52,columnNumber:7},this)}const me=()=>{const[e,t]=u.useState(null),[s,n]=u.useState(!1),[m,r]=u.useState([]);u.useEffect(()=>{const e=()=>{var e;const s=performance.getEntriesByType("navigation")[0],n=performance.getEntriesByType("paint"),r=performance.getEntriesByType("resource"),i=(null==(e=n.find(e=>"first-contentful-paint"===e.name))?void 0:e.startTime)||0,o=r.filter(e=>e.name.includes(".js")),a=r.filter(e=>e.name.includes(".css")),l=o.reduce((e,t)=>e+(t.transferSize||0),0),c=a.reduce((e,t)=>e+(t.transferSize||0),0);t({loadTime:s.loadEventEnd-s.navigationStart,domContentLoaded:s.domContentLoadedEventEnd-s.navigationStart,firstContentfulPaint:i,largestContentfulPaint:0,totalJSSize:l,totalCSSSize:c,chunkCount:o.length,lazyLoadedComponents:m})};if("complete"===document.readyState?setTimeout(e,1e3):window.addEventListener("load",()=>{setTimeout(e,1e3)}),"PerformanceObserver"in window){new PerformanceObserver(e=>{const s=e.getEntries(),n=s[s.length-1];t(e=>e?a(o({},e),{largestContentfulPaint:n.startTime}):null)}).observe({entryTypes:["largest-contentful-paint"]})}return()=>{}},[m]);const i=e=>{if(0===e)return"0 B";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["B","KB","MB","GB"][t]},l=e=>`${e.toFixed(0)}ms`;return e?h.jsxDEV(h.Fragment,{children:[h.jsxDEV("button",{onClick:()=>n(!s),className:"fixed bottom-4 right-4 z-50 bg-blue-600 text-white p-3 rounded-full shadow-lg hover:bg-blue-700 transition-colors",title:"性能监控",children:"📊"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/PerformanceMonitor.tsx",lineNumber:91,columnNumber:7},void 0),s&&h.jsxDEV("div",{className:"fixed bottom-16 right-4 z-50 bg-white border border-gray-200 rounded-lg shadow-xl p-4 max-w-sm w-80 max-h-96 overflow-y-auto",children:[h.jsxDEV("div",{className:"flex justify-between items-center mb-3",children:[h.jsxDEV("h3",{className:"font-semibold text-gray-800",children:"性能监控"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/PerformanceMonitor.tsx",lineNumber:103,columnNumber:13},void 0),h.jsxDEV("button",{onClick:()=>n(!1),className:"text-gray-500 hover:text-gray-700",children:"✕"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/PerformanceMonitor.tsx",lineNumber:104,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/PerformanceMonitor.tsx",lineNumber:102,columnNumber:11},void 0),h.jsxDEV("div",{className:"space-y-3 text-sm",children:[h.jsxDEV("div",{className:"bg-green-50 p-2 rounded",children:[h.jsxDEV("div",{className:"font-medium text-green-800",children:"加载性能"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/PerformanceMonitor.tsx",lineNumber:115,columnNumber:15},void 0),h.jsxDEV("div",{className:"text-green-600",children:[h.jsxDEV("div",{children:["页面加载: ",l(e.loadTime)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/PerformanceMonitor.tsx",lineNumber:117,columnNumber:17},void 0),h.jsxDEV("div",{children:["DOM就绪: ",l(e.domContentLoaded)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/PerformanceMonitor.tsx",lineNumber:118,columnNumber:17},void 0),h.jsxDEV("div",{children:["首次内容绘制: ",l(e.firstContentfulPaint)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/PerformanceMonitor.tsx",lineNumber:119,columnNumber:17},void 0),e.largestContentfulPaint>0&&h.jsxDEV("div",{children:["最大内容绘制: ",l(e.largestContentfulPaint)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/PerformanceMonitor.tsx",lineNumber:121,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/PerformanceMonitor.tsx",lineNumber:116,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/PerformanceMonitor.tsx",lineNumber:114,columnNumber:13},void 0),h.jsxDEV("div",{className:"bg-blue-50 p-2 rounded",children:[h.jsxDEV("div",{className:"font-medium text-blue-800",children:"资源大小"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/PerformanceMonitor.tsx",lineNumber:128,columnNumber:15},void 0),h.jsxDEV("div",{className:"text-blue-600",children:[h.jsxDEV("div",{children:["JavaScript: ",i(e.totalJSSize)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/PerformanceMonitor.tsx",lineNumber:130,columnNumber:17},void 0),h.jsxDEV("div",{children:["CSS: ",i(e.totalCSSSize)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/PerformanceMonitor.tsx",lineNumber:131,columnNumber:17},void 0),h.jsxDEV("div",{children:["JS文件数: ",e.chunkCount]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/PerformanceMonitor.tsx",lineNumber:132,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/PerformanceMonitor.tsx",lineNumber:129,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/PerformanceMonitor.tsx",lineNumber:127,columnNumber:13},void 0),h.jsxDEV("div",{className:"bg-purple-50 p-2 rounded",children:[h.jsxDEV("div",{className:"font-medium text-purple-800",children:"懒加载组件"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/PerformanceMonitor.tsx",lineNumber:138,columnNumber:15},void 0),h.jsxDEV("div",{className:"text-purple-600 max-h-24 overflow-y-auto",children:e.lazyLoadedComponents.length>0?e.lazyLoadedComponents.map((e,t)=>h.jsxDEV("div",{className:"text-xs",children:e},t,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/PerformanceMonitor.tsx",lineNumber:142,columnNumber:21},void 0)):h.jsxDEV("div",{className:"text-xs",children:"暂无懒加载组件"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/PerformanceMonitor.tsx",lineNumber:145,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/PerformanceMonitor.tsx",lineNumber:139,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/PerformanceMonitor.tsx",lineNumber:137,columnNumber:13},void 0),h.jsxDEV("div",{className:"bg-yellow-50 p-2 rounded",children:[h.jsxDEV("div",{className:"font-medium text-yellow-800",children:"性能评分"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/PerformanceMonitor.tsx",lineNumber:152,columnNumber:15},void 0),h.jsxDEV("div",{className:"text-yellow-600",children:[h.jsxDEV("div",{children:["首屏速度: ",e.firstContentfulPaint<1500?"优秀":e.firstContentfulPaint<2500?"良好":"需优化"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/PerformanceMonitor.tsx",lineNumber:154,columnNumber:17},void 0),h.jsxDEV("div",{children:["资源大小: ",e.totalJSSize<5e5?"优秀":e.totalJSSize<1e6?"良好":"需优化"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/PerformanceMonitor.tsx",lineNumber:158,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/PerformanceMonitor.tsx",lineNumber:153,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/PerformanceMonitor.tsx",lineNumber:151,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/PerformanceMonitor.tsx",lineNumber:112,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/PerformanceMonitor.tsx",lineNumber:101,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/PerformanceMonitor.tsx",lineNumber:89,columnNumber:5},void 0):null};function re(){var e,t;const[s,n]=u.useState({phone:"",password:""}),[m,r]=u.useState(!1),[i,l]=u.useState(!1),[g,E]=u.useState(""),[k,D]=u.useState(!1),[j,V]=u.useState(!1),[R,S]=u.useState([]),{login:_}=te(),P=N(),A=(null==(t=null==(e=d().state)?void 0:e.from)?void 0:t.pathname)||"/dashboard",L=e=>{try{return atob(e)}catch(t){return""}};u.useEffect(()=>{const e=localStorage.getItem("savedUsers"),t=localStorage.getItem("savedCredentials");if(e){const t=JSON.parse(e);S(t),t.length>0&&(n(e=>a(o({},e),{phone:t[0].phone})),D(!0))}if(t)try{const e=JSON.parse(t);e.phone&&e.password&&(n({phone:e.phone,password:L(e.password)}),V(!0),D(!0))}catch(s){console.error("Failed to load saved credentials:",s)}},[]);const C=e=>{n(a(o({},s),{[e.target.name]:e.target.value}))};return h.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center px-4",children:h.jsxDEV("div",{className:"max-w-md w-full space-y-8",children:[h.jsxDEV("div",{className:"text-center",children:[h.jsxDEV("div",{className:"flex items-center justify-center mb-2",children:[h.jsxDEV("svg",{className:"w-16 h-16 mr-4",viewBox:"0 0 80 80",xmlns:"http://www.w3.org/2000/svg",children:[h.jsxDEV("ellipse",{cx:"40",cy:"40",rx:"38",ry:"30",fill:"black",stroke:"#22c55e",strokeWidth:"3"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:163,columnNumber:15},this),h.jsxDEV("text",{x:"40",y:"50",textAnchor:"middle",fill:"#22c55e",fontSize:"28",fontWeight:"bold",fontFamily:"Arial, sans-serif",children:"JT"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:164,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:162,columnNumber:13},this),h.jsxDEV("h1",{className:"text-4xl font-bold text-green-400 font-mono",children:"工时管理系统"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:166,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:161,columnNumber:11},this),h.jsxDEV("div",{className:"mt-4 h-1 bg-gradient-to-r from-transparent via-green-400 to-transparent"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:170,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:160,columnNumber:9},this),h.jsxDEV("div",{className:"bg-gray-900 border border-green-400 rounded-lg p-8 shadow-lg shadow-green-400/20",children:[h.jsxDEV("h2",{className:"text-2xl font-bold text-green-400 mb-6 text-center font-mono",children:"用户登录"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:175,columnNumber:11},this),g&&h.jsxDEV("div",{className:"mb-4 p-3 bg-red-900/50 border border-red-400 rounded text-red-300 text-sm",children:g},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:180,columnNumber:13},this),h.jsxDEV("form",{onSubmit:e=>c(this,null,function*(){if(e.preventDefault(),l(!0),E(""),!s.phone||!s.password)return E("请填写所有必填字段"),void l(!1);const t=yield _(s.phone,s.password);if(t.success){if(k){const e=JSON.parse(localStorage.getItem("savedUsers")||"[]");if(e.find(e=>e.phone===s.phone)){const t=e.filter(e=>e.phone!==s.phone),n=[{phone:s.phone},...t];localStorage.setItem("savedUsers",JSON.stringify(n))}else{const t=[{phone:s.phone},...e.slice(0,4)];localStorage.setItem("savedUsers",JSON.stringify(t))}}if(j){const e={phone:s.phone,password:(n=s.password,btoa(n))};localStorage.setItem("savedCredentials",JSON.stringify(e))}else localStorage.removeItem("savedCredentials");P(A,{replace:!0})}else E(t.error||"登录失败");var n;l(!1)}),className:"space-y-6",children:[h.jsxDEV("div",{children:[h.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-2",children:"手机号码"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:188,columnNumber:15},this),h.jsxDEV("div",{className:"relative",children:[h.jsxDEV(p,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-5 h-5"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:192,columnNumber:17},this),h.jsxDEV("input",{type:"tel",name:"phone",value:s.phone,onChange:C,className:"w-full pl-12 pr-4 py-3 bg-black border border-green-400 rounded-lg text-green-300 placeholder-green-600 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono",placeholder:"请输入手机号码",maxLength:11},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:193,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:191,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:187,columnNumber:13},this),h.jsxDEV("div",{children:[h.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-2",children:"登录密码"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:207,columnNumber:15},this),h.jsxDEV("div",{className:"relative",children:[h.jsxDEV(b,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-5 h-5"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:211,columnNumber:17},this),h.jsxDEV("input",{type:m?"text":"password",name:"password",value:s.password,onChange:C,className:"w-full pl-12 pr-12 py-3 bg-black border border-green-400 rounded-lg text-green-300 placeholder-green-600 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono",placeholder:"请输入密码"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:212,columnNumber:17},this),h.jsxDEV("button",{type:"button",onClick:()=>r(!m),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-green-400 hover:text-green-300",children:m?h.jsxDEV(y,{className:"w-5 h-5"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:225,columnNumber:35},this):h.jsxDEV(x,{className:"w-5 h-5"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:225,columnNumber:68},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:220,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:210,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:206,columnNumber:13},this),h.jsxDEV("div",{className:"space-y-3",children:[h.jsxDEV("div",{className:"flex items-center",children:[h.jsxDEV("input",{type:"checkbox",id:"rememberMe",checked:k,onChange:e=>D(e.target.checked),className:"w-4 h-4 text-green-600 bg-black border-green-400 rounded focus:ring-green-500 focus:ring-2"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:233,columnNumber:17},this),h.jsxDEV("label",{htmlFor:"rememberMe",className:"ml-2 text-sm text-green-300 font-mono",children:"记住账号"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:240,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:232,columnNumber:15},this),h.jsxDEV("div",{className:"flex items-center",children:[h.jsxDEV("input",{type:"checkbox",id:"rememberPassword",checked:j,onChange:e=>V(e.target.checked),className:"w-4 h-4 text-green-600 bg-black border-green-400 rounded focus:ring-green-500 focus:ring-2"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:246,columnNumber:17},this),h.jsxDEV("label",{htmlFor:"rememberPassword",className:"ml-2 text-sm text-green-300 font-mono",children:"记住密码"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:253,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:245,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:231,columnNumber:13},this),h.jsxDEV("button",{type:"submit",disabled:i,className:"w-full py-3 bg-green-600 hover:bg-green-500 disabled:bg-green-800 text-black font-bold rounded-lg transition-colors duration-200 font-mono text-lg",children:i?"登录中...":"登录"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:260,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:185,columnNumber:11},this),R.length>0&&h.jsxDEV("div",{className:"mt-6",children:[h.jsxDEV("div",{className:"flex items-center justify-between mb-3",children:[h.jsxDEV("h3",{className:"text-green-300 text-sm font-mono",children:"快速登录"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:273,columnNumber:17},this),h.jsxDEV("button",{type:"button",onClick:()=>{localStorage.removeItem("savedUsers"),localStorage.removeItem("savedCredentials"),S([]),n({phone:"",password:""}),D(!1),V(!1)},className:"text-red-400 hover:text-red-300 text-xs font-mono flex items-center",title:"清除所有保存的登录信息",children:[h.jsxDEV(f,{className:"w-3 h-3 mr-1"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:280,columnNumber:19},this),"清除"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:274,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:272,columnNumber:15},this),h.jsxDEV("div",{className:"space-y-2",children:R.slice(0,3).map((e,t)=>h.jsxDEV("button",{type:"button",onClick:()=>(e=>{n(t=>a(o({},t),{phone:e}));const t=localStorage.getItem("savedCredentials");if(t)try{const s=JSON.parse(t);s.phone===e&&s.password&&(n({phone:e,password:L(s.password)}),V(!0))}catch(s){console.error("Failed to load saved password:",s)}})(e.phone),className:"w-full flex items-center p-2 bg-gray-800 hover:bg-gray-700 border border-green-400/30 rounded-lg transition-colors duration-200",children:[h.jsxDEV(v,{className:"w-4 h-4 text-green-400 mr-2"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:292,columnNumber:21},this),h.jsxDEV("span",{className:"text-green-300 font-mono text-sm",children:e.phone},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:293,columnNumber:21},this),s.phone===e.phone&&h.jsxDEV("span",{className:"ml-auto text-green-400 text-xs font-mono",children:"当前"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:295,columnNumber:23},this)]},e.phone,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:286,columnNumber:19},this))},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:284,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:271,columnNumber:13},this),h.jsxDEV("div",{className:"mt-6 text-center space-y-2",children:[h.jsxDEV(w,{to:"/register",className:"block text-green-400 hover:text-green-300 text-sm font-mono transition-colors",children:"还没有账号？立即注册"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:305,columnNumber:13},this),h.jsxDEV(w,{to:"/reset-password",className:"block text-green-400 hover:text-green-300 text-sm font-mono transition-colors",children:"忘记密码？重置密码"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:311,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:304,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:174,columnNumber:9},this),h.jsxDEV("div",{className:"text-center text-green-600 text-xs font-mono",children:[h.jsxDEV("p",{children:"© 吉林省通用机械（集团）有限责任公司."},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:322,columnNumber:11},this),h.jsxDEV("div",{className:"mt-2 flex justify-center space-x-2",children:[h.jsxDEV("span",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:324,columnNumber:13},this),h.jsxDEV("span",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse",style:{animationDelay:"0.2s"}},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:325,columnNumber:13},this),h.jsxDEV("span",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse",style:{animationDelay:"0.4s"}},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:326,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:323,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:321,columnNumber:9},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:158,columnNumber:7},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Login.tsx",lineNumber:157,columnNumber:5},this)}function ie({isOpen:e,onClose:t,userName:s,userPhone:n}){return e?h.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:h.jsxDEV("div",{className:"bg-gray-900 border border-green-400 rounded-lg shadow-2xl shadow-green-400/30 max-w-md w-full",children:[h.jsxDEV("div",{className:"bg-gradient-to-r from-green-900/50 to-green-800/50 border-b border-green-400/30 p-6 rounded-t-lg",children:[h.jsxDEV("div",{className:"flex items-center justify-center mb-4",children:h.jsxDEV("div",{className:"relative",children:[h.jsxDEV(E,{className:"w-16 h-16 text-green-400"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:26,columnNumber:15},this),h.jsxDEV("div",{className:"absolute inset-0 animate-ping",children:h.jsxDEV(E,{className:"w-16 h-16 text-green-400 opacity-30"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:28,columnNumber:17},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:27,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:25,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:24,columnNumber:11},this),h.jsxDEV("h2",{className:"text-2xl font-bold text-green-400 text-center font-mono",children:"注册申请提交成功"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:32,columnNumber:11},this),h.jsxDEV("p",{className:"text-green-300 text-center text-sm font-mono mt-2",children:"REGISTRATION SUBMITTED SUCCESSFULLY"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:35,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:23,columnNumber:9},this),h.jsxDEV("div",{className:"p-6 space-y-6",children:[h.jsxDEV("div",{className:"bg-black/50 border border-green-400/30 rounded-lg p-4",children:[h.jsxDEV("h3",{className:"text-green-400 font-mono text-sm mb-3 flex items-center",children:[h.jsxDEV(k,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:45,columnNumber:15},this),"申请人信息"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:44,columnNumber:13},this),h.jsxDEV("div",{className:"space-y-2 text-sm",children:[h.jsxDEV("div",{className:"flex justify-between",children:[h.jsxDEV("span",{className:"text-green-300",children:"姓名："},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:50,columnNumber:17},this),h.jsxDEV("span",{className:"text-green-100 font-mono",children:s},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:51,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:49,columnNumber:15},this),h.jsxDEV("div",{className:"flex justify-between",children:[h.jsxDEV("span",{className:"text-green-300",children:"手机号："},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:54,columnNumber:17},this),h.jsxDEV("span",{className:"text-green-100 font-mono",children:n},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:55,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:53,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:48,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:43,columnNumber:11},this),h.jsxDEV("div",{className:"bg-yellow-900/20 border border-yellow-400/30 rounded-lg p-4",children:[h.jsxDEV("h3",{className:"text-yellow-400 font-mono text-sm mb-3 flex items-center",children:[h.jsxDEV(D,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:63,columnNumber:15},this),"当前状态"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:62,columnNumber:13},this),h.jsxDEV("div",{className:"space-y-3",children:[h.jsxDEV("div",{className:"flex items-center",children:[h.jsxDEV("div",{className:"w-2 h-2 bg-yellow-400 rounded-full mr-3 animate-pulse"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:68,columnNumber:17},this),h.jsxDEV("span",{className:"text-yellow-100 text-sm",children:"账号状态：待激活"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:69,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:67,columnNumber:15},this),h.jsxDEV("p",{className:"text-yellow-200 text-xs leading-relaxed",children:'您的账号已成功创建，但当前处于"待激活"状态。系统管理员将在1-2个工作日内审核您的申请。'},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:71,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:66,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:61,columnNumber:11},this),h.jsxDEV("div",{className:"bg-blue-900/20 border border-blue-400/30 rounded-lg p-4",children:[h.jsxDEV("h3",{className:"text-blue-400 font-mono text-sm mb-3",children:"后续步骤"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:79,columnNumber:13},this),h.jsxDEV("div",{className:"space-y-2 text-xs text-blue-200",children:[h.jsxDEV("div",{className:"flex items-start",children:[h.jsxDEV(j,{className:"w-3 h-3 mr-2 mt-0.5 text-blue-400 flex-shrink-0"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:82,columnNumber:17},this),h.jsxDEV("span",{children:"请耐心等待系统管理员审核激活您的账号"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:83,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:81,columnNumber:15},this),h.jsxDEV("div",{className:"flex items-start",children:[h.jsxDEV(j,{className:"w-3 h-3 mr-2 mt-0.5 text-blue-400 flex-shrink-0"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:86,columnNumber:17},this),h.jsxDEV("span",{children:"账号激活后，您将可以使用注册的手机号和密码登录系统"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:87,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:85,columnNumber:15},this),h.jsxDEV("div",{className:"flex items-start",children:[h.jsxDEV(j,{className:"w-3 h-3 mr-2 mt-0.5 text-blue-400 flex-shrink-0"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:90,columnNumber:17},this),h.jsxDEV("span",{children:"如有疑问，请联系系统管理员或IT支持部门"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:91,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:89,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:80,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:78,columnNumber:11},this),h.jsxDEV("div",{className:"pt-4",children:h.jsxDEV("button",{onClick:t,className:"w-full bg-green-600 hover:bg-green-500 text-white font-mono py-3 px-4 rounded-lg transition-all duration-200 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-green-400 focus:ring-opacity-50",children:"前往登录页面"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:98,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:97,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:41,columnNumber:9},this),h.jsxDEV("div",{className:"bg-gray-800/50 border-t border-green-400/30 p-4 rounded-b-lg",children:h.jsxDEV("p",{className:"text-green-300 text-xs text-center font-mono",children:"工时管理系统 · TIMETRACK SYSTEM"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:109,columnNumber:11},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:108,columnNumber:9},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:21,columnNumber:7},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/RegistrationSuccessDialog.tsx",lineNumber:20,columnNumber:5},this):null}function oe(){const[e,t]=u.useState({phone:"",password:"",confirmPassword:"",id_card:"",name:"",company_id:"",role_id:"",production_line:""}),[s,n]=u.useState(!1),[m,r]=u.useState(!1),[i,l]=u.useState(!1),[d,g]=u.useState(""),[f,E]=u.useState([]),[D,j]=u.useState([]),[_,P]=u.useState(""),[A,L]=u.useState(!0),[C,I]=u.useState([]),[T,O]=u.useState(!1),[M,q]=u.useState(null),[F,J]=u.useState(!1),[W,B]=u.useState(""),[G,U]=u.useState(!1),[$,Y]=u.useState(""),[H,X]=u.useState(!1),[K,Z]=u.useState(""),[Q,ee]=u.useState(!1),{register:se}=te(),ne=N();u.useEffect(()=>{const e=e=>{const t=e.target;t.closest(".production-line-dropdown")||U(!1),t.closest(".company-dropdown")||X(!1),t.closest(".role-dropdown")||ee(!1)};return(G||H||Q)&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[G,H,Q]),u.useEffect(()=>{(()=>{c(this,null,function*(){try{const{data:e,error:t}=yield z.from("companies").select("*").order("name");if(t)throw t;const{data:s,error:n}=yield z.from("user_roles").select("*").neq("name","超级管理员").order("name");if(n)throw n;E(e||[]),j(s||[])}catch(e){g("获取数据失败，请重试")}finally{L(!1)}})})()},[]);const me=e=>c(this,null,function*(){try{console.log("🔍 Register.tsx - fetchProductionLines: 开始获取生产线数据，公司ID:",e);const{data:t,error:s}=yield z.from("processes").select("production_line, company_id").eq("company_id",e).not("production_line","is",null);if(s)throw s;console.log("📊 Register.tsx - fetchProductionLines: 查询到的原始数据:",t),console.log("📊 Register.tsx - fetchProductionLines: 原始数据数量:",(null==t?void 0:t.length)||0);const n=[...new Set((null==t?void 0:t.map(e=>e.production_line).filter(Boolean))||[])];console.log("🎯 Register.tsx - fetchProductionLines: 去重后的生产线:",n),console.log("🎯 Register.tsx - fetchProductionLines: 去重后的生产线数量:",n.length),I(n)}catch(t){console.error("获取生产线数据失败:",t),I([])}}),re=s=>c(this,null,function*(){const{name:n,value:m}=s.target;if(t(e=>a(o({},e),{[n]:m})),"role_id"===n){const s=D.find(e=>e.id===m);q(s||null);const n=s&&("班长"===s.name||"段长"===s.name);O(n||!1),n&&e.company_id&&(yield me(e.company_id)),n||t(e=>a(o({},e),{production_line:""}))}if("company_id"===n&&T&&(yield me(m),t(e=>a(o({},e),{production_line:""}))),"confirmPassword"===n||"password"===n){const t="password"===n?m:e.password,s="confirmPassword"===n?m:e.confirmPassword;P(s&&t!==s?"两次输入的密码不一致":"")}});return A?h.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center",children:h.jsxDEV("div",{className:"text-green-400 text-xl animate-pulse font-mono",children:"加载中..."},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:254,columnNumber:9},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:253,columnNumber:7},this):h.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center px-4 py-8",children:[h.jsxDEV("div",{className:"max-w-md w-full space-y-8",children:[h.jsxDEV("div",{className:"text-center",children:[h.jsxDEV("h1",{className:"text-4xl font-bold text-green-400 mb-2 font-mono",children:"工时管理系统"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:266,columnNumber:11},this),h.jsxDEV("p",{className:"text-green-300 text-lg font-mono",children:"TIMETRACK SYSTEM"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:269,columnNumber:11},this),h.jsxDEV("div",{className:"mt-4 h-1 bg-gradient-to-r from-transparent via-green-400 to-transparent"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:272,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:265,columnNumber:9},this),h.jsxDEV("div",{className:"bg-gray-900 border border-green-400 rounded-lg p-8 shadow-lg shadow-green-400/20",children:[h.jsxDEV("h2",{className:"text-2xl font-bold text-green-400 mb-6 text-center font-mono",children:"用户注册"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:277,columnNumber:11},this),d&&h.jsxDEV("div",{className:"mb-4 p-3 bg-red-900/50 border border-red-400 rounded text-red-300 text-sm",children:d},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:282,columnNumber:13},this),h.jsxDEV("form",{onSubmit:t=>c(this,null,function*(){if(t.preventDefault(),l(!0),g(""),!(e.phone&&e.password&&e.id_card&&e.name&&e.company_id&&e.role_id))return g("请填写所有必填字段"),void l(!1);if(T&&!e.production_line)return g("请选择生产线"),void l(!1);if(e.password!==e.confirmPassword)return g("两次输入的密码不一致"),P("两次输入的密码不一致"),void l(!1);if(e.password.length<6)return g("密码长度至少6位"),void l(!1);if(!/^1[3-9]\d{9}$/.test(e.phone))return g("请输入正确的手机号码"),void l(!1);if(!/^[1-9]\d{5}(18|19|20)\d{2}((0[1-9])|(1[0-2]))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/.test(e.id_card))return g("请输入正确的身份证号码"),void l(!1);const s=yield se({phone:e.phone,password:e.password,id_card:e.id_card,name:e.name,company_id:e.company_id,role_id:e.role_id,production_line:T?e.production_line:null});s.success?(g(""),J(!0)):g(s.error||"注册失败"),l(!1)}),className:"space-y-4",children:[h.jsxDEV("div",{children:[h.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-1",children:"手机号码 *"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:290,columnNumber:15},this),h.jsxDEV("div",{className:"relative",children:[h.jsxDEV(p,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:294,columnNumber:17},this),h.jsxDEV("input",{type:"tel",name:"phone",value:e.phone,onChange:re,className:"w-full pl-10 pr-4 py-2 bg-black border border-green-400 rounded text-green-300 placeholder-green-600 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono text-sm",placeholder:"请输入手机号码",maxLength:11},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:295,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:293,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:289,columnNumber:13},this),h.jsxDEV("div",{children:[h.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-1",children:"身份证号 *"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:309,columnNumber:15},this),h.jsxDEV("div",{className:"relative",children:[h.jsxDEV(V,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:313,columnNumber:17},this),h.jsxDEV("input",{type:"text",name:"id_card",value:e.id_card,onChange:re,className:"w-full pl-10 pr-4 py-2 bg-black border border-green-400 rounded text-green-300 placeholder-green-600 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono text-sm",placeholder:"请输入身份证号码",maxLength:18},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:314,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:312,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:308,columnNumber:13},this),h.jsxDEV("div",{children:[h.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-1",children:"姓名 *"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:328,columnNumber:15},this),h.jsxDEV("div",{className:"relative",children:[h.jsxDEV(v,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:332,columnNumber:17},this),h.jsxDEV("input",{type:"text",name:"name",value:e.name,onChange:re,className:"w-full pl-10 pr-4 py-2 bg-black border border-green-400 rounded text-green-300 placeholder-green-600 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono text-sm",placeholder:"请输入真实姓名"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:333,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:331,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:327,columnNumber:13},this),h.jsxDEV("div",{children:[h.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-1",children:"所属公司 *"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:348,columnNumber:15},this),h.jsxDEV("div",{className:"relative company-dropdown",children:[h.jsxDEV(R,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:352,columnNumber:17},this),h.jsxDEV("input",{type:"text",value:$,onChange:e=>{Y(e.target.value),X(!0),e.target.value||t(e=>a(o({},e),{company_id:""}))},onFocus:()=>X(!0),placeholder:"搜索或选择公司",className:"w-full pl-10 pr-4 py-2 bg-black border border-green-400 rounded text-green-300 placeholder-green-600 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono text-sm"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:353,columnNumber:17},this),H&&h.jsxDEV("div",{className:"absolute z-50 w-full mt-1 bg-gray-900 border border-green-400 rounded-md shadow-lg max-h-60 overflow-y-auto",children:[f.filter(e=>e.name.toLowerCase().includes($.toLowerCase())).map(e=>h.jsxDEV("div",{onClick:()=>c(this,null,function*(){Y(e.name),t(t=>a(o({},t),{company_id:e.id})),X(!1),T&&(yield me(e.id),t(e=>a(o({},e),{production_line:""})))}),className:"px-3 py-2 text-green-300 hover:bg-gray-700 cursor-pointer border-b border-gray-600 last:border-b-0 text-sm font-mono",children:e.name},e.id,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:375,columnNumber:23},this)),0===f.filter(e=>e.name.toLowerCase().includes($.toLowerCase())).length&&h.jsxDEV("div",{className:"px-3 py-2 text-gray-400 text-sm font-mono",children:"未找到匹配的公司"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:397,columnNumber:23},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:369,columnNumber:19},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:351,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:347,columnNumber:13},this),h.jsxDEV("div",{children:[h.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-1",children:"用户角色 *"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:408,columnNumber:15},this),h.jsxDEV("div",{className:"relative role-dropdown",children:[h.jsxDEV(k,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:412,columnNumber:17},this),h.jsxDEV("input",{type:"text",value:K,onChange:e=>{Z(e.target.value),ee(!0),e.target.value||(t(e=>a(o({},e),{role_id:""})),q(null),O(!1))},onFocus:()=>ee(!0),placeholder:"搜索或选择角色",className:"w-full pl-10 pr-4 py-2 bg-black border border-green-400 rounded text-green-300 placeholder-green-600 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono text-sm"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:413,columnNumber:17},this),Q&&h.jsxDEV("div",{className:"absolute z-50 w-full mt-1 bg-gray-900 border border-green-400 rounded-md shadow-lg max-h-60 overflow-y-auto",children:[D.filter(e=>e.name.toLowerCase().includes(K.toLowerCase())).map(s=>h.jsxDEV("div",{onClick:()=>c(this,null,function*(){Z(s.name),t(e=>a(o({},e),{role_id:s.id})),q(s),ee(!1);const n="班长"===s.name||"段长"===s.name;O(n),n&&e.company_id&&(yield me(e.company_id)),n||t(e=>a(o({},e),{production_line:""}))}),className:"px-3 py-2 text-green-300 hover:bg-gray-700 cursor-pointer border-b border-gray-600 last:border-b-0 text-sm font-mono",children:s.name},s.id,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:437,columnNumber:23},this)),0===D.filter(e=>e.name.toLowerCase().includes(K.toLowerCase())).length&&h.jsxDEV("div",{className:"px-3 py-2 text-gray-400 text-sm font-mono",children:"未找到匹配的角色"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:467,columnNumber:23},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:431,columnNumber:20},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:411,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:407,columnNumber:13},this),T&&h.jsxDEV("div",{children:[h.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-1",children:"生产线 *"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:479,columnNumber:17},this),h.jsxDEV("div",{className:"relative production-line-dropdown",children:[h.jsxDEV(S,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:483,columnNumber:19},this),h.jsxDEV("input",{type:"text",value:e.production_line,onChange:e=>{B(e.target.value),t(t=>a(o({},t),{production_line:e.target.value})),U(!0)},onFocus:()=>U(!0),placeholder:"搜索或选择生产线",className:"w-full pl-10 pr-4 py-2 bg-black border border-green-400 rounded text-green-300 placeholder-green-600 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono text-sm"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:484,columnNumber:19},this),G&&h.jsxDEV("div",{className:"absolute z-50 w-full mt-1 bg-gray-900 border border-green-400 rounded-md shadow-lg max-h-60 overflow-y-auto",children:[C.filter(t=>{const s=(e.production_line||"").trim();return!s||t.toLowerCase().includes(s.toLowerCase())}).map(e=>h.jsxDEV("div",{onClick:()=>{t(t=>a(o({},t),{production_line:e})),B(""),U(!1)},className:"px-3 py-2 text-green-300 hover:bg-gray-700 cursor-pointer border-b border-gray-600 last:border-b-0 text-sm font-mono",children:e},e,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:507,columnNumber:25},this)),0===C.filter(t=>{const s=(e.production_line||"").trim();return!s||t.toLowerCase().includes(s.toLowerCase())}).length&&h.jsxDEV("div",{className:"px-3 py-2 text-gray-400 text-sm font-mono",children:"未找到匹配的生产线"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:524,columnNumber:25},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:497,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:482,columnNumber:17},this),0===C.length&&e.company_id&&h.jsxDEV("div",{className:"mt-1 text-yellow-400 text-xs font-mono",children:"该公司暂无可用生产线"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:532,columnNumber:19},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:478,columnNumber:15},this),h.jsxDEV("div",{children:[h.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-1",children:"登录密码 *"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:541,columnNumber:15},this),h.jsxDEV("div",{className:"relative",children:[h.jsxDEV(b,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:545,columnNumber:17},this),h.jsxDEV("input",{type:s?"text":"password",name:"password",value:e.password,onChange:re,className:"w-full pl-10 pr-10 py-2 bg-black border border-green-400 rounded text-green-300 placeholder-green-600 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono text-sm",placeholder:"请输入密码（至少6位）"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:546,columnNumber:17},this),h.jsxDEV("button",{type:"button",onClick:()=>n(!s),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-green-400 hover:text-green-300",children:s?h.jsxDEV(y,{className:"w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:559,columnNumber:35},this):h.jsxDEV(x,{className:"w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:559,columnNumber:68},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:554,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:544,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:540,columnNumber:13},this),h.jsxDEV("div",{children:[h.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-1",children:"确认密码 *"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:566,columnNumber:15},this),h.jsxDEV("div",{className:"relative",children:[h.jsxDEV(b,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:570,columnNumber:17},this),h.jsxDEV("input",{type:m?"text":"password",name:"confirmPassword",value:e.confirmPassword,onChange:re,className:"w-full pl-10 pr-10 py-2 bg-black border rounded text-green-300 placeholder-green-600 focus:outline-none focus:ring-1 font-mono text-sm "+(_?"border-red-400 focus:border-red-300 focus:ring-red-300":"border-green-400 focus:border-green-300 focus:ring-green-300"),placeholder:"请再次输入密码"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:571,columnNumber:17},this),h.jsxDEV("button",{type:"button",onClick:()=>r(!m),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-green-400 hover:text-green-300",children:m?h.jsxDEV(y,{className:"w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:586,columnNumber:42},this):h.jsxDEV(x,{className:"w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:586,columnNumber:75},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:581,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:569,columnNumber:15},this),_&&h.jsxDEV("div",{className:"mt-1 text-red-400 text-xs font-mono",children:_},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:590,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:565,columnNumber:13},this),h.jsxDEV("button",{type:"submit",disabled:i,className:"w-full py-3 bg-green-600 hover:bg-green-500 disabled:bg-green-800 text-black font-bold rounded-lg transition-colors duration-200 font-mono text-lg mt-6",children:i?"注册中...":"注册"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:597,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:287,columnNumber:11},this),h.jsxDEV("div",{className:"mt-6 text-center",children:h.jsxDEV(w,{to:"/login",className:"text-green-400 hover:text-green-300 text-sm font-mono transition-colors",children:"已有账号？立即登录"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:608,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:607,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:276,columnNumber:9},this),h.jsxDEV("div",{className:"text-center text-green-600 text-xs font-mono",children:h.jsxDEV("p",{children:"© 2024 工时管理系统. All rights reserved."},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:619,columnNumber:11},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:618,columnNumber:9},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:263,columnNumber:7},this),h.jsxDEV(ie,{isOpen:F,onClose:()=>{J(!1),ne("/login")},userName:e.name,userPhone:e.phone},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:624,columnNumber:7},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Register.tsx",lineNumber:262,columnNumber:5},this)}function ae(){const[e,t]=u.useState("verify"),[s,n]=u.useState({id_card:"",newPassword:"",confirmPassword:""}),[m,r]=u.useState(!1),[i,l]=u.useState(!1),[d,g]=u.useState(!1),[p,f]=u.useState(""),[v,E]=u.useState(""),[k,D]=u.useState(null),{resetPassword:j}=te(),R=N(),S=e=>{const{name:t,value:m}=e.target;if(n(e=>a(o({},e),{[t]:m})),"confirmPassword"===t||"newPassword"===t){const e="newPassword"===t?m:s.newPassword,n="confirmPassword"===t?m:s.confirmPassword;E(n&&e!==n?"两次输入的密码不一致":"")}};return h.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center px-4",children:h.jsxDEV("div",{className:"max-w-md w-full space-y-8",children:[h.jsxDEV("div",{className:"text-center",children:[h.jsxDEV("h1",{className:"text-4xl font-bold text-green-400 mb-2 font-mono",children:"工时管理系统"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:124,columnNumber:11},this),h.jsxDEV("p",{className:"text-green-300 text-lg font-mono",children:"TIMETRACK SYSTEM"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:127,columnNumber:11},this),h.jsxDEV("div",{className:"mt-4 h-1 bg-gradient-to-r from-transparent via-green-400 to-transparent"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:130,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:123,columnNumber:9},this),h.jsxDEV("div",{className:"bg-gray-900 border border-green-400 rounded-lg p-8 shadow-lg shadow-green-400/20",children:[h.jsxDEV("div",{className:"flex items-center mb-6",children:[h.jsxDEV("button",{onClick:()=>{"reset"===e?(t("verify"),D(null),f("")):R("/login")},className:"text-green-400 hover:text-green-300 mr-3 transition-colors",children:h.jsxDEV(_,{className:"w-5 h-5"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:140,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:136,columnNumber:13},this),h.jsxDEV("h2",{className:"text-2xl font-bold text-green-400 font-mono",children:"verify"===e?"身份验证":"重置密码"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:142,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:135,columnNumber:11},this),p&&h.jsxDEV("div",{className:"mb-4 p-3 bg-red-900/50 border border-red-400 rounded text-red-300 text-sm",children:p},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:148,columnNumber:13},this),"verify"===e?h.jsxDEV("form",{onSubmit:e=>c(this,null,function*(){if(e.preventDefault(),g(!0),f(""),!s.id_card)return f("请输入身份证号码"),void g(!1);if(!/^[1-9]\d{5}(18|19|20)\d{2}((0[1-9])|(1[0-2]))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/.test(s.id_card))return f("请输入正确的身份证号码"),void g(!1);const n=yield j(s.id_card);n.success&&n.user?(D(n.user),t("reset"),f("")):f(n.error||"身份证号码验证失败，请检查后重试"),g(!1)}),className:"space-y-6",children:[h.jsxDEV("div",{className:"text-center mb-6",children:h.jsxDEV("p",{className:"text-green-300 text-sm font-mono",children:"请输入您的身份证号码进行身份验证"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:156,columnNumber:17},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:155,columnNumber:15},this),h.jsxDEV("div",{children:[h.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-2",children:"身份证号码"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:163,columnNumber:17},this),h.jsxDEV("div",{className:"relative",children:[h.jsxDEV(V,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-5 h-5"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:167,columnNumber:19},this),h.jsxDEV("input",{type:"text",name:"id_card",value:s.id_card,onChange:S,className:"w-full pl-12 pr-4 py-3 bg-black border border-green-400 rounded text-green-300 placeholder-green-600 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono",placeholder:"请输入身份证号码",maxLength:18},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:168,columnNumber:19},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:166,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:162,columnNumber:15},this),h.jsxDEV("button",{type:"submit",disabled:d,className:"w-full py-3 bg-green-600 hover:bg-green-500 disabled:bg-green-800 text-black font-bold rounded-lg transition-colors duration-200 font-mono text-lg",children:d?"验证中...":"验证身份"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:181,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:154,columnNumber:13},this):h.jsxDEV("form",{onSubmit:e=>c(this,null,function*(){if(e.preventDefault(),g(!0),f(""),!s.newPassword||!s.confirmPassword)return f("请填写新密码和确认密码"),void g(!1);if(s.newPassword!==s.confirmPassword)return f("两次输入的密码不一致"),E("两次输入的密码不一致"),void g(!1);if(s.newPassword.length<6)return f("密码长度至少6位"),void g(!1);const t=yield j(s.id_card,s.newPassword);t.success?(alert("密码重置成功，请使用新密码登录"),R("/login")):f(t.error||"密码重置失败"),g(!1)}),className:"space-y-6",children:[k&&h.jsxDEV("div",{className:"bg-green-900/30 border border-green-400 rounded p-4 mb-6",children:[h.jsxDEV("p",{className:"text-green-300 text-sm font-mono",children:["验证成功！正在为用户 ",h.jsxDEV("span",{className:"text-green-400 font-bold",children:k.name},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:194,columnNumber:32},this)," 重置密码"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:193,columnNumber:19},this),h.jsxDEV("p",{className:"text-green-400 text-xs font-mono mt-1",children:["手机号: ",k.phone]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:196,columnNumber:19},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:192,columnNumber:17},this),h.jsxDEV("div",{children:[h.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-2",children:"新密码"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:204,columnNumber:17},this),h.jsxDEV("div",{className:"relative",children:[h.jsxDEV(b,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-5 h-5"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:208,columnNumber:19},this),h.jsxDEV("input",{type:m?"text":"password",name:"newPassword",value:s.newPassword,onChange:S,className:"w-full pl-12 pr-12 py-3 bg-black border border-green-400 rounded text-green-300 placeholder-green-600 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono",placeholder:"请输入新密码（至少6位）"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:209,columnNumber:19},this),h.jsxDEV("button",{type:"button",onClick:()=>r(!m),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-green-400 hover:text-green-300",children:m?h.jsxDEV(y,{className:"w-5 h-5"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:222,columnNumber:37},this):h.jsxDEV(x,{className:"w-5 h-5"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:222,columnNumber:70},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:217,columnNumber:19},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:207,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:203,columnNumber:15},this),h.jsxDEV("div",{children:[h.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-2",children:"确认新密码"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:229,columnNumber:17},this),h.jsxDEV("div",{className:"relative",children:[h.jsxDEV(b,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-5 h-5"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:233,columnNumber:19},this),h.jsxDEV("input",{type:i?"text":"password",name:"confirmPassword",value:s.confirmPassword,onChange:S,className:"w-full pl-12 pr-12 py-3 bg-black border rounded text-green-300 placeholder-green-600 focus:outline-none focus:ring-1 font-mono "+(v?"border-red-400 focus:border-red-300 focus:ring-red-300":"border-green-400 focus:border-green-300 focus:ring-green-300"),placeholder:"请再次输入新密码"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:234,columnNumber:19},this),h.jsxDEV("button",{type:"button",onClick:()=>l(!i),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-green-400 hover:text-green-300",children:i?h.jsxDEV(y,{className:"w-5 h-5"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:249,columnNumber:44},this):h.jsxDEV(x,{className:"w-5 h-5"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:249,columnNumber:77},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:244,columnNumber:19},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:232,columnNumber:17},this),v&&h.jsxDEV("div",{className:"mt-1 text-red-400 text-xs font-mono",children:v},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:253,columnNumber:19},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:228,columnNumber:15},this),h.jsxDEV("button",{type:"submit",disabled:d,className:"w-full py-3 bg-green-600 hover:bg-green-500 disabled:bg-green-800 text-black font-bold rounded-lg transition-colors duration-200 font-mono text-lg",children:d?"重置中...":"重置密码"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:260,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:190,columnNumber:13},this),h.jsxDEV("div",{className:"mt-6 text-center",children:h.jsxDEV(w,{to:"/login",className:"text-green-400 hover:text-green-300 text-sm font-mono transition-colors",children:"返回登录"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:272,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:271,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:134,columnNumber:9},this),h.jsxDEV("div",{className:"text-center text-green-600 text-xs font-mono",children:h.jsxDEV("p",{children:"© 2024 工时管理系统. All rights reserved."},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:283,columnNumber:11},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:282,columnNumber:9},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:121,columnNumber:7},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ResetPassword.tsx",lineNumber:120,columnNumber:5},this)}const le=u.lazy(()=>T(()=>import("./Dashboard-i1CnOG7R.js"),__vite__mapDeps([0,1,2,3,4,5]))),ce=u.lazy(()=>T(()=>import("./TimesheetRecord-agVQD3vY.js"),__vite__mapDeps([6,1,2,5,4]))),ue=u.lazy(()=>T(()=>import("./TimesheetHistory-BXA1O3Ab.js"),__vite__mapDeps([7,1,2,5,4]))),he=u.lazy(()=>T(()=>import("./CompanyManagement-CVk5owa0.js"),__vite__mapDeps([8,1,2,3,4,5]))),de=u.lazy(()=>T(()=>import("./UserManagement-vPPQ1ncq.js"),__vite__mapDeps([9,1,2,5,10,4]))),ge=u.lazy(()=>T(()=>import("./ProcessManagement-Cmqao3Md.js"),__vite__mapDeps([11,1,2,5,12,10,4]))),Ne=u.lazy(()=>T(()=>import("./RoleList-LH6xm066.js"),__vite__mapDeps([13,1,2,4,5]))),pe=u.lazy(()=>T(()=>import("./RoleEdit-CltqzvBa.js"),__vite__mapDeps([14,1,2,4,5]))),be=u.lazy(()=>T(()=>import("./RoleCreate-BH3l902D.js"),__vite__mapDeps([15,1,2,4,5]))),ye=u.lazy(()=>T(()=>import("./SupervisorApproval-DNVTcrg8.js"),__vite__mapDeps([16,1,2,5,4]))),xe=u.lazy(()=>T(()=>import("./SectionChiefApproval-DOkgBdhY.js"),__vite__mapDeps([17,1,2,5,4]))),fe=u.lazy(()=>T(()=>import("./Reports-Bg2HCkWp.js"),__vite__mapDeps([18,4,1,2,5]))),ve=u.lazy(()=>T(()=>import("./History-DJ9J3S3c.js"),__vite__mapDeps([19,1,2,5,4]))),we=u.lazy(()=>T(()=>import("./ToastTest-BDOXtG0N.js"),__vite__mapDeps([20,1,2,5]))),Ee=u.lazy(()=>T(()=>import("./LazyLoadTest-CDAZx7fT.js"),__vite__mapDeps([21,4,1,2]))),ke=()=>h.jsxDEV("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",children:h.jsxDEV("div",{className:"text-center p-8 bg-white rounded-lg shadow-lg max-w-md mx-4",children:[h.jsxDEV("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:49,columnNumber:9},void 0),h.jsxDEV("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"工时管理系统"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:50,columnNumber:9},void 0),h.jsxDEV("p",{className:"text-gray-600",children:"正在加载..."},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:51,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:48,columnNumber:7},void 0)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:47,columnNumber:5},void 0);class De extends u.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("应用错误边界捕获到错误:",e,t),this.setState({error:e,errorInfo:t})}render(){var e;return this.state.hasError?h.jsxDEV("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-50 px-4",children:h.jsxDEV("div",{className:"max-w-md text-center",children:[h.jsxDEV("div",{className:"mb-6",children:[h.jsxDEV("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:h.jsxDEV("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 18.5c-.77.833.192 2.5 1.732 2.5z"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:90,columnNumber:19},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:89,columnNumber:17},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:88,columnNumber:15},this),h.jsxDEV("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"应用出现错误"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:93,columnNumber:15},this),h.jsxDEV("p",{className:"text-gray-600 mb-6",children:"抱歉，应用遇到了一个意外错误。请尝试刷新页面或稍后再试。"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:94,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:87,columnNumber:13},this),h.jsxDEV("div",{className:"space-y-3",children:[h.jsxDEV("button",{onClick:()=>window.location.reload(),className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"刷新页面"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:100,columnNumber:15},this),h.jsxDEV("button",{onClick:()=>this.setState({hasError:!1}),className:"w-full px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors",children:"重试"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:106,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:99,columnNumber:13},this),this.state.error&&h.jsxDEV("details",{className:"mt-6 text-left",children:[h.jsxDEV("summary",{className:"cursor-pointer text-sm text-gray-500 hover:text-gray-700",children:"查看错误详情"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:117,columnNumber:17},this),h.jsxDEV("pre",{className:"mt-2 p-3 bg-gray-100 rounded text-xs overflow-auto max-h-40",children:[this.state.error.toString(),null==(e=this.state.errorInfo)?void 0:e.componentStack]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:120,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:116,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:86,columnNumber:11},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:85,columnNumber:9},this):this.props.children}}const je=({children:e})=>h.jsxDEV(u.Suspense,{fallback:h.jsxDEV(ke,{},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:198,columnNumber:25},void 0),children:h.jsxDEV(De,{children:e},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:199,columnNumber:7},void 0)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:198,columnNumber:5},void 0);function Ve(){u.useEffect(()=>{"requestIdleCallback"in window?requestIdleCallback(()=>{var e,t;null==(e=le.preload)||e.call(le),null==(t=ce.preload)||t.call(ce)},{timeout:1e3}):setTimeout(()=>{var e,t;null==(e=le.preload)||e.call(le),null==(t=ce.preload)||t.call(ce)},1e3),"requestIdleCallback"in window?requestIdleCallback(()=>{var e,t,s;null==(e=ue.preload)||e.call(ue),null==(t=he.preload)||t.call(he),null==(s=de.preload)||s.call(de)},{timeout:3e3}):setTimeout(()=>{var e,t,s;null==(e=ue.preload)||e.call(ue),null==(t=he.preload)||t.call(he),null==(s=de.preload)||s.call(de)},3e3),"requestIdleCallback"in window?requestIdleCallback(()=>{var e,t,s;null==(e=ge.preload)||e.call(ge),null==(t=ye.preload)||t.call(ye),null==(s=xe.preload)||s.call(xe)},{timeout:5e3}):setTimeout(()=>{var e,t,s;null==(e=ge.preload)||e.call(ge),null==(t=ye.preload)||t.call(ye),null==(s=xe.preload)||s.call(xe)},5e3),"requestIdleCallback"in window&&requestIdleCallback(()=>{var e,t;const s=navigator.connection;s&&"4g"===s.effectiveType&&(null==(e=fe.preload)||e.call(fe),null==(t=ve.preload)||t.call(ve))},{timeout:15e3})},[]);return h.jsxDEV(De,{children:h.jsxDEV(ee,{children:[h.jsxDEV(P,{basename:"",children:h.jsxDEV(A,{children:[h.jsxDEV(L,{path:"/login",element:h.jsxDEV(re,{},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:221,columnNumber:41},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:221,columnNumber:11},this),h.jsxDEV(L,{path:"/register",element:h.jsxDEV(oe,{},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:222,columnNumber:44},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:222,columnNumber:11},this),h.jsxDEV(L,{path:"/reset-password",element:h.jsxDEV(ae,{},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:223,columnNumber:50},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:223,columnNumber:11},this),h.jsxDEV(L,{path:"/",element:h.jsxDEV(se,{children:h.jsxDEV(g,{to:"/dashboard",replace:!0},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:228,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:227,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:226,columnNumber:11},this),h.jsxDEV(L,{path:"/dashboard",element:h.jsxDEV(se,{children:h.jsxDEV(je,{children:h.jsxDEV(le,{},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:233,columnNumber:28},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:233,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:232,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:231,columnNumber:11},this),h.jsxDEV(L,{path:"/company-management",element:h.jsxDEV(se,{children:h.jsxDEV(je,{children:h.jsxDEV(he,{},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:238,columnNumber:28},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:238,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:237,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:236,columnNumber:11},this),h.jsxDEV(L,{path:"/user-management",element:h.jsxDEV(se,{children:h.jsxDEV(je,{children:h.jsxDEV(de,{},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:243,columnNumber:28},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:243,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:242,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:241,columnNumber:11},this),h.jsxDEV(L,{path:"/role-permissions",element:h.jsxDEV(se,{children:h.jsxDEV(je,{children:h.jsxDEV(Ne,{},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:248,columnNumber:28},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:248,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:247,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:246,columnNumber:11},this),h.jsxDEV(L,{path:"/role-permissions/edit/:id",element:h.jsxDEV(se,{children:h.jsxDEV(je,{children:h.jsxDEV(pe,{},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:254,columnNumber:28},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:254,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:253,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:252,columnNumber:11},this),h.jsxDEV(L,{path:"/role-permissions/create",element:h.jsxDEV(se,{children:h.jsxDEV(je,{children:h.jsxDEV(be,{},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:259,columnNumber:28},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:259,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:258,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:257,columnNumber:11},this),h.jsxDEV(L,{path:"/process-management",element:h.jsxDEV(se,{children:h.jsxDEV(je,{children:h.jsxDEV(ge,{},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:264,columnNumber:28},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:264,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:263,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:262,columnNumber:11},this),h.jsxDEV(L,{path:"/timesheet-record",element:h.jsxDEV(se,{children:h.jsxDEV(je,{children:h.jsxDEV(ce,{},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:269,columnNumber:28},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:269,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:268,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:267,columnNumber:11},this),h.jsxDEV(L,{path:"/timesheet-history",element:h.jsxDEV(se,{children:h.jsxDEV(je,{children:h.jsxDEV(ue,{},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:274,columnNumber:28},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:274,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:273,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:272,columnNumber:11},this),h.jsxDEV(L,{path:"/supervisor-approval",element:h.jsxDEV(ne,{allowedRoles:["班长","supervisor","超级管理员","super_admin"],children:h.jsxDEV(je,{children:h.jsxDEV(ye,{},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:279,columnNumber:28},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:279,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:278,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:277,columnNumber:11},this),h.jsxDEV(L,{path:"/section-chief-approval",element:h.jsxDEV(ne,{allowedRoles:["段长","section_chief","超级管理员","super_admin"],children:h.jsxDEV(je,{children:h.jsxDEV(xe,{},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:284,columnNumber:28},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:284,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:283,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:282,columnNumber:11},this),h.jsxDEV(L,{path:"/reports",element:h.jsxDEV(se,{children:h.jsxDEV(je,{children:h.jsxDEV(fe,{},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:289,columnNumber:28},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:289,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:288,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:287,columnNumber:11},this),h.jsxDEV(L,{path:"/history",element:h.jsxDEV(se,{children:h.jsxDEV(je,{children:h.jsxDEV(ve,{},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:294,columnNumber:28},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:294,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:293,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:292,columnNumber:11},this),h.jsxDEV(L,{path:"/toast-test",element:h.jsxDEV(se,{children:h.jsxDEV(je,{children:h.jsxDEV(we,{},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:299,columnNumber:28},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:299,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:298,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:297,columnNumber:11},this),h.jsxDEV(L,{path:"/lazy-test",element:h.jsxDEV(se,{children:h.jsxDEV(je,{children:h.jsxDEV(Ee,{},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:304,columnNumber:28},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:304,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:303,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:302,columnNumber:11},this),h.jsxDEV(L,{path:"*",element:h.jsxDEV(g,{to:"/dashboard",replace:!0},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:311,columnNumber:36},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:311,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:219,columnNumber:11},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:218,columnNumber:9},this),h.jsxDEV(me,{},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:316,columnNumber:31},this),h.jsxDEV(O,{position:"top-right",richColors:!0},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:319,columnNumber:7},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:217,columnNumber:7},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/App.tsx",lineNumber:216,columnNumber:5},this)}Array.from||(Array.from=function(){const e=Object.prototype.toString,t=function(t){return"function"==typeof t||"[object Function]"===e.call(t)},s=Math.pow(2,53)-1,n=function(e){const t=function(e){const t=Number(e);return isNaN(t)?0:0!==t&&isFinite(t)?(t>0?1:-1)*Math.floor(Math.abs(t)):t}(e);return Math.min(Math.max(t,0),s)};return function(e,s,m){const r=Object(e);if(null==e)throw new TypeError("Array.from requires an array-like object - not null or undefined");const i=void 0===s?void 0:s;if(void 0!==i){if(!t(i))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(m=arguments[2])}const o=n(r.length),a=t(this)?Object(new this(o)):new Array(o);let l,c=0;for(;c<o;)l=r[c],a[c]=i?void 0===m?i(l,c):i.call(m,l,c):l,c+=1;return a.length=o,a}}()),Array.prototype.includes||(Array.prototype.includes=function(e,t){if(null==this)throw new TypeError("Array.prototype.includes called on null or undefined");const s=Object(this),n=parseInt(s.length)||0;if(0===n)return!1;const m=parseInt(t)||0;let r,i;for(m>=0?r=m:(r=n+m,r<0&&(r=0));r<n;){if(i=s[r],e===i||e!=e&&i!=i)return!0;r++}return!1}),String.prototype.includes||(String.prototype.includes=function(e,t){return"number"!=typeof t&&(t=0),!(t+e.length>this.length)&&-1!==this.indexOf(e,t)}),String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.substr(t,e.length)===e}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){return(void 0===t||t>this.length)&&(t=this.length),this.substring(t-e.length,t)===e}),"function"!=typeof Object.assign&&(Object.assign=function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");const t=Object(e),s=Array.prototype.slice.call(arguments,1);for(let n=0;n<s.length;n++){const e=s[n];if(null!=e)for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t}),"undefined"==typeof Promise&&(window.Promise=class e{constructor(e){l(this,"state","pending"),l(this,"value"),l(this,"handlers",[]);try{e(this.resolve.bind(this),this.reject.bind(this))}catch(t){this.reject(t)}}resolve(e){"pending"===this.state&&(this.state="fulfilled",this.value=e,this.handlers.forEach(e=>this.handle(e)),this.handlers=[])}reject(e){"pending"===this.state&&(this.state="rejected",this.value=e,this.handlers.forEach(e=>this.handle(e)),this.handlers=[])}handle(e){"pending"===this.state?this.handlers.push(e):("fulfilled"===this.state&&"function"==typeof e.onFulfilled&&e.onFulfilled(this.value),"rejected"===this.state&&"function"==typeof e.onRejected&&e.onRejected(this.value))}then(t,s){return new e((e,n)=>{this.handle({onFulfilled:s=>{if("function"==typeof t)try{e(t(s))}catch(m){n(m)}else e(s)},onRejected:t=>{if("function"==typeof s)try{e(s(t))}catch(m){n(m)}else n(t)},resolve:e,reject:n})})}catch(e){return this.then(void 0,e)}static resolve(t){return new e(e=>e(t))}static reject(t){return new e((e,s)=>s(t))}static all(t){return new e((e,s)=>{if(0===t.length)return void e([]);const n=[];let m=0;t.forEach((r,i)=>{r.then(s=>{n[i]=s,m++,m===t.length&&e(n)}).catch(s)})})}}),"undefined"==typeof fetch&&(window.fetch=function(e,t={}){return new Promise((s,n)=>{const m=new XMLHttpRequest;m.open(t.method||"GET",e),t.headers&&Object.keys(t.headers).forEach(e=>{m.setRequestHeader(e,t.headers[e])}),m.onload=()=>{const e={ok:m.status>=200&&m.status<300,status:m.status,statusText:m.statusText,json:()=>Promise.resolve(JSON.parse(m.responseText)),text:()=>Promise.resolve(m.responseText)};s(e)},m.onerror=()=>n(new Error("Network error")),m.send(t.body)})}),"undefined"==typeof IntersectionObserver&&(window.IntersectionObserver=class{constructor(e,t={}){l(this,"callback"),l(this,"options"),l(this,"targets",[]),this.callback=e,this.options=t,setTimeout(()=>{this.checkIntersections()},100)}observe(e){this.targets.push(e)}unobserve(e){const t=this.targets.indexOf(e);t>-1&&this.targets.splice(t,1)}disconnect(){this.targets=[]}checkIntersections(){const e=this.targets.map(e=>({target:e,isIntersecting:!0,intersectionRatio:1}));e.length>0&&this.callback(e)}});const Re=()=>{if(/iPhone|iPad|iPod/.test(navigator.userAgent)){const e=()=>{const e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",`${e}px`)};e(),window.addEventListener("resize",e),window.addEventListener("orientationchange",()=>{setTimeout(e,100)})}/Android/.test(navigator.userAgent)&&document.addEventListener("touchstart",()=>{},{passive:!0}),"undefined"==typeof console&&(window.console={log:()=>{},warn:()=>{},error:()=>{},info:()=>{},debug:()=>{}}),window.requestAnimationFrame||(window.requestAnimationFrame=e=>window.setTimeout(e,1e3/60)),window.cancelAnimationFrame||(window.cancelAnimationFrame=e=>{clearTimeout(e)})},Se=()=>{const e={es6:!0,fetch:"undefined"!=typeof fetch,promise:"undefined"!=typeof Promise,intersectionObserver:"undefined"!=typeof IntersectionObserver,serviceWorker:"serviceWorker"in navigator,localStorage:(()=>{try{return localStorage.setItem("test","test"),localStorage.removeItem("test"),!0}catch(e){return!1}})(),flexbox:CSS.supports("display","flex"),grid:CSS.supports("display","grid")};return console.log("浏览器兼容性检测结果:",e),e};const _e=new class{constructor(){this.isMobile=this.detectMobileDevice(),this.networkType=this.getNetworkType(),this.isLowEndDevice=this.detectLowEndDevice(),this.optimizationLevel=this.calculateOptimizationLevel(),this.init()}detectMobileDevice(){const e=navigator.userAgent.toLowerCase();return["mobile","android","iphone","ipad","ipod","blackberry","windows phone","opera mini"].some(t=>e.includes(t))||window.innerWidth<=768||"ontouchstart"in window}getNetworkType(){const e=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return e?{type:e.effectiveType||"unknown",downlink:e.downlink||0,rtt:e.rtt||0,saveData:e.saveData||!1}:"unknown"}detectLowEndDevice(){const e=navigator.hardwareConcurrency||1,t=navigator.deviceMemory||1,s=navigator.userAgent.toLowerCase(),n=["android 4","android 5","android 6"].some(e=>s.includes(e));return e<=2||t<=2||n}calculateOptimizationLevel(){let e=0;return"slow-2g"===this.networkType.type||"2g"===this.networkType.type?e+=3:"3g"===this.networkType.type?e+=2:"4g"===this.networkType.type&&(e+=1),this.isLowEndDevice&&(e+=2),this.networkType.saveData&&(e+=2),Math.min(e,5)}init(){this.isMobile&&(console.log("🔧 Initializing mobile optimization:",{level:this.optimizationLevel,networkType:this.networkType.type,isLowEnd:this.isLowEndDevice}),this.applyOptimizations(),this.setupNetworkListeners())}applyOptimizations(){switch(this.optimizationLevel){case 5:this.enableAggressiveOptimization();break;case 4:this.enableHighOptimization();break;case 3:this.enableMediumOptimization();break;case 2:this.enableLowOptimization();break;default:this.enableBasicOptimization()}}enableAggressiveOptimization(){this.disableNonCriticalFeatures(),this.minimizeResourceLoading(),this.enableTextCompression(),this.enableLazyLoading(),console.log("📱 Aggressive optimization enabled")}enableHighOptimization(){this.minimizeResourceLoading(),this.enableLazyLoading(),this.optimizeImages(),console.log("📱 High optimization enabled")}enableMediumOptimization(){this.enableLazyLoading(),this.optimizeImages(),console.log("📱 Medium optimization enabled")}enableLowOptimization(){this.optimizeImages(),console.log("📱 Low optimization enabled")}enableBasicOptimization(){this.setupViewport(),console.log("📱 Basic optimization enabled")}disableNonCriticalFeatures(){const e=document.createElement("style");e.textContent="\n            *, *::before, *::after {\n                animation-duration: 0.01ms !important;\n                animation-iteration-count: 1 !important;\n                transition-duration: 0.01ms !important;\n            }\n        ",document.head.appendChild(e),document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("video").forEach(e=>{e.autoplay=!1,e.preload="none"})})}minimizeResourceLoading(){document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll('link[rel="stylesheet"]').forEach(e=>{e.href.includes("critical")||e.href.includes("main")||(e.media="print",e.onload=function(){this.media="all"})})})}enableTextCompression(){"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(e=>{var t;null==(t=e.active)||t.postMessage({type:"ENABLE_COMPRESSION",level:"aggressive"})})}enableLazyLoading(){if("IntersectionObserver"in window){const e=new IntersectionObserver(t=>{t.forEach(t=>{if(t.isIntersecting){const s=t.target;s.dataset.src&&(s.src=s.dataset.src,s.removeAttribute("data-src"),e.unobserve(s))}})});document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("img[data-src]").forEach(t=>e.observe(t))})}}optimizeImages(){document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("img").forEach(e=>{if(e.hasAttribute("loading")||(e.loading="lazy"),window.devicePixelRatio>1){const t=Math.min(e.naturalWidth,window.innerWidth);e.style.maxWidth=t+"px"}})})}setupViewport(){let e=document.querySelector('meta[name="viewport"]');e||(e=document.createElement("meta"),e.name="viewport",document.head.appendChild(e)),e.content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"}setupNetworkListeners(){"connection"in navigator&&navigator.connection.addEventListener("change",()=>{this.networkType=this.getNetworkType(),this.optimizationLevel=this.calculateOptimizationLevel(),this.applyOptimizations(),console.log("📱 Network changed, reapplying optimizations:",{type:this.networkType.type,level:this.optimizationLevel})}),window.addEventListener("online",()=>{console.log("📱 Device back online"),this.handleOnlineStatus(!0)}),window.addEventListener("offline",()=>{console.log("📱 Device went offline"),this.handleOnlineStatus(!1)})}handleOnlineStatus(e){e?this.restoreFeatures():this.enableOfflineMode()}restoreFeatures(){document.querySelectorAll("[data-mobile-disabled]").forEach(e=>{e.removeAttribute("data-mobile-disabled"),e.style.display=""})}enableOfflineMode(){document.querySelectorAll("[data-requires-network]").forEach(e=>{e.setAttribute("data-mobile-disabled","true"),e.style.display="none"}),this.showOfflineNotification()}showOfflineNotification(){const e=document.createElement("div");e.className="mobile-offline-notification",e.innerHTML='\n            <div class="offline-content">\n                📱 离线模式已启用\n                <button onclick="this.parentElement.parentElement.remove()">×</button>\n            </div>\n        ',e.style.cssText="\n            position: fixed;\n            top: 0;\n            left: 0;\n            right: 0;\n            background: #ff9800;\n            color: white;\n            padding: 10px;\n            text-align: center;\n            z-index: 10000;\n            font-size: 14px;\n        ",document.body.appendChild(e),setTimeout(()=>{e.parentElement&&e.remove()},5e3)}getOptimizationRecommendations(){const e=[];return"slow-2g"!==this.networkType.type&&"2g"!==this.networkType.type||e.push("检测到慢速网络，建议切换到WiFi或移动到信号更好的位置"),this.isLowEndDevice&&e.push("检测到低端设备，已启用性能优化模式"),this.networkType.saveData&&e.push("检测到数据节省模式，已减少资源加载"),this.isMobile&&window.innerWidth<400&&e.push("屏幕较小，建议横屏使用以获得更好体验"),e}getStatus(){return{isMobile:this.isMobile,networkType:this.networkType,isLowEndDevice:this.isLowEndDevice,optimizationLevel:this.optimizationLevel,recommendations:this.getOptimizationRecommendations()}}};const Pe=new class{constructor(){l(this,"loadingState",{isLoading:!1,progress:0,retryCount:0}),l(this,"maxRetries",3),l(this,"baseTimeout",15e3),l(this,"isMobile"),l(this,"connectionType"),l(this,"loadQueue",[]),l(this,"loadedResources",new Set),this.isMobile=this.detectMobileDevice(),this.connectionType=this.getConnectionType(),this.setupProgressiveLoading()}detectMobileDevice(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768}getConnectionType(){const e=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return e&&e.effectiveType||"unknown"}setupProgressiveLoading(){if(!this.isMobile)return;["slow-2g","2g","3g"].includes(this.connectionType)?(this.maxRetries=5,this.baseTimeout=3e4):(this.maxRetries=3,this.baseTimeout=1e4),window.addEventListener("online",()=>{this.retryFailedLoads()}),document.addEventListener("visibilitychange",()=>{!document.hidden&&this.loadingState.error&&this.retryFailedLoads()})}preloadCriticalResources(){return c(this,null,function*(){if(!this.isMobile)return;console.log("📱 开始预加载关键资源...");const e=[{url:"/src/main.tsx",type:"script",priority:"critical",timeout:this.baseTimeout},{url:"/src/App.tsx",type:"script",priority:"critical",timeout:this.baseTimeout}];yield this.loadResourcesInBatches(e,2)})}loadResourcesInBatches(e,t){return c(this,null,function*(){this.loadingState.isLoading=!0,this.loadingState.progress=0,this.loadingState.error=void 0;const s=e.length;let n=0;for(let r=0;r<e.length;r+=t){const i=e.slice(r,r+t);try{yield Promise.all(i.map(e=>this.loadSingleResource(e))),n+=i.length,this.loadingState.progress=n/s*100,r+t<e.length&&(yield this.delay(100))}catch(m){if(console.warn("📱 批次加载失败:",m),this.loadingState.error=`加载失败: ${m}`,this.loadingState.retryCount<this.maxRetries){this.loadingState.retryCount++,console.log(`📱 重试第 ${this.loadingState.retryCount} 次...`),yield this.delay(1e3*this.loadingState.retryCount),r-=t;continue}throw m}}this.loadingState.isLoading=!1,this.loadingState.progress=100,console.log("📱 资源预加载完成")})}loadSingleResource(e){return c(this,null,function*(){if(!this.loadedResources.has(e.url))return new Promise((t,s)=>{const n=e.timeout||this.baseTimeout,m=setTimeout(()=>{s(new Error(`资源加载超时: ${e.url}`))},n),r=()=>{clearTimeout(m),this.loadedResources.add(e.url)};switch(e.type){case"script":this.loadScript(e.url).then(()=>{r(),t()}).catch(s);break;case"style":this.loadStyle(e.url).then(()=>{r(),t()}).catch(s);break;case"image":this.loadImage(e.url).then(()=>{r(),t()}).catch(s);break;default:r(),t()}})})}loadScript(e){return new Promise((t,s)=>{if(document.querySelector(`script[src="${e}"]`))return void t();const n=document.createElement("script");n.src=e,n.async=!0,n.crossOrigin="anonymous",n.onload=()=>t(),n.onerror=()=>s(new Error(`脚本加载失败: ${e}`)),document.head.appendChild(n)})}loadStyle(e){return new Promise((t,s)=>{if(document.querySelector(`link[href="${e}"]`))return void t();const n=document.createElement("link");n.rel="stylesheet",n.href=e,n.crossOrigin="anonymous",n.onload=()=>t(),n.onerror=()=>s(new Error(`样式加载失败: ${e}`)),document.head.appendChild(n)})}loadImage(e){return new Promise((t,s)=>{const n=new Image;n.crossOrigin="anonymous",n.onload=()=>t(),n.onerror=()=>s(new Error(`图片加载失败: ${e}`)),n.src=e})}retryFailedLoads(){return c(this,null,function*(){this.loadingState.error&&this.loadingState.retryCount<this.maxRetries&&(console.log("📱 网络恢复，重试加载..."),this.loadingState.retryCount++,this.loadingState.error=void 0,yield this.delay(1e3),yield this.preloadCriticalResources())})}delay(e){return new Promise(t=>setTimeout(t,e))}getLoadingState(){return o({},this.loadingState)}cleanup(){this.loadQueue=[],this.loadedResources.clear(),this.loadingState={isLoading:!1,progress:0,retryCount:0}}checkResourceAvailability(e){return c(this,null,function*(){try{return(yield fetch(e,{method:"HEAD",mode:"no-cors",cache:"no-cache"})).ok}catch(t){return!1}})}optimizeMobileCache(){if(!this.isMobile)return;const e=document.createElement("meta");e.httpEquiv="Cache-Control",e.content="public, max-age=86400, stale-while-revalidate=604800",document.head.appendChild(e);const t=document.createElement("link");t.rel="preconnect",t.href=window.location.origin,document.head.appendChild(t)}};const Ae=new class{constructor(){l(this,"retryCount",0),l(this,"maxRetries",3),l(this,"retryDelay",2e3),l(this,"connectionCheckInterval",null),this.initializeApp(),this.setupNetworkMonitoring(),console.log("🌐 Starting mobile optimization systems"),this.initializeMobileOptimizations()}initializeMobileOptimizations(){return c(this,null,function*(){try{Pe.optimizeMobileCache(),yield Pe.preloadCriticalResources(),console.log("📱 移动端优化系统启动完成")}catch(e){console.warn("📱 移动端优化启动失败:",e)}})}setupNetworkMonitoring(){window.addEventListener("online",this.handleOnline.bind(this)),window.addEventListener("offline",this.handleOffline.bind(this)),window.addEventListener("mobileConnectionChange",e=>{const{type:t,networkState:s}=e.detail;switch(console.log(`📱 移动端连接状态变化: ${t}`,s),t){case"unstable":this.updateLoaderText("检测到网络不稳定，正在优化连接...");break;case"restored":this.updateLoaderText("网络连接已恢复")}}),this.connectionCheckInterval=setInterval(()=>{this.checkNetworkConnection()},6e4)}checkNetworkConnection(){return c(this,null,function*(){try{return navigator.onLine}catch(e){return console.warn("网络连接检查失败:",e),navigator.onLine}})}handleOnline(){console.log("网络连接已恢复"),this.updateLoaderText("网络连接已恢复，正在重新初始化..."),this.retryCount=0,setTimeout(()=>{this.initializeApp()},1e3)}handleOffline(){console.log("网络连接已断开"),this.updateLoaderText("网络连接已断开，请检查网络设置"),this.showNetworkError()}initializeApp(){return c(this,null,function*(){try{this.updateLoaderText("正在初始化兼容性支持..."),Re();{const e=Se();console.log("浏览器兼容性检测完成:",e)}if(this.updateLoaderText("正在初始化应用..."),!navigator.onLine)return void this.handleOfflineState();yield this.preloadCriticalResources(),yield this.registerServiceWorker(),this.renderApp()}catch(e){console.error("应用初始化失败:",e),this.handleInitializationError(e)}})}preloadCriticalResources(){return c(this,null,function*(){try{if(this.updateLoaderText("正在加载核心资源..."),navigator.connection&&"4g"===navigator.connection.effectiveType){const e=document.createElement("link");e.rel="prefetch",e.href="/timesheet-management-system/favicon.svg",document.head.appendChild(e)}yield new Promise(e=>setTimeout(e,50))}catch(e){console.warn("预加载资源失败:",e)}})}registerServiceWorker(){return c(this,null,function*(){if("serviceWorker"in navigator&&"https:"===window.location.protocol)try{this.updateLoaderText("正在注册服务工作者...");const e=yield navigator.serviceWorker.register("/timesheet-management-system/sw.js",{scope:"/timesheet-management-system/"});console.log("Service Worker 注册成功:",e),e.addEventListener("updatefound",()=>{console.log("发现 Service Worker 更新")})}catch(e){console.warn("Service Worker 注册失败:",e)}})}renderApp(){try{this.updateLoaderText("正在启动应用..."),console.log("📱 Mobile optimization status:",_e.getStatus());const e=document.getElementById("root");if(!e)throw new Error("找不到根容器元素");C(e).render(h.jsxDEV(u.StrictMode,{children:h.jsxDEV(Ve,{},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/main.tsx",lineNumber:195,columnNumber:11},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/main.tsx",lineNumber:194,columnNumber:9},this)),setTimeout(()=>{window.hideInitialLoader&&window.hideInitialLoader()},500),console.log("应用启动成功")}catch(e){console.error("应用渲染失败:",e),this.handleInitializationError(e)}}handleOfflineState(){this.updateLoaderText("当前处于离线状态"),this.showNetworkError(),setTimeout(()=>{try{this.renderApp()}catch(e){console.error("离线模式下应用启动失败:",e)}},2e3)}handleInitializationError(e){var t,s,n;this.retryCount++;if(((null==(t=e.message)?void 0:t.includes("fetch"))||(null==(s=e.message)?void 0:s.includes("network"))||(null==(n=e.message)?void 0:n.includes("Failed to import")))&&this.retryCount<=this.maxRetries){this.updateLoaderText(`网络连接失败，正在重试... (${this.retryCount}/${this.maxRetries})`);const e=this.retryDelay*Math.pow(1.5,this.retryCount-1);setTimeout(()=>{this.initializeApp()},e)}else this.retryCount<=this.maxRetries?(this.updateLoaderText(`初始化失败，正在重试... (${this.retryCount}/${this.maxRetries})`),setTimeout(()=>{this.initializeApp()},this.retryDelay)):(this.updateLoaderText("应用启动失败"),this.showFinalError(e))}updateLoaderText(e){const t=document.getElementById("loader-text");t&&(t.textContent=e),console.log("加载状态:",e)}showNetworkError(){const e=document.getElementById("error-message"),t=document.getElementById("retry-button");e&&t&&(e.textContent="网络连接异常，请检查网络设置后重试",e.style.display="block",t.style.display="inline-block",t.onclick=()=>{this.retryCount=0,e.style.display="none",t.style.display="none",this.initializeApp()})}showFinalError(e){const t=document.getElementById("error-message"),s=document.getElementById("retry-button");t&&s&&(t.textContent=`应用启动失败: ${e.message||"未知错误"}。请刷新页面重试。`,t.style.display="block",s.textContent="刷新页面",s.style.display="inline-block",s.onclick=()=>{window.location.reload()})}cleanup(){this.connectionCheckInterval&&clearInterval(this.connectionCheckInterval),window.removeEventListener("online",this.handleOnline.bind(this)),window.removeEventListener("offline",this.handleOffline.bind(this))}};window.addEventListener("beforeunload",()=>{Ae.cleanup()}),window.addEventListener("error",e=>{console.error("全局错误:",e.error)}),window.addEventListener("unhandledrejection",e=>{console.error("未处理的 Promise 错误:",e.reason)});export{W as D,F as P,J as S,B as c,Y as f,X as g,K as h,H as i,z as s,te as u};
