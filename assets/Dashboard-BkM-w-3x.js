var e=Object.defineProperty,s=Object.defineProperties,t=Object.getOwnPropertyDescriptors,m=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,r=(s,t,m)=>t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:m}):s[t]=m,i=(e,s)=>{for(var t in s||(s={}))a.call(s,t)&&r(e,t,s[t]);if(m)for(var t of m(s))n.call(s,t)&&r(e,t,s[t]);return e},o=(e,s,t)=>new Promise((m,a)=>{var n=e=>{try{i(t.next(e))}catch(s){a(s)}},r=e=>{try{i(t.throw(e))}catch(s){a(s)}},i=e=>e.done?m(e.value):Promise.resolve(e.value).then(n,r);i((t=t.apply(e,s)).next())});import{r as l,j as h,q as d,s as c,t as u,v as g,B as b,U as N,K as x,C as y,w as f,x as p,S as v,y as D,i as w,f as j}from"./react-core-CEw6lU7H.js";import{u as k,a as E,D as V,c as S,S as O,r as C,b as P,s as I,K as B,P as $,d as K,C as U}from"./dnd-DniULoH-.js";import{u as J,i as M,f as q,g as z}from"./index-C-0iIl6c.js";import"./vendor-Dj0T90Ik.js";import"./supabase-DInoECZ_.js";import"./ui-BmDV7GQB.js";const A={Clock:w,BarChart3:D,Settings:v,Users:p,Building2:f,CheckCircle:y,Shield:c,Key:x,User:N,Building:b,Cog:g,Activity:u};function G({module:e,index:m,isDragMode:a}){const{attributes:n,listeners:r,setNodeRef:o,transform:l,transition:d,isDragging:c}=K({id:e.id}),u={transform:U.Transform.toString(l),transition:d},g=A[e.icon];return e.isPlaceholder?null:h.jsxDEV("div",{ref:o,style:u,className:`transition-all duration-200 ${c?"transform rotate-3 scale-105 shadow-2xl shadow-green-500/20 opacity-50 z-50":""} ${a?"cursor-grabbing":""}`,children:h.jsxDEV("div",(b=i(i({},n),r),N={className:a?"cursor-grabbing":"cursor-pointer",children:h.jsxDEV(j,{to:e.path,className:"group block",onClick:e=>{a&&(e.preventDefault(),e.stopPropagation())},children:h.jsxDEV("div",{className:"relative bg-gray-800 rounded-xl border border-gray-700 hover:border-green-400/60 transition-all duration-300 hover:transform hover:scale-[1.02] hover:shadow-xl hover:shadow-green-500/10 min-h-[140px] backdrop-blur-sm "+(a?"pointer-events-none":""),children:[h.jsxDEV("div",{className:"bg-gray-800 border-b border-green-600 p-4 rounded-t-xl",children:h.jsxDEV("div",{className:"flex items-center justify-between",children:[h.jsxDEV("div",{className:"flex items-center space-x-3",children:[h.jsxDEV("div",{className:"w-8 h-8 bg-gradient-to-br from-green-500 to-green-600 rounded-lg flex items-center justify-center group-hover:from-green-400 group-hover:to-green-500 transition-all duration-300",children:h.jsxDEV(g,{className:"w-5 h-5 text-white"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:119,columnNumber:21},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:118,columnNumber:19},this),h.jsxDEV("h3",{className:"text-white font-bold text-lg group-hover:text-green-100 transition-colors",children:e.name},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:121,columnNumber:19},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:117,columnNumber:17},this),h.jsxDEV("div",{className:"transition-opacity "+(a?"opacity-100":"opacity-0 group-hover:opacity-100"),children:h.jsxDEV("div",{className:"flex flex-col gap-1",children:[h.jsxDEV("div",{className:"w-1.5 h-1.5 bg-green-400 rounded-full"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:128,columnNumber:21},this),h.jsxDEV("div",{className:"w-1.5 h-1.5 bg-green-400 rounded-full"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:129,columnNumber:21},this),h.jsxDEV("div",{className:"w-1.5 h-1.5 bg-green-400 rounded-full"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:130,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:127,columnNumber:19},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:124,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:116,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:115,columnNumber:13},this),h.jsxDEV("div",{className:"p-6 flex flex-col items-center justify-center",children:h.jsxDEV("p",{className:"text-gray-400 text-sm text-center leading-relaxed group-hover:text-gray-300 transition-colors",children:e.description},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:139,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:137,columnNumber:13},this),a&&h.jsxDEV("div",{className:"absolute inset-0 bg-green-500/10 rounded-xl border-2 border-green-400/50 flex items-center justify-center backdrop-blur-sm",children:h.jsxDEV("div",{className:"text-green-400 font-mono text-sm font-bold",children:"拖拽模式"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:145,columnNumber:17},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:144,columnNumber:15},this),h.jsxDEV("div",{className:"absolute inset-0 rounded-xl bg-gradient-to-br from-green-500/0 via-green-500/0 to-green-500/0 group-hover:from-green-500/5 group-hover:via-transparent group-hover:to-green-500/5 transition-all duration-300"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:150,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:111,columnNumber:11},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:106,columnNumber:9},this)},s(b,t(N))),void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:97,columnNumber:7},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:86,columnNumber:5},this);var b,N}function R(){var e;const{user:s,logout:t}=J(),[m,a]=l.useState(!0),[n,r]=l.useState(new Date),[i,u]=l.useState([]),[g,b]=l.useState([]),[N,x]=l.useState(!1);l.useEffect(()=>{y();const e=setInterval(()=>{r(new Date)},1e3);return()=>clearInterval(e)},[]),l.useEffect(()=>{if(s){let t=[];if(M(s.role.name))t=z();else{const e=s.permissions||[];t=q(e)}u(t);const m=localStorage.getItem(`dashboard-order-${s.id}`);if(m)try{const e=JSON.parse(m),s=e.map(e=>t.find(s=>s.id===e)).filter(Boolean),a=t.filter(s=>!e.includes(s.id));b([...s,...a])}catch(e){b(t)}else b(t)}},[s]);const y=()=>o(this,null,function*(){a(!1)}),f=k(E($,{activationConstraint:{distance:5,delay:100,tolerance:3}}),E(B,{coordinateGetter:I})),p=()=>g;return m?h.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center",children:h.jsxDEV("div",{className:"text-green-400 text-xl animate-pulse font-mono",children:"加载中..."},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:284,columnNumber:9},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:283,columnNumber:7},this):h.jsxDEV("div",{className:"min-h-screen bg-black text-green-300",children:[h.jsxDEV("header",{className:"bg-gray-900 border-b border-green-400 px-4 sm:px-6 py-4",children:h.jsxDEV("div",{className:"max-w-7xl mx-auto",children:h.jsxDEV("div",{className:"flex justify-between items-center",children:[h.jsxDEV("div",{children:[h.jsxDEV("h1",{className:"text-xl sm:text-2xl font-bold text-green-400 font-mono",children:"工时管理系统"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:298,columnNumber:15},this),h.jsxDEV("div",{className:"mt-2 flex items-center gap-2",children:[h.jsxDEV("div",{className:"text-green-300 font-mono text-sm",children:(null==s?void 0:s.name)||"未知用户"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:303,columnNumber:17},this),h.jsxDEV("span",{className:"text-green-600",children:"•"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:306,columnNumber:17},this),h.jsxDEV("div",{className:"text-green-600 font-mono text-sm",children:(null==(e=null==s?void 0:s.role)?void 0:e.name)||"未分配角色"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:307,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:302,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:297,columnNumber:13},this),h.jsxDEV("button",{onClick:()=>o(this,null,function*(){try{yield t()}catch(e){}}),className:"flex items-center gap-2 px-3 py-2 sm:px-4 sm:py-2 bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white font-medium rounded-lg transition-all duration-200 font-mono text-sm shadow-lg hover:shadow-xl transform hover:scale-105",children:[h.jsxDEV(d,{className:"w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:318,columnNumber:15},this),h.jsxDEV("span",{className:"hidden sm:inline",children:"退出系统"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:319,columnNumber:15},this),h.jsxDEV("span",{className:"sm:hidden",children:"退出"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:320,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:314,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:296,columnNumber:11},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:295,columnNumber:9},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:294,columnNumber:7},this),h.jsxDEV("div",{className:"max-w-7xl mx-auto p-6",children:[h.jsxDEV("div",{className:"mb-8",children:h.jsxDEV("div",{className:"mt-4 h-1 bg-gradient-to-r from-transparent via-green-400 to-transparent"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:329,columnNumber:11},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:328,columnNumber:9},this),h.jsxDEV("div",{className:"mb-8",children:[h.jsxDEV(V,{sensors:f,collisionDetection:S,onDragStart:e=>{x(!0)},onDragEnd:e=>{const{active:t,over:m}=e;if(x(!1),!m||!s||t.id===m.id)return;const a=g.findIndex(e=>e.id===t.id),n=g.findIndex(e=>e.id===m.id);if(-1!==a&&-1!==n){const e=P(g,a,n);b(e);const t=e.map(e=>e.id);localStorage.setItem(`dashboard-order-${s.id}`,JSON.stringify(t))}},children:h.jsxDEV(O,{items:p().map(e=>e.id),strategy:C,children:h.jsxDEV("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 transition-colors duration-200 "+(N?"select-none":""),children:p().map((e,s)=>h.jsxDEV(G,{module:e,index:s,isDragMode:N},e.id,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:351,columnNumber:19},this))},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:347,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:343,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:337,columnNumber:11},this),0===i.length&&h.jsxDEV("div",{className:"text-center py-12",children:[h.jsxDEV("div",{className:"text-green-600 mb-4",children:h.jsxDEV(c,{className:"h-16 w-16 mx-auto"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:366,columnNumber:17},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:365,columnNumber:15},this),h.jsxDEV("h3",{className:"text-lg font-medium text-green-400 mb-2 font-mono",children:"暂无可访问的模块"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:368,columnNumber:15},this),h.jsxDEV("p",{className:"text-green-600 font-mono",children:"请联系管理员为您分配相应的权限"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:369,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:364,columnNumber:13},this),i.length>0&&h.jsxDEV("div",{className:"mt-6 text-center",children:N?h.jsxDEV("div",{className:"bg-green-900/30 border border-green-500 rounded-lg p-3",children:h.jsxDEV("p",{className:"text-green-400 text-sm font-mono font-bold",children:"🎯 拖拽模式已激活 - 松开鼠标完成排序"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:378,columnNumber:19},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:377,columnNumber:17},this):h.jsxDEV("p",{className:"text-green-600 text-sm font-mono",children:"💡 提示：长按模块或拖拽一定距离来重新排列顺序"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:383,columnNumber:17},this)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:375,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:335,columnNumber:9},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:326,columnNumber:7},this)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/Dashboard.tsx",lineNumber:292,columnNumber:5},this)}export{R as default};
