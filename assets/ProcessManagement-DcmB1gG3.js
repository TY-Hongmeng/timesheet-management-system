var e=Object.defineProperty,t=Object.defineProperties,m=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,o=(t,m,n)=>m in t?e(t,m,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[m]=n,a=(e,t)=>{for(var m in t||(t={}))s.call(t,m)&&o(e,m,t[m]);if(n)for(var m of n(t))r.call(t,m)&&o(e,m,t[m]);return e},i=(e,n)=>t(e,m(n)),l=(e,t,m)=>new Promise((n,s)=>{var r=e=>{try{a(m.next(e))}catch(t){s(t)}},o=e=>{try{a(m.throw(e))}catch(t){s(t)}},a=e=>e.done?n(e.value):Promise.resolve(e.value).then(r,o);a((m=m.apply(e,t)).next())});import{j as c,X as u,r as d,Q as g,H as h,V as p,d as N,S as x,f as b,l as y,G as v,F as f,J as w,D as k,O as E,T as D}from"./react-core-CmOG7fiH.js";import{u as _,c as j,s as V,i as M,P}from"./index-BABFRRsr.js";import{t as C}from"./ui-BpXc_XmY.js";import{utils as I,writeFile as S,read as $}from"./xlsx-DfDjAMCE.js";import{C as O}from"./CollapsibleSection-CtE4fUOM.js";import"./vendor-Dj0T90Ik.js";import"./supabase-k270UWii.js";const B=({isOpen:e,title:t,message:m,onConfirm:n,onCancel:s,confirmText:r="ç¡®å®š",cancelText:o="å–æ¶ˆ",type:a="warning"})=>{if(!e)return null;const i=(()=>{switch(a){case"danger":return{confirmButton:"bg-red-600 hover:bg-red-700 text-white",icon:"text-red-400"};case"warning":return{confirmButton:"bg-yellow-600 hover:bg-yellow-700 text-white",icon:"text-yellow-400"};default:return{confirmButton:"bg-green-600 hover:bg-green-700 text-white",icon:"text-green-400"}}})();return c.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50",children:c.jsxDEV("div",{className:"bg-gray-900 border border-green-500 rounded-lg shadow-xl max-w-md w-full mx-4",children:[c.jsxDEV("div",{className:"flex items-center justify-between p-6 border-b border-green-500",children:[c.jsxDEV("h3",{className:"text-lg font-semibold text-green-400",children:t},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ConfirmDialog.tsx",lineNumber:54,columnNumber:11},void 0),c.jsxDEV("button",{onClick:s,className:"text-green-400 hover:text-green-300 transition-colors",children:c.jsxDEV(u,{size:20},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ConfirmDialog.tsx",lineNumber:59,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ConfirmDialog.tsx",lineNumber:55,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ConfirmDialog.tsx",lineNumber:53,columnNumber:9},void 0),c.jsxDEV("div",{className:"p-6",children:c.jsxDEV("p",{className:"text-green-300 leading-relaxed",children:m},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ConfirmDialog.tsx",lineNumber:65,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ConfirmDialog.tsx",lineNumber:64,columnNumber:9},void 0),c.jsxDEV("div",{className:"flex items-center justify-end gap-3 p-6 border-t border-green-500 bg-gray-800",children:[c.jsxDEV("button",{onClick:s,className:"px-4 py-2 text-green-400 bg-gray-700 border border-green-500 rounded-md hover:bg-gray-600 transition-colors",children:o},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ConfirmDialog.tsx",lineNumber:70,columnNumber:11},void 0),c.jsxDEV("button",{onClick:n,className:`px-4 py-2 rounded-md transition-colors ${i.confirmButton}`,children:r},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ConfirmDialog.tsx",lineNumber:76,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ConfirmDialog.tsx",lineNumber:69,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ConfirmDialog.tsx",lineNumber:51,columnNumber:7},void 0)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ConfirmDialog.tsx",lineNumber:50,columnNumber:5},void 0)},L=({isOpen:e,onClose:t,onImport:m,companies:n,currentUser:s,existingProcesses:r=[]})=>{const[o,a]=d.useState(null),[i,N]=d.useState([]),[x,b]=d.useState([]),[y,v]=d.useState(!1),[f,w]=d.useState(null),[k,E]=d.useState(0),[D,_]=d.useState(""),[j,V]=d.useState(!1);if(!e)return null;const M=e=>{if(e.size>10485760)return"æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡10MB";if(0===e.size)return"æ–‡ä»¶ä¸èƒ½ä¸ºç©º";const t=e.name.toLowerCase();if(![".xlsx",".xls"].some(e=>t.endsWith(e)))return"è¯·é€‰æ‹©æœ‰æ•ˆçš„Excelæ–‡ä»¶ï¼ˆ.xlsx æˆ– .xls æ ¼å¼ï¼‰";return e.type&&!["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","application/octet-stream"].includes(e.type)?"æ–‡ä»¶ç±»å‹ä¸æ­£ç¡®ï¼Œè¯·é€‰æ‹©æœ‰æ•ˆçš„Excelæ–‡ä»¶":null},P=e=>l(void 0,null,function*(){v(!0),b([]);try{const t=yield e.arrayBuffer();if(!t||0===t.byteLength)return void b(["æ–‡ä»¶å†…å®¹ä¸ºç©ºï¼Œè¯·æ£€æŸ¥æ–‡ä»¶æ˜¯å¦æŸå"]);const m=$(t,{type:"array",cellDates:!0,cellNF:!1,cellText:!1,raw:!1,dateNF:"yyyy-mm-dd"});if(!m||!m.SheetNames||0===m.SheetNames.length)return void b(["Excelæ–‡ä»¶æ ¼å¼é”™è¯¯ï¼šæœªæ‰¾åˆ°æœ‰æ•ˆçš„å·¥ä½œè¡¨"]);const n=m.SheetNames[0],s=m.Sheets[n];if(!s)return void b(["Excelæ–‡ä»¶æ ¼å¼é”™è¯¯ï¼šå·¥ä½œè¡¨ä¸ºç©º"]);const r=I.sheet_to_json(s,{header:1,defval:"",blankrows:!1});if(!r||0===r.length)return void b(["Excelæ–‡ä»¶ä¸­æ²¡æœ‰æ•°æ®"]);if(r.length<2)return void b(["Excelæ–‡ä»¶è‡³å°‘éœ€è¦åŒ…å«æ ‡é¢˜è¡Œå’Œä¸€è¡Œæ•°æ®"]);const o=r[0],a=["å…¬å¸åç§°","ç”Ÿäº§çº¿","å·¥æ—¶ç±»å‹","äº§å“åç§°","äº§å“å·¥åº","å•ä»·","ç”Ÿæ•ˆå¹´æœˆ"],i=a.filter(e=>!o.includes(e));if(i.length>0)return void b(["Excelæ–‡ä»¶æ ‡é¢˜è¡Œä¸æ­£ç¡®ï¼Œç¼ºå°‘ä»¥ä¸‹åˆ—ï¼š"+i.join("ã€"),"æ­£ç¡®çš„æ ‡é¢˜è¡Œåº”è¯¥åŒ…å«ï¼š"+a.join("ã€")]);const l=r.slice(1).filter(e=>e.some(e=>""!==e&&null!=e)).map((e,t)=>{const m={};return o.forEach((t,n)=>{m[t]=e[n]||""}),{"å…¬å¸åç§°":String(m["å…¬å¸åç§°"]||"").trim(),"ç”Ÿäº§çº¿":String(m["ç”Ÿäº§çº¿"]||"").trim(),"å·¥æ—¶ç±»å‹":String(m["å·¥æ—¶ç±»å‹"]||"").trim(),"äº§å“åç§°":String(m["äº§å“åç§°"]||"").trim(),"äº§å“å·¥åº":String(m["äº§å“å·¥åº"]||"").trim(),"å•ä»·":m["å•ä»·"],"ç”Ÿæ•ˆå¹´æœˆ":C(m["ç”Ÿæ•ˆå¹´æœˆ"])}});if(0===l.length)return void b(["Excelæ–‡ä»¶ä¸­æ²¡æœ‰æœ‰æ•ˆçš„æ•°æ®è¡Œ"]);const c=O(l);c.length>0&&b(c),N(l.slice(0,10))}catch(t){console.error("Excelè§£æé”™è¯¯:",t);let e="Excelæ–‡ä»¶è§£æå¤±è´¥";t instanceof Error&&(e=t.message.includes("Unsupported file")?"ä¸æ”¯æŒçš„æ–‡ä»¶æ ¼å¼ï¼Œè¯·ç¡®ä¿æ–‡ä»¶æ˜¯æœ‰æ•ˆçš„Excelæ–‡ä»¶ï¼ˆ.xlsxæˆ–.xlsï¼‰":t.message.includes("Invalid file")?"æ–‡ä»¶æ ¼å¼æ— æ•ˆæˆ–æ–‡ä»¶å·²æŸåï¼Œè¯·æ£€æŸ¥æ–‡ä»¶æ˜¯å¦æ­£ç¡®":t.message.includes("password")?"æ–‡ä»¶å—å¯†ç ä¿æŠ¤ï¼Œè¯·å…ˆè§£é™¤å¯†ç ä¿æŠ¤åå†å¯¼å…¥":`æ–‡ä»¶è§£æå¤±è´¥ï¼š${t.message}`),b([e,"è¯·ç¡®ä¿æ–‡ä»¶æ˜¯æœ‰æ•ˆçš„Excelæ ¼å¼ï¼Œä¸”åŒ…å«æ­£ç¡®çš„æ•°æ®ç»“æ„"])}finally{v(!1),setTimeout(()=>{V(!1),E(0),_("")},1e3)}}),C=e=>{if(!e)return"";if("number"==typeof e){const t=new Date(86400*(e-25569)*1e3);return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}`}const t=String(e).trim();if(t.match(/^\d{4}-\d{2}$/))return t;if(t.match(/^\d{4}-\d{2}-\d{2}$/))return t.substring(0,7);if(t.match(/^\d{4}\/\d{1,2}$/)){const[e,m]=t.split("/");return`${e}-${m.padStart(2,"0")}`}if(t.match(/^\d{4}\/\d{1,2}\/\d{1,2}$/)){const[e,m]=t.split("/");return`${e}-${m.padStart(2,"0")}`}return t},O=e=>{const t=[],m=new Set(n.map(e=>e.name)),s=new Map(n.map(e=>[e.name,e.id])),o=new Set(["ç”Ÿäº§å·¥æ—¶","éç”Ÿäº§å·¥æ—¶"]),a=new Map;r.forEach(e=>{const t=`${e.company_id}_${e.production_line.trim()}_${e.production_category}_${e.product_name.trim()}_${e.product_process.trim()}`;a.set(t,e)});const i=new Map;return e.forEach((e,n)=>{const r=n+2;if(e.å…¬å¸åç§°?m.has(e.å…¬å¸åç§°)||t.push(`ç¬¬${r}è¡Œï¼šå…¬å¸"${e.å…¬å¸åç§°}"ä¸å­˜åœ¨`):t.push(`ç¬¬${r}è¡Œï¼šå…¬å¸åç§°ä¸èƒ½ä¸ºç©º`),e.ç”Ÿäº§çº¿||t.push(`ç¬¬${r}è¡Œï¼šç”Ÿäº§çº¿ä¸èƒ½ä¸ºç©º`),e.å·¥æ—¶ç±»å‹&&o.has(e.å·¥æ—¶ç±»å‹)||t.push(`ç¬¬${r}è¡Œï¼šå·¥æ—¶ç±»å‹å¿…é¡»æ˜¯"ç”Ÿäº§å·¥æ—¶"æˆ–"éç”Ÿäº§å·¥æ—¶"`),e.äº§å“åç§°||t.push(`ç¬¬${r}è¡Œï¼šäº§å“åç§°ä¸èƒ½ä¸ºç©º`),e.äº§å“å·¥åº||t.push(`ç¬¬${r}è¡Œï¼šäº§å“å·¥åºä¸èƒ½ä¸ºç©º`),e.å•ä»·&&""!==e.å•ä»·&&"string"==typeof e.å•ä»·&&isNaN(Number(e.å•ä»·))&&t.push(`ç¬¬${r}è¡Œï¼šå•ä»·å¿…é¡»æ˜¯æœ‰æ•ˆæ•°å­—`),e.ç”Ÿæ•ˆå¹´æœˆ||t.push(`ç¬¬${r}è¡Œï¼šç”Ÿæ•ˆå¹´æœˆä¸èƒ½ä¸ºç©º`),e.å…¬å¸åç§°&&e.ç”Ÿäº§çº¿&&e.å·¥æ—¶ç±»å‹&&e.äº§å“åç§°&&e.äº§å“å·¥åº){const m=`${e.å…¬å¸åç§°.trim()}_${e.ç”Ÿäº§çº¿.trim()}_${e.å·¥æ—¶ç±»å‹}_${e.äº§å“åç§°.trim()}_${e.äº§å“å·¥åº.trim()}`;i.has(m)?i.get(m).push(r):i.set(m,[r]);const n=s.get(e.å…¬å¸åç§°);if(n){const m=`${n}_${e.ç”Ÿäº§çº¿.trim()}_${e.å·¥æ—¶ç±»å‹}_${e.äº§å“åç§°.trim()}_${e.äº§å“å·¥åº.trim()}`,s=a.get(m);s&&t.push(`ç¬¬${r}è¡Œï¼šä¸ç°æœ‰å·¥åºé‡å¤ï¼ï¼ˆå…¬å¸ï¼š${s.company_name||e.å…¬å¸åç§°}ï¼Œç”Ÿäº§çº¿ï¼š${s.production_line}ï¼Œå·¥æ—¶ç±»å‹ï¼š${s.production_category}ï¼Œäº§å“åç§°ï¼š${s.product_name}ï¼Œäº§å“å·¥åºï¼š${s.product_process}ï¼‰`)}}}),i.forEach((e,m)=>{if(e.length>1){const[n,s,r,o,a]=m.split("_");t.push(`å¯¼å…¥æ•°æ®å†…éƒ¨é‡å¤ï¼šç¬¬${e.join("ã€")}è¡Œï¼ˆå…¬å¸ï¼š${n}ï¼Œç”Ÿäº§çº¿ï¼š${s}ï¼Œå·¥æ—¶ç±»å‹ï¼š${r}ï¼Œäº§å“åç§°ï¼š${o}ï¼Œäº§å“å·¥åºï¼š${a}ï¼‰`)}}),t},B=()=>{a(null),N([]),b([]),w(null),t()};return c.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxDEV("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-6xl max-h-[90vh] overflow-y-auto",children:[c.jsxDEV("div",{className:"flex justify-between items-center mb-6",children:[c.jsxDEV("h2",{className:"text-xl font-bold text-green-400",children:"æ‰¹é‡å¯¼å…¥å·¥åº"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:569,columnNumber:11},void 0),c.jsxDEV("button",{onClick:B,className:"text-gray-400 hover:text-white transition-colors",children:c.jsxDEV(u,{className:"w-6 h-6"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:574,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:570,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:568,columnNumber:9},void 0),f?c.jsxDEV("div",{className:"text-center",children:[c.jsxDEV("div",{className:"mb-6",children:[c.jsxDEV("h3",{className:"text-xl font-semibold text-green-400 mb-4",children:"å¯¼å…¥å®Œæˆ"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:717,columnNumber:15},void 0),c.jsxDEV("div",{className:"space-y-2",children:[c.jsxDEV("p",{className:"text-white",children:["æˆåŠŸå¯¼å…¥ï¼š",c.jsxDEV("span",{className:"text-green-400 font-semibold",children:f.success},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:719,columnNumber:48},void 0)," æ¡"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:719,columnNumber:17},void 0),c.jsxDEV("p",{className:"text-white",children:["å¯¼å…¥å¤±è´¥ï¼š",c.jsxDEV("span",{className:"text-red-400 font-semibold",children:f.failed},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:720,columnNumber:48},void 0)," æ¡"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:720,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:718,columnNumber:15},void 0),f.errors.length>0&&c.jsxDEV("div",{className:"mt-4 p-4 bg-red-900 border border-red-600 rounded text-left",children:[c.jsxDEV("h4",{className:"text-red-400 font-semibold mb-2",children:"é”™è¯¯ä¿¡æ¯ï¼š"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:725,columnNumber:19},void 0),c.jsxDEV("ul",{className:"text-red-300 text-sm space-y-1",children:f.errors.map((e,t)=>c.jsxDEV("li",{children:["â€¢ ",e]},t,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:728,columnNumber:23},void 0))},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:726,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:724,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:716,columnNumber:13},void 0),c.jsxDEV("button",{onClick:B,className:"px-6 py-2 bg-green-600 hover:bg-green-700 text-white rounded transition-colors",children:"å…³é—­"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:735,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:715,columnNumber:11},void 0):c.jsxDEV(c.Fragment,{children:[c.jsxDEV("div",{className:"mb-6",children:[c.jsxDEV("div",{className:"flex items-center gap-4 mb-4",children:[c.jsxDEV("label",{className:"flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded cursor-pointer transition-colors",children:[c.jsxDEV(g,{className:"w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:584,columnNumber:19},void 0),"é€‰æ‹©Excelæ–‡ä»¶",c.jsxDEV("input",{type:"file",accept:".xlsx,.xls",onChange:e=>{var t;const m=null==(t=e.target.files)?void 0:t[0];if(m){b([]),N([]);const e=M(m);if(e)return b([e]),void a(null);a(m),P(m)}},className:"hidden"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:586,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:583,columnNumber:17},void 0),c.jsxDEV("button",{onClick:()=>{var e;const t=[{"å…¬å¸åç§°":(null==(e=null==s?void 0:s.company)?void 0:e.name)||"ç¤ºä¾‹å…¬å¸","ç”Ÿäº§çº¿":"ç”Ÿäº§çº¿A","å·¥æ—¶ç±»å‹":"ç”Ÿäº§å·¥æ—¶","äº§å“åç§°":"ç¤ºä¾‹äº§å“","äº§å“å·¥åº":"ç¤ºä¾‹å·¥åº","å•ä»·":"","ç”Ÿæ•ˆå¹´æœˆ":(new Date).toISOString().slice(0,7)}],m=I.json_to_sheet(t),n=I.book_new();I.book_append_sheet(n,m,"å·¥åºå¯¼å…¥æ¨¡æ¿"),S(n,"å·¥åºå¯¼å…¥æ¨¡æ¿.xlsx")},className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded transition-colors",children:[c.jsxDEV(h,{className:"w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:597,columnNumber:19},void 0),"ä¸‹è½½æ¨¡æ¿"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:593,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:582,columnNumber:15},void 0),c.jsxDEV("div",{className:"mb-4 p-3 bg-blue-900 border border-blue-600 rounded",children:[c.jsxDEV("h4",{className:"text-blue-400 font-semibold mb-2",children:"æ–‡ä»¶æ ¼å¼è¦æ±‚ï¼š"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:604,columnNumber:17},void 0),c.jsxDEV("ul",{className:"text-blue-300 text-sm space-y-1",children:[c.jsxDEV("li",{children:"â€¢ æ”¯æŒ .xlsx å’Œ .xls æ ¼å¼çš„Excelæ–‡ä»¶"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:606,columnNumber:19},void 0),c.jsxDEV("li",{children:"â€¢ æ–‡ä»¶å¤§å°ä¸è¶…è¿‡ 10MB"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:607,columnNumber:19},void 0),c.jsxDEV("li",{children:"â€¢ å¿…é¡»åŒ…å«æ ‡é¢˜è¡Œï¼šå…¬å¸åç§°ã€ç”Ÿäº§çº¿ã€å·¥æ—¶ç±»å‹ã€äº§å“åç§°ã€äº§å“å·¥åºã€å•ä»·ã€ç”Ÿæ•ˆå¹´æœˆ"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:608,columnNumber:19},void 0),c.jsxDEV("li",{children:'â€¢ å·¥æ—¶ç±»å‹åªèƒ½æ˜¯"ç”Ÿäº§å·¥æ—¶"æˆ–"éç”Ÿäº§å·¥æ—¶"'},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:609,columnNumber:19},void 0),c.jsxDEV("li",{children:"â€¢ ç”Ÿæ•ˆå¹´æœˆæ ¼å¼ï¼šYYYY-MMï¼ˆå¦‚ï¼š2024-01ï¼‰"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:610,columnNumber:19},void 0),c.jsxDEV("li",{children:"â€¢ å•ä»·å¯ä»¥ä¸ºç©ºï¼Œå¦‚å¡«å†™å¿…é¡»æ˜¯æœ‰æ•ˆæ•°å­—"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:611,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:605,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:603,columnNumber:15},void 0),o&&c.jsxDEV("div",{className:"flex items-center gap-2 text-green-400",children:[c.jsxDEV(p,{className:"w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:617,columnNumber:19},void 0),c.jsxDEV("span",{children:o.name},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:618,columnNumber:19},void 0),c.jsxDEV("span",{className:"text-gray-400 text-sm",children:["(",(o.size/1024/1024).toFixed(2)," MB)"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:619,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:616,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:581,columnNumber:13},void 0),x.length>0&&c.jsxDEV("div",{className:"mb-6 p-4 bg-red-900 border border-red-600 rounded",children:[c.jsxDEV("h3",{className:"text-red-400 font-semibold mb-2",children:"æ•°æ®éªŒè¯é”™è¯¯ï¼š"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:629,columnNumber:17},void 0),c.jsxDEV("ul",{className:"text-red-300 text-sm space-y-1",children:[x.slice(0,10).map((e,t)=>c.jsxDEV("li",{children:["â€¢ ",e]},t,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:632,columnNumber:21},void 0)),x.length>10&&c.jsxDEV("li",{className:"text-red-400",children:["... è¿˜æœ‰ ",x.length-10," ä¸ªé”™è¯¯"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:635,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:630,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:628,columnNumber:15},void 0),i.length>0&&c.jsxDEV("div",{className:"mb-6",children:[c.jsxDEV("h3",{className:"text-green-400 font-semibold mb-3",children:"æ•°æ®é¢„è§ˆï¼ˆå‰10è¡Œï¼‰ï¼š"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:644,columnNumber:17},void 0),c.jsxDEV("div",{className:"overflow-x-auto",children:c.jsxDEV("table",{className:"w-full border border-gray-600 rounded",children:[c.jsxDEV("thead",{children:c.jsxDEV("tr",{className:"bg-gray-700",children:[c.jsxDEV("th",{className:"border border-gray-600 px-3 py-2 text-green-400 text-sm",children:"å…¬å¸åç§°"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:649,columnNumber:25},void 0),c.jsxDEV("th",{className:"border border-gray-600 px-3 py-2 text-green-400 text-sm",children:"ç”Ÿäº§çº¿"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:650,columnNumber:25},void 0),c.jsxDEV("th",{className:"border border-gray-600 px-3 py-2 text-green-400 text-sm",children:"å·¥æ—¶ç±»å‹"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:651,columnNumber:25},void 0),c.jsxDEV("th",{className:"border border-gray-600 px-3 py-2 text-green-400 text-sm",children:"äº§å“åç§°"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:652,columnNumber:25},void 0),c.jsxDEV("th",{className:"border border-gray-600 px-3 py-2 text-green-400 text-sm",children:"äº§å“å·¥åº"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:653,columnNumber:25},void 0),c.jsxDEV("th",{className:"border border-gray-600 px-3 py-2 text-green-400 text-sm",children:"å•ä»·"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:654,columnNumber:25},void 0),c.jsxDEV("th",{className:"border border-gray-600 px-3 py-2 text-green-400 text-sm",children:"ç”Ÿæ•ˆå¹´æœˆ"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:655,columnNumber:25},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:648,columnNumber:23},void 0)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:647,columnNumber:21},void 0),c.jsxDEV("tbody",{children:i.map((e,t)=>c.jsxDEV("tr",{className:"hover:bg-gray-700",children:[c.jsxDEV("td",{className:"border border-gray-600 px-3 py-2 text-white text-sm",children:e.å…¬å¸åç§°},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:661,columnNumber:27},void 0),c.jsxDEV("td",{className:"border border-gray-600 px-3 py-2 text-white text-sm",children:e.ç”Ÿäº§çº¿},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:662,columnNumber:27},void 0),c.jsxDEV("td",{className:"border border-gray-600 px-3 py-2 text-white text-sm",children:e.å·¥æ—¶ç±»å‹},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:663,columnNumber:27},void 0),c.jsxDEV("td",{className:"border border-gray-600 px-3 py-2 text-white text-sm",children:e.äº§å“åç§°},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:664,columnNumber:27},void 0),c.jsxDEV("td",{className:"border border-gray-600 px-3 py-2 text-white text-sm",children:e.äº§å“å·¥åº},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:665,columnNumber:27},void 0),c.jsxDEV("td",{className:"border border-gray-600 px-3 py-2 text-white text-sm",children:e.å•ä»·},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:666,columnNumber:27},void 0),c.jsxDEV("td",{className:"border border-gray-600 px-3 py-2 text-white text-sm",children:e.ç”Ÿæ•ˆå¹´æœˆ},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:667,columnNumber:27},void 0)]},t,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:660,columnNumber:25},void 0))},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:658,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:646,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:645,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:643,columnNumber:15},void 0),j&&c.jsxDEV("div",{className:"mb-6 p-4 bg-gray-700 border border-green-400 rounded",children:[c.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[c.jsxDEV("span",{className:"text-green-400 font-semibold",children:"å¯¼å…¥è¿›åº¦"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:680,columnNumber:19},void 0),c.jsxDEV("span",{className:"text-green-400 text-sm",children:[k,"%"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:681,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:679,columnNumber:17},void 0),c.jsxDEV("div",{className:"w-full bg-gray-600 rounded-full h-3 mb-2",children:c.jsxDEV("div",{className:"bg-gradient-to-r from-green-500 to-green-400 h-3 rounded-full transition-all duration-300 ease-out",style:{width:`${k}%`}},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:684,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:683,columnNumber:17},void 0),c.jsxDEV("div",{className:"text-green-300 text-sm flex items-center",children:[c.jsxDEV("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-green-400 border-t-transparent mr-2"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:690,columnNumber:19},void 0),D]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:689,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:678,columnNumber:15},void 0),c.jsxDEV("div",{className:"flex justify-end gap-4",children:[c.jsxDEV("button",{onClick:B,className:"px-6 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded transition-colors",children:"å–æ¶ˆ"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:698,columnNumber:15},void 0),c.jsxDEV("button",{onClick:()=>l(void 0,null,function*(){if(o&&!(x.length>0)){v(!0),V(!0),E(0),_("å¼€å§‹å¯¼å…¥...");try{_("æ­£åœ¨è¯»å–Excelæ–‡ä»¶..."),E(5);const e=yield o.arrayBuffer();_("æ­£åœ¨è§£æExcelæ•°æ®..."),E(15);const t=$(e,{type:"array",cellDates:!0,cellNF:!1,cellText:!1,raw:!1,dateNF:"yyyy-mm-dd"}),s=t.SheetNames[0],r=t.Sheets[s],a=I.sheet_to_json(r,{header:1,defval:"",blankrows:!1});E(30),_(`æ­£åœ¨å¤„ç† ${a.length-1} æ¡æ•°æ®...`);const i=a[0],l=a.slice(1),c=[],u=l.length;for(let m=0;m<u;m++){const e=l[m];if(!e.some(e=>""!==e&&null!=e))continue;const t={};i.forEach((m,n)=>{t[m]=e[n]||""}),c.push({"å…¬å¸åç§°":String(t["å…¬å¸åç§°"]||"").trim(),"ç”Ÿäº§çº¿":String(t["ç”Ÿäº§çº¿"]||"").trim(),"å·¥æ—¶ç±»å‹":String(t["å·¥æ—¶ç±»å‹"]||"").trim(),"äº§å“åç§°":String(t["äº§å“åç§°"]||"").trim(),"äº§å“å·¥åº":String(t["äº§å“å·¥åº"]||"").trim(),"å•ä»·":t["å•ä»·"],"ç”Ÿæ•ˆå¹´æœˆ":C(t["ç”Ÿæ•ˆå¹´æœˆ"])});const n=30+Math.floor(m/u*20);E(n),m%50==0&&(yield new Promise(e=>setTimeout(e,1)))}_(`æ­£åœ¨è½¬æ¢ ${c.length} æ¡æœ‰æ•ˆæ•°æ®æ ¼å¼...`),E(50);const d=c.map((e,t)=>{const m=n.find(t=>t.name===e.å…¬å¸åç§°);if(t%10==0){const e=50+Math.floor(t/c.length*20);E(e)}return{company_id:(null==m?void 0:m.id)||"",production_line:e.ç”Ÿäº§çº¿,production_category:e.å·¥æ—¶ç±»å‹,product_name:e.äº§å“åç§°,product_process:e.äº§å“å·¥åº,unit_price:e.å•ä»·&&""!==e.å•ä»·&&void 0!==e.å•ä»·?Number(e.å•ä»·):null,effective_date:e.ç”Ÿæ•ˆå¹´æœˆ||null}});_(`æ­£åœ¨ä¿å­˜ ${d.length} æ¡å·¥åºæ•°æ®åˆ°æ•°æ®åº“...`),E(70),yield m(d),E(100),_(`å¯¼å…¥å®Œæˆï¼æˆåŠŸå¯¼å…¥ ${d.length} æ¡å·¥åºæ•°æ®`),w({success:d.length,failed:0,errors:[]})}catch(e){console.error("å¯¼å…¥é”™è¯¯:",e);let t="å¯¼å…¥å¤±è´¥";e instanceof Error&&(t=e.message.includes("duplicate")?"å¯¼å…¥å¤±è´¥ï¼šå­˜åœ¨é‡å¤æ•°æ®":e.message.includes("permission")?"å¯¼å…¥å¤±è´¥ï¼šæƒé™ä¸è¶³":e.message.includes("network")?"å¯¼å…¥å¤±è´¥ï¼šç½‘ç»œè¿æ¥é”™è¯¯":`å¯¼å…¥å¤±è´¥ï¼š${e.message}`),w({success:0,failed:i.length,errors:[t]}),E(0),_("")}finally{v(!1)}}}),disabled:!o||x.length>0||y,className:"px-6 py-2 bg-green-600 hover:bg-green-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded transition-colors",children:y?"å¯¼å…¥ä¸­...":"ç¡®è®¤å¯¼å…¥"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:704,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:697,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:579,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:567,columnNumber:7},void 0)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/components/ExcelImportDialog.tsx",lineNumber:566,columnNumber:5},void 0)},F=()=>{var e;const{user:t,loading:m}=_(),n=N(),[s,r]=d.useState([]),[o,h]=d.useState([]),[p,I]=d.useState(!0),[S,$]=d.useState(""),[F,T]=d.useState(""),[z,A]=d.useState(""),[W,Y]=d.useState(""),[q,U]=d.useState(!1),[G,H]=d.useState(!1),[J,Q]=d.useState(null),[R,K]=d.useState(!1),[X,Z]=d.useState([]),[ee,te]=d.useState([]),[me,ne]=d.useState([]),[se,re]=d.useState([]),[oe,ae]=d.useState([]),[ie,le]=d.useState([]),[ce,ue]=d.useState(!1),[de,ge]=d.useState(!1),[he,pe]=d.useState(!1),[Ne,xe]=d.useState({company_id:"",production_line:"",production_category:"",product_name:"",product_process:""}),[be,ye]=d.useState({company_id:"",production_line:"",production_category:"",product_name:"",product_process:"",unit_price:"",effective_date:(new Date).toISOString().slice(0,7),work_time_type:"ç”Ÿäº§å·¥æ—¶"}),[ve,fe]=d.useState(null),[we,ke]=d.useState(!1),[Ee,De]=d.useState(1),[_e,je]=d.useState(20),[Ve,Me]=d.useState(null),[Pe,Ce]=d.useState(!1),[Ie,Se]=d.useState(!1);d.useEffect(()=>{if(!m&&!t)return C.error("è¯·å…ˆç™»å½•"),void n("/login");t&&$e()},[t,m,n]);const $e=()=>l(void 0,null,function*(){if(!t)return;if(!(yield j(t.id,P.PROCESS_MANAGEMENT)))return C.error("æ‚¨æ²¡æœ‰æƒé™è®¿é—®å·¥åºç®¡ç†åŠŸèƒ½"),void n("/dashboard");Oe(),Te()}),Oe=()=>l(void 0,null,function*(){var e;try{if(I(!0),!t)return void C.error("ç”¨æˆ·ä¿¡æ¯ä¸å­˜åœ¨");let m=V.from("processes").select("\n          *,\n          companies!inner(\n            name\n          )\n        ");if(!M(t.role)){if(!(null==(e=t.company)?void 0:e.id))return void C.error("ç”¨æˆ·æ²¡æœ‰å…³è”çš„å…¬å¸ï¼Œè¯·è”ç³»ç®¡ç†å‘˜");m=m.eq("company_id",t.company.id)}const{data:n,error:s}=yield m.order("created_at",{ascending:!1});if(s)return void C.error(`è·å–å·¥åºåˆ—è¡¨å¤±è´¥: ${s.message}`);console.log("ğŸ“Š ProcessManagement.tsx - fetchProcesses: æŸ¥è¯¢åˆ°çš„åŸå§‹æ•°æ®:",n),console.log("ğŸ“Š ProcessManagement.tsx - fetchProcesses: åŸå§‹æ•°æ®æ•°é‡:",(null==n?void 0:n.length)||0);const o=(n||[]).map(e=>{var t;return i(a({},e),{company_name:(null==(t=e.companies)?void 0:t.name)||"æœªçŸ¥å…¬å¸"})});r(o),Be(o)}catch(m){C.error(`è·å–å·¥åºåˆ—è¡¨å¤±è´¥: ${m.message||"æœªçŸ¥é”™è¯¯"}`)}finally{I(!1)}}),Be=e=>{var m,n;if(console.log("ğŸ” ProcessManagement.tsx - updateAutoCompleteOptions: å¼€å§‹æ›´æ–°è‡ªåŠ¨å®Œæˆé€‰é¡¹"),console.log("ğŸ” ProcessManagement.tsx - updateAutoCompleteOptions: ç”¨æˆ·ä¿¡æ¯:",t),console.log("ğŸ” ProcessManagement.tsx - updateAutoCompleteOptions: ç”¨æˆ·å…¬å¸ID:",null==(m=null==t?void 0:t.company)?void 0:m.id),console.log("ğŸ” ProcessManagement.tsx - updateAutoCompleteOptions: æ˜¯å¦ä¸ºè¶…çº§ç®¡ç†å‘˜:",M(null==t?void 0:t.role)),!(null==(n=null==t?void 0:t.company)?void 0:n.id)&&!M(null==t?void 0:t.role))return;const s=M(null==t?void 0:t.role)?e:e.filter(e=>{var m;return e.company_id===(null==(m=t.company)?void 0:m.id)});console.log("ğŸ“Š ProcessManagement.tsx - updateAutoCompleteOptions: è¿‡æ»¤åçš„å·¥åºæ•°æ®æ•°é‡:",s.length);const r=[...new Set(s.map(e=>e.production_line).filter(Boolean))];console.log("ğŸ¯ ProcessManagement.tsx - updateAutoCompleteOptions: å”¯ä¸€ç”Ÿäº§çº¿:",r),console.log("ğŸ¯ ProcessManagement.tsx - updateAutoCompleteOptions: å”¯ä¸€ç”Ÿäº§çº¿æ•°é‡:",r.length),Z(r);const o=[...new Set(s.map(e=>e.product_name).filter(Boolean))];te(o);const a=[...new Set(s.map(e=>e.product_process).filter(Boolean))];ne(a)},Le=(e,t)=>{switch(ye(m=>i(a({},m),{[e]:t})),e){case"production_line":const e=X.filter(e=>e.toLowerCase().includes(t.toLowerCase()));re(e),ue(t.length>0&&e.length>0);break;case"product_name":const m=ee.filter(e=>e.toLowerCase().includes(t.toLowerCase()));ae(m),ge(t.length>0&&m.length>0);break;case"product_process":const n=me.filter(e=>e.toLowerCase().includes(t.toLowerCase()));le(n),pe(t.length>0&&n.length>0)}},Fe=(e,t)=>{switch(ye(m=>i(a({},m),{[e]:t})),e){case"production_line":ue(!1);break;case"product_name":ge(!1);break;case"product_process":pe(!1)}},Te=()=>l(void 0,null,function*(){var e,m;try{if(!t)return void C.error("ç”¨æˆ·ä¿¡æ¯ä¸å­˜åœ¨");let n=V.from("companies").select("id, name");M(t.role)||(n=n.eq("id",null==(e=t.company)?void 0:e.id));const{data:s,error:r}=yield n.order("name");if(r)return void C.error("è·å–å…¬å¸åˆ—è¡¨å¤±è´¥");h(s||[]),!M(t.role)&&(null==(m=t.company)?void 0:m.id)&&ye(e=>i(a({},e),{company_id:t.company.id}))}catch(n){C.error("è·å–å…¬å¸åˆ—è¡¨å¤±è´¥")}}),ze=()=>{var e;return!M(null==t?void 0:t.role)&&(null==(e=null==t?void 0:t.company)?void 0:e.id)?t.company.id:""},Ae=s.reduce((e,t)=>{var m,n,s;const r=`${t.company_id}_${null==(m=t.production_line)?void 0:m.trim()}_${t.production_category}_${null==(n=t.product_name)?void 0:n.trim()}_${null==(s=t.product_process)?void 0:s.trim()}`;return(!e[r]||new Date(t.created_at)>new Date(e[r].created_at))&&(e[r]=t),e},{}),We=Object.values(Ae).filter(e=>{if(Ie)return!e.unit_price||e.unit_price<=0;const t=""===S||e.production_line.toLowerCase().includes(S.toLowerCase())||e.product_name.toLowerCase().includes(S.toLowerCase())||e.production_category&&e.production_category.toLowerCase().includes(S.toLowerCase())||e.product_process&&e.product_process.toLowerCase().includes(S.toLowerCase())||e.company_name&&e.company_name.toLowerCase().includes(S.toLowerCase()),m=""===Ne.company_id||e.company_id===Ne.company_id,n=""===Ne.production_line||e.production_line===Ne.production_line,s=""===Ne.production_category||e.production_category===Ne.production_category,r=""===Ne.product_name||e.product_name===Ne.product_name,o=""===Ne.product_process||e.product_process===Ne.product_process,a=!W||e.effective_date===W;return t&&m&&n&&s&&r&&o&&a}),Ye=We.length,qe=Math.ceil(Ye/_e),Ue=(Ee-1)*_e,Ge=Ue+_e,He=We.slice(Ue,Ge),Je=new Map;s.forEach(e=>{e.company_id&&e.company_name&&Je.set(e.company_id,e.company_name)});const Qe=Array.from(Je.entries()).map(([e,t])=>({id:e,name:t})),Re=[...new Set(s.map(e=>e.production_line).filter(Boolean))],Ke=[...new Set(s.map(e=>e.production_category).filter(Boolean))],Xe=[...new Set(s.map(e=>e.product_name).filter(Boolean))],Ze=[...new Set(s.map(e=>e.product_process).filter(Boolean))];return console.log("ğŸ¯ ProcessManagement.tsx - ç­›é€‰ç”¨å”¯ä¸€ç”Ÿäº§çº¿:",Re),console.log("ğŸ¯ ProcessManagement.tsx - ç­›é€‰ç”¨å”¯ä¸€ç”Ÿäº§çº¿æ•°é‡:",Re.length),c.jsxDEV("div",{className:"min-h-screen bg-black text-green-400 font-mono",children:[c.jsxDEV("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[c.jsxDEV("div",{className:"mb-8",children:[c.jsxDEV("div",{className:"flex justify-between items-center mb-4",children:[c.jsxDEV("div",{className:"flex items-center",children:[c.jsxDEV(x,{className:"w-8 h-8 text-green-400 mr-3"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:888,columnNumber:15},void 0),c.jsxDEV("h1",{className:"text-4xl font-bold text-green-400 font-mono",children:"å·¥åºç®¡ç†"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:889,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:887,columnNumber:13},void 0),c.jsxDEV(b,{to:"/dashboard",className:"flex items-center gap-2 px-3 py-2 sm:px-4 sm:py-2 bg-gradient-to-r from-gray-700 to-gray-800 hover:from-gray-600 hover:to-gray-700 text-green-300 hover:text-green-200 rounded-lg font-mono transition-all duration-200 shadow-md hover:shadow-lg border border-gray-600 hover:border-green-500/50",children:[c.jsxDEV(y,{className:"w-5 h-5"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:895,columnNumber:15},void 0),c.jsxDEV("span",{className:"hidden sm:inline",children:"è¿”å›æ§åˆ¶å°"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:896,columnNumber:15},void 0),c.jsxDEV("span",{className:"sm:hidden",children:"è¿”å›"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:897,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:891,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:886,columnNumber:11},void 0),c.jsxDEV("div",{className:"h-1 bg-gradient-to-r from-transparent via-green-400 to-transparent"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:900,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:885,columnNumber:9},void 0),c.jsxDEV("div",{className:"mb-6 space-y-4",children:[c.jsxDEV("div",{className:"flex flex-col sm:flex-row gap-4",children:c.jsxDEV("div",{className:"flex-1",children:c.jsxDEV("div",{className:"relative",children:[c.jsxDEV(v,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-green-400/60"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:908,columnNumber:17},void 0),c.jsxDEV("input",{type:"text",placeholder:"æœç´¢å·¥åºå†…å®¹ã€ç”Ÿäº§çº¿ã€äº§å“åç§°...",value:S,onChange:e=>{$(e.target.value),De(1)},className:"w-full bg-black border border-green-400/30 rounded px-10 py-2 text-green-400 placeholder-green-400/60 focus:outline-none focus:border-green-400"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:909,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:907,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:906,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:905,columnNumber:11},void 0),c.jsxDEV("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-4",children:[c.jsxDEV("button",{onClick:()=>K(!R),className:"flex items-center justify-center gap-1 sm:gap-2 px-2 sm:px-4 py-2 bg-green-600 hover:bg-green-500 text-black font-bold rounded transition-colors font-mono text-sm sm:text-base",children:[c.jsxDEV(f,{className:"w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:929,columnNumber:15},void 0),c.jsxDEV("span",{className:"hidden sm:inline",children:"ç­›é€‰"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:930,columnNumber:15},void 0),c.jsxDEV("span",{className:"sm:hidden",children:"ç­›é€‰"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:931,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:925,columnNumber:13},void 0),c.jsxDEV("button",{onClick:()=>{0===s.filter(e=>!e.unit_price||e.unit_price<=0).length?C.info("å½“å‰æ²¡æœ‰æœªå®šä»·çš„å·¥åº"):($(""),xe({production_line:"",production_category:"",product_name:""}),Y(""),Se(!Ie))},className:"flex items-center justify-center gap-1 sm:gap-2 px-2 sm:px-4 py-2 font-bold rounded transition-colors font-mono text-sm sm:text-base "+(Ie?"bg-red-600 hover:bg-red-500 text-white":"bg-orange-600 hover:bg-orange-500 text-white"),children:[c.jsxDEV(w,{className:"w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:952,columnNumber:15},void 0),c.jsxDEV("span",{className:"hidden sm:inline",children:Ie?"æ˜¾ç¤ºå…¨éƒ¨":"æœªå®šä»·å·¥åº"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:953,columnNumber:15},void 0),c.jsxDEV("span",{className:"sm:hidden",children:Ie?"å…¨éƒ¨":"æœªå®šä»·"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:954,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:933,columnNumber:13},void 0),c.jsxDEV("button",{onClick:()=>Ce(!0),className:"flex items-center justify-center gap-1 sm:gap-2 px-2 sm:px-4 py-2 bg-green-600 hover:bg-green-500 text-black font-bold rounded transition-colors font-mono text-sm sm:text-base",children:[c.jsxDEV(g,{className:"w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:960,columnNumber:15},void 0),c.jsxDEV("span",{className:"hidden sm:inline",children:"æ‰¹é‡å¯¼å…¥"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:961,columnNumber:15},void 0),c.jsxDEV("span",{className:"sm:hidden",children:"å¯¼å…¥"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:962,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:956,columnNumber:13},void 0),c.jsxDEV("button",{onClick:()=>{q||(ve?ye(i(a({},ve),{unit_price:""})):(()=>{const e=ze();ye({company_id:e,production_line:"",production_category:"",product_name:"",product_process:"",unit_price:"",effective_date:(new Date).toISOString().slice(0,7),work_time_type:"ç”Ÿäº§å·¥æ—¶"})})()),U(!q)},className:"flex items-center justify-center gap-1 sm:gap-2 px-2 sm:px-4 py-2 bg-green-600 hover:bg-green-500 text-black font-bold rounded transition-colors font-mono text-sm sm:text-base",children:[c.jsxDEV(k,{className:"w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:982,columnNumber:15},void 0),c.jsxDEV("span",{className:"hidden sm:inline",children:"æ·»åŠ å·¥åº"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:983,columnNumber:15},void 0),c.jsxDEV("span",{className:"sm:hidden",children:"æ·»åŠ "},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:984,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:964,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:924,columnNumber:11},void 0),R&&c.jsxDEV("div",{className:"bg-green-900/10 border border-green-400/30 rounded p-4",children:[c.jsxDEV("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[M(null==t?void 0:t.role)&&c.jsxDEV("div",{children:[c.jsxDEV("label",{className:"block text-sm font-medium text-green-400 mb-2",children:"å…¬å¸"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:995,columnNumber:21},void 0),c.jsxDEV("select",{value:Ne.company_id,onChange:e=>{xe(i(a({},Ne),{company_id:e.target.value})),De(1)},className:"w-full bg-black border border-green-400/30 rounded px-3 py-2 text-green-400 focus:outline-none focus:border-green-400",children:[c.jsxDEV("option",{value:"",children:"å…¨éƒ¨å…¬å¸"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1006,columnNumber:23},void 0),Qe.map(e=>c.jsxDEV("option",{value:e.id,children:e.name},e.id,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1008,columnNumber:25},void 0))]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:998,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:994,columnNumber:19},void 0),c.jsxDEV("div",{children:[c.jsxDEV("label",{className:"block text-sm font-medium text-green-400 mb-2",children:"ç”Ÿäº§çº¿"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1014,columnNumber:19},void 0),c.jsxDEV("select",{value:Ne.production_line,onChange:e=>{xe(i(a({},Ne),{production_line:e.target.value})),De(1)},className:"w-full bg-black border border-green-400/30 rounded px-3 py-2 text-green-400 focus:outline-none focus:border-green-400",children:[c.jsxDEV("option",{value:"",children:"å…¨éƒ¨ç”Ÿäº§çº¿"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1025,columnNumber:21},void 0),Re.map(e=>c.jsxDEV("option",{value:e,children:e},e,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1027,columnNumber:23},void 0))]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1017,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1013,columnNumber:17},void 0),c.jsxDEV("div",{children:[c.jsxDEV("label",{className:"block text-sm font-medium text-green-400 mb-2",children:"å·¥æ—¶ç±»å‹"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1032,columnNumber:19},void 0),c.jsxDEV("select",{value:Ne.production_category,onChange:e=>{xe(i(a({},Ne),{production_category:e.target.value})),De(1)},className:"w-full bg-black border border-green-400/30 rounded px-3 py-2 text-green-400 focus:outline-none focus:border-green-400",children:[c.jsxDEV("option",{value:"",children:"å…¨éƒ¨ç±»åˆ«"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1043,columnNumber:21},void 0),Ke.map(e=>c.jsxDEV("option",{value:e,children:e},e,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1045,columnNumber:23},void 0))]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1035,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1031,columnNumber:17},void 0),c.jsxDEV("div",{children:[c.jsxDEV("label",{className:"block text-sm font-medium text-green-400 mb-2",children:"äº§å“åç§°"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1050,columnNumber:19},void 0),c.jsxDEV("select",{value:Ne.product_name,onChange:e=>{xe(i(a({},Ne),{product_name:e.target.value})),De(1)},className:"w-full bg-black border border-green-400/30 rounded px-3 py-2 text-green-400 focus:outline-none focus:border-green-400",children:[c.jsxDEV("option",{value:"",children:"å…¨éƒ¨äº§å“"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1061,columnNumber:21},void 0),Xe.map(e=>c.jsxDEV("option",{value:e,children:e},e,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1063,columnNumber:23},void 0))]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1053,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1049,columnNumber:17},void 0),c.jsxDEV("div",{children:[c.jsxDEV("label",{className:"block text-sm font-medium text-green-400 mb-2",children:"äº§å“å·¥åº"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1068,columnNumber:19},void 0),c.jsxDEV("select",{value:Ne.product_process,onChange:e=>{xe(i(a({},Ne),{product_process:e.target.value})),De(1)},className:"w-full bg-black border border-green-400/30 rounded px-3 py-2 text-green-400 focus:outline-none focus:border-green-400",children:[c.jsxDEV("option",{value:"",children:"å…¨éƒ¨å·¥åº"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1079,columnNumber:21},void 0),Ze.map(e=>c.jsxDEV("option",{value:e,children:e},e,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1081,columnNumber:23},void 0))]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1071,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1067,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:991,columnNumber:15},void 0),c.jsxDEV("div",{className:"flex justify-start mt-4",children:c.jsxDEV("button",{onClick:()=>{xe({company_id:"",production_line:"",production_category:"",product_name:"",product_process:""}),$(""),Y(""),Se(!1),De(1)},className:"flex items-center space-x-2 bg-gray-900/20 border border-gray-400/30 px-4 py-2 rounded hover:bg-gray-900/30 transition-colors text-gray-400",children:[c.jsxDEV(u,{className:"w-4 h-4"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1097,columnNumber:19},void 0),c.jsxDEV("span",{children:"æ¸…é™¤ç­›é€‰"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1098,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1087,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1086,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:990,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:904,columnNumber:9},void 0),q&&c.jsxDEV("div",{className:"mb-6",children:c.jsxDEV(O,{title:`ä¸º ${(null==(e=null==t?void 0:t.company)?void 0:e.name)||"æœªè®¾ç½®å…¬å¸"} æ·»åŠ æ–°å·¥åº`,defaultExpanded:!0,className:"p-4 border border-green-400/30 rounded bg-green-900/10",children:[c.jsxDEV("div",{className:"space-y-4",children:[c.jsxDEV("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[c.jsxDEV("div",{className:"relative",children:[c.jsxDEV("label",{className:"block text-sm font-medium mb-2 text-green-400",children:["ç”Ÿäº§çº¿ ",c.jsxDEV("span",{className:"text-red-400",children:"*"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1118,columnNumber:88},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1118,columnNumber:19},void 0),c.jsxDEV("input",{type:"text",value:be.production_line,onChange:e=>Le("production_line",e.target.value),onFocus:()=>{be.production_line&&se.length>0&&ue(!0)},onBlur:()=>{setTimeout(()=>ue(!1),200)},className:"w-full bg-black border border-green-400/30 rounded px-3 py-2 text-green-400 focus:outline-none focus:border-green-400",placeholder:"è¯·è¾“å…¥ç”Ÿäº§çº¿"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1119,columnNumber:19},void 0),ce&&se.length>0&&c.jsxDEV("div",{className:"absolute z-10 w-full mt-1 bg-gray-800 border border-green-400/30 rounded-md shadow-lg max-h-40 overflow-y-auto",children:se.map((e,t)=>c.jsxDEV("div",{onClick:()=>Fe("production_line",e),className:"px-3 py-2 text-green-400 hover:bg-green-900/20 cursor-pointer border-b border-green-400/10 last:border-b-0",children:e},t,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1137,columnNumber:25},void 0))},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1135,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1117,columnNumber:17},void 0),c.jsxDEV("div",{children:[c.jsxDEV("label",{className:"block text-sm font-medium mb-2 text-green-400",children:["å·¥æ—¶ç±»å‹ ",c.jsxDEV("span",{className:"text-red-400",children:"*"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1149,columnNumber:89},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1149,columnNumber:19},void 0),c.jsxDEV("select",{value:be.work_time_type,onChange:e=>ye(i(a({},be),{work_time_type:e.target.value})),className:"w-full bg-black border border-green-400/30 rounded px-3 py-2 text-green-400 focus:outline-none focus:border-green-400",children:[c.jsxDEV("option",{value:"ç”Ÿäº§å·¥æ—¶",children:"ç”Ÿäº§å·¥æ—¶"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1155,columnNumber:21},void 0),c.jsxDEV("option",{value:"éç”Ÿäº§å·¥æ—¶",children:"éç”Ÿäº§å·¥æ—¶"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1156,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1150,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1148,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1116,columnNumber:15},void 0),c.jsxDEV("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[c.jsxDEV("div",{className:"relative",children:[c.jsxDEV("label",{className:"block text-sm font-medium mb-2 text-green-400",children:["äº§å“åç§° ",c.jsxDEV("span",{className:"text-red-400",children:"*"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1164,columnNumber:89},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1164,columnNumber:19},void 0),c.jsxDEV("input",{type:"text",value:be.product_name,onChange:e=>Le("product_name",e.target.value),onFocus:()=>{be.product_name&&oe.length>0&&ge(!0)},onBlur:()=>{setTimeout(()=>ge(!1),200)},className:"w-full bg-black border border-green-400/30 rounded px-3 py-2 text-green-400 focus:outline-none focus:border-green-400",placeholder:"è¯·è¾“å…¥äº§å“åç§°"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1165,columnNumber:19},void 0),de&&oe.length>0&&c.jsxDEV("div",{className:"absolute z-10 w-full mt-1 bg-gray-800 border border-green-400/30 rounded-md shadow-lg max-h-40 overflow-y-auto",children:oe.map((e,t)=>c.jsxDEV("div",{onClick:()=>Fe("product_name",e),className:"px-3 py-2 text-green-400 hover:bg-green-900/20 cursor-pointer border-b border-green-400/10 last:border-b-0",children:e},t,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1183,columnNumber:23},void 0))},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1181,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1163,columnNumber:17},void 0),c.jsxDEV("div",{className:"relative",children:[c.jsxDEV("label",{className:"block text-sm font-medium mb-2 text-green-400",children:["äº§å“å·¥åº ",c.jsxDEV("span",{className:"text-red-400",children:"*"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1195,columnNumber:89},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1195,columnNumber:19},void 0),c.jsxDEV("input",{type:"text",value:be.product_process,onChange:e=>Le("product_process",e.target.value),onFocus:()=>{be.product_process&&ie.length>0&&pe(!0)},onBlur:()=>{setTimeout(()=>pe(!1),200)},className:"w-full bg-black border border-green-400/30 rounded px-3 py-2 text-green-400 focus:outline-none focus:border-green-400",placeholder:"è¯·è¾“å…¥äº§å“å·¥åº"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1196,columnNumber:19},void 0),he&&ie.length>0&&c.jsxDEV("div",{className:"absolute z-10 w-full mt-1 bg-gray-800 border border-green-400/30 rounded-md shadow-lg max-h-40 overflow-y-auto",children:ie.map((e,t)=>c.jsxDEV("div",{onClick:()=>Fe("product_process",e),className:"px-3 py-2 text-green-400 hover:bg-green-900/20 cursor-pointer border-b border-green-400/10 last:border-b-0",children:e},t,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1214,columnNumber:25},void 0))},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1212,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1194,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1162,columnNumber:15},void 0),c.jsxDEV("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[c.jsxDEV("div",{children:[c.jsxDEV("label",{className:"block text-sm font-medium mb-2 text-green-400",children:"å•ä»·ï¼ˆå¯é€‰ï¼‰"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1230,columnNumber:19},void 0),c.jsxDEV("input",{type:"number",step:"0.01",value:be.unit_price,onChange:e=>ye(i(a({},be),{unit_price:e.target.value})),onWheel:e=>e.currentTarget.blur(),className:"w-full bg-black border border-green-400/30 rounded px-3 py-2 text-green-400 focus:outline-none focus:border-green-400 [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none [-moz-appearance:textfield]",placeholder:"è¯·è¾“å…¥å•ä»·"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1231,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1229,columnNumber:17},void 0),c.jsxDEV("div",{children:[c.jsxDEV("label",{className:"block text-sm font-medium mb-2 text-green-400",children:"ç”Ÿæ•ˆå¹´æœˆ"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1242,columnNumber:19},void 0),c.jsxDEV("input",{type:"month",value:be.effective_date,onChange:e=>ye(i(a({},be),{effective_date:e.target.value})),className:"w-full bg-black border border-green-400/30 rounded px-3 py-2 text-green-400 focus:outline-none focus:border-green-400"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1243,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1241,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1228,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1114,columnNumber:13},void 0),c.jsxDEV("div",{className:"flex space-x-4 mt-4",children:[c.jsxDEV("button",{type:"button",onClick:()=>l(void 0,null,function*(){var e,m;if(!t)return C.error("ç”¨æˆ·æœªç™»å½•ï¼Œè¯·é‡æ–°ç™»å½•"),void n("/login");const o=null==(e=t.company)?void 0:e.id;if(!M(t.role)&&!o)return void C.error("ç”¨æˆ·æ²¡æœ‰å…³è”çš„å…¬å¸ï¼Œè¯·è”ç³»ç®¡ç†å‘˜");if(!be.production_line.trim())return void C.error("è¯·å¡«å†™ç”Ÿäº§çº¿");if(!be.product_name.trim())return void C.error("è¯·å¡«å†™äº§å“åç§°");if(!be.product_process.trim())return void C.error("è¯·å¡«å†™äº§å“å·¥åº");const l=M(t.role)?be.company_id:o;if(!l)return void C.error("è¯·é€‰æ‹©å…¬å¸");console.log("=== å¼€å§‹æ·»åŠ å·¥åº ==="),console.log("å½“å‰è¡¨å•æ•°æ®:",{company_id:l,production_line:be.production_line.trim(),work_time_type:be.work_time_type,product_name:be.product_name.trim(),product_process:be.product_process.trim()}),console.log("ç°æœ‰å·¥åºæ•°æ®:",s.map(e=>({id:e.id,company_id:e.company_id,production_line:e.production_line,production_category:e.production_category,product_name:e.product_name,product_process:e.product_process}))),console.log("å·¥åºæ€»æ•°:",s.length);const c=s.find(e=>{const t=e.company_id===l&&e.production_line.trim()===be.production_line.trim()&&e.production_category===be.work_time_type&&e.product_name.trim()===be.product_name.trim()&&e.product_process.trim()===be.product_process.trim();return t&&console.log("æ‰¾åˆ°é‡å¤å·¥åº:",e),t});if(console.log("é‡å¤æ£€æŸ¥ç»“æœ:",c?"å‘ç°é‡å¤":"æ— é‡å¤"),c)return console.log("æ˜¾ç¤ºé‡å¤æç¤º"),void C.error("è¯¥å·¥åºå·²å­˜åœ¨ï¼Œè¯·æ£€æŸ¥è¾“å…¥ä¿¡æ¯ï¼",{duration:4e3,style:{fontSize:"16px",fontWeight:"bold"}});try{const e={company_id:l,production_line:be.production_line,production_category:be.work_time_type,product_name:be.product_name,product_process:be.product_process,unit_price:be.unit_price&&""!==be.unit_price.trim()?parseFloat(be.unit_price):null,effective_date:be.effective_date?`${be.effective_date}-01`:null,is_active:!0},{data:t,error:n}=yield V.from("processes").insert(e).select("\n          *,\n          companies!inner(\n            name\n          )\n        ").single();if(n)return void C.error(`æ·»åŠ å·¥åºå¤±è´¥: ${n.message}`);const o=i(a({},t),{company_name:(null==(m=t.companies)?void 0:m.name)||"æœªçŸ¥å…¬å¸"});r([o,...s]),fe(a({},be)),ye(i(a({},be),{product_process:""})),U(!1),C.success("å·¥åºæ·»åŠ æˆåŠŸ")}catch(u){C.error(`æ·»åŠ å·¥åºå¤±è´¥: ${u.message||"æœªçŸ¥é”™è¯¯"}`)}}),className:"bg-green-900/20 border border-green-400/30 px-4 py-2 rounded hover:bg-green-900/30 transition-colors text-green-400",children:"ç¡®è®¤æ·»åŠ "},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1253,columnNumber:15},void 0),c.jsxDEV("button",{onClick:()=>{U(!1);const e=ze();ye({company_id:e,production_line:"",production_category:"",product_name:"",product_process:"",unit_price:"",effective_date:(new Date).toISOString().slice(0,7),work_time_type:"ç”Ÿäº§å·¥æ—¶"})},className:"border border-green-400/30 px-4 py-2 rounded hover:bg-green-900/20 transition-colors text-green-400",children:"å–æ¶ˆ"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1258,columnNumber:15},void 0),c.jsxDEV("button",{onClick:()=>{const e=ze();ye({company_id:e,production_line:"",production_category:"",product_name:"",product_process:"",unit_price:"",effective_date:(new Date).toISOString().slice(0,7),work_time_type:"ç”Ÿäº§å·¥æ—¶"}),C.success("è¡¨å•å†…å®¹å·²æ¸…é™¤")},className:"bg-red-900/20 border border-red-400/30 px-4 py-2 rounded hover:bg-red-900/30 transition-colors text-red-400",children:"æ¸…é™¤å†…å®¹"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1277,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1252,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1108,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1107,columnNumber:11},void 0),G&&J&&c.jsxDEV("div",{className:"mb-6",children:c.jsxDEV(O,{title:"ç¼–è¾‘å·¥åº",defaultExpanded:!0,className:"bg-gray-800 border border-green-500 rounded-lg p-6",children:[c.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[c.jsxDEV("div",{children:[c.jsxDEV("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["å…¬å¸ ",c.jsxDEV("span",{className:"text-red-400",children:"*"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1312,columnNumber:22},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1311,columnNumber:17},void 0),c.jsxDEV("select",{value:be.company_id,onChange:e=>ye(i(a({},be),{company_id:e.target.value})),className:"w-full bg-black border border-green-400/30 rounded px-3 py-2 text-green-400 focus:outline-none focus:border-green-400",children:[c.jsxDEV("option",{value:"",children:"è¯·é€‰æ‹©å…¬å¸"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1319,columnNumber:19},void 0),o.map(e=>c.jsxDEV("option",{value:e.id,children:e.name},e.id,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1321,columnNumber:21},void 0))]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1314,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1310,columnNumber:15},void 0),c.jsxDEV("div",{children:[c.jsxDEV("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["ç”Ÿäº§çº¿ ",c.jsxDEV("span",{className:"text-red-400",children:"*"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1329,columnNumber:23},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1328,columnNumber:17},void 0),c.jsxDEV("input",{type:"text",value:be.production_line,onChange:e=>ye(i(a({},be),{production_line:e.target.value})),className:"w-full bg-black border border-green-400/30 rounded px-3 py-2 text-green-400 focus:outline-none focus:border-green-400",placeholder:"è¯·è¾“å…¥ç”Ÿäº§çº¿"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1331,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1327,columnNumber:15},void 0),c.jsxDEV("div",{children:[c.jsxDEV("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["å·¥æ—¶ç±»å‹ ",c.jsxDEV("span",{className:"text-red-400",children:"*"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1341,columnNumber:24},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1340,columnNumber:17},void 0),c.jsxDEV("select",{value:be.work_time_type,onChange:e=>ye(i(a({},be),{work_time_type:e.target.value})),className:"w-full bg-black border border-green-400/30 rounded px-3 py-2 text-green-400 focus:outline-none focus:border-green-400",children:[c.jsxDEV("option",{value:"ç”Ÿäº§å·¥æ—¶",children:"ç”Ÿäº§å·¥æ—¶"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1348,columnNumber:19},void 0),c.jsxDEV("option",{value:"éç”Ÿäº§å·¥æ—¶",children:"éç”Ÿäº§å·¥æ—¶"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1349,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1343,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1339,columnNumber:15},void 0),c.jsxDEV("div",{children:[c.jsxDEV("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["äº§å“åç§° ",c.jsxDEV("span",{className:"text-red-400",children:"*"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1354,columnNumber:24},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1353,columnNumber:17},void 0),c.jsxDEV("input",{type:"text",value:be.product_name,onChange:e=>ye(i(a({},be),{product_name:e.target.value})),className:"w-full bg-black border border-green-400/30 rounded px-3 py-2 text-green-400 focus:outline-none focus:border-green-400",placeholder:"è¯·è¾“å…¥äº§å“åç§°"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1356,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1352,columnNumber:15},void 0),c.jsxDEV("div",{children:[c.jsxDEV("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["äº§å“å·¥åº ",c.jsxDEV("span",{className:"text-red-400",children:"*"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1366,columnNumber:24},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1365,columnNumber:17},void 0),c.jsxDEV("input",{type:"text",value:be.product_process,onChange:e=>ye(i(a({},be),{product_process:e.target.value})),className:"w-full bg-black border border-green-400/30 rounded px-3 py-2 text-green-400 focus:outline-none focus:border-green-400",placeholder:"è¯·è¾“å…¥äº§å“å·¥åº"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1368,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1364,columnNumber:15},void 0),c.jsxDEV("div",{children:[c.jsxDEV("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"å•ä»·"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1377,columnNumber:17},void 0),c.jsxDEV("input",{type:"number",step:"0.001",value:be.unit_price,onChange:e=>ye(i(a({},be),{unit_price:e.target.value})),onWheel:e=>e.currentTarget.blur(),className:"w-full bg-black border border-green-400/30 rounded px-3 py-2 text-green-400 focus:outline-none focus:border-green-400 [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none [-moz-appearance:textfield]",placeholder:"è¯·è¾“å…¥å•ä»·ï¼ˆç²¾ç¡®åˆ°å°æ•°ç‚¹åä¸‰ä½ï¼‰"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1380,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1376,columnNumber:15},void 0),c.jsxDEV("div",{children:[c.jsxDEV("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"ç”Ÿæ•ˆå¹´æœˆ"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1391,columnNumber:17},void 0),c.jsxDEV("input",{type:"month",value:be.effective_date,onChange:e=>ye(i(a({},be),{effective_date:e.target.value})),className:"w-full bg-black border border-green-400/30 rounded px-3 py-2 text-green-400 focus:outline-none focus:border-green-400"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1394,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1390,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1309,columnNumber:13},void 0),c.jsxDEV("div",{className:"flex justify-end space-x-3 mt-4",children:[c.jsxDEV("button",{onClick:()=>{H(!1),Q(null),ye({company_id:"",production_line:"",production_category:"",product_name:"",product_process:"",unit_price:"",effective_date:(new Date).toISOString().slice(0,7),work_time_type:"ç”Ÿäº§å·¥æ—¶"})},className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors",children:"å–æ¶ˆ"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1403,columnNumber:15},void 0),c.jsxDEV("button",{onClick:()=>l(void 0,null,function*(){var e,m,o;if(!J)return;if(!t)return C.error("ç”¨æˆ·æœªç™»å½•ï¼Œè¯·é‡æ–°ç™»å½•"),void n("/login");if(!M(t.role)&&J.company_id!==(null==(e=t.company)?void 0:e.id))return void C.error("æ‚¨åªèƒ½ç¼–è¾‘è‡ªå·±å…¬å¸çš„å·¥åº");if(!M(t.role)&&be.company_id!==(null==(m=t.company)?void 0:m.id))return void C.error("æ‚¨åªèƒ½å°†å·¥åºåˆ†é…ç»™è‡ªå·±çš„å…¬å¸");if(!be.company_id)return void C.error("è¯·é€‰æ‹©å…¬å¸");if(!be.production_line.trim())return void C.error("è¯·è¾“å…¥ç”Ÿäº§çº¿");if(!be.product_name.trim())return void C.error("è¯·è¾“å…¥äº§å“åç§°");if(s.find(e=>e.id!==J.id&&e.company_id===be.company_id&&e.production_line.trim()===be.production_line.trim()&&e.production_category===be.work_time_type&&e.product_name.trim()===be.product_name.trim()&&e.product_process.trim()===be.product_process.trim()))C.error("è¯¥å·¥åºå·²å­˜åœ¨ï¼Œè¯·æ£€æŸ¥è¾“å…¥ä¿¡æ¯ï¼",{duration:4e3,style:{fontSize:"16px",fontWeight:"bold"}});else try{const{data:e,error:t}=yield V.from("processes").update({company_id:be.company_id,production_line:be.production_line,production_category:be.work_time_type,product_name:be.product_name,product_process:be.product_process,unit_price:be.unit_price?parseFloat(be.unit_price):null,effective_date:be.effective_date?`${be.effective_date}-01`:null}).eq("id",J.id).select("\n          *,\n          companies!inner(\n            name\n          )\n        ").single();if(t)return void C.error("æ›´æ–°å·¥åºå¤±è´¥");const m=i(a({},e),{company_name:(null==(o=e.companies)?void 0:o.name)||"æœªçŸ¥å…¬å¸"});r(s.map(e=>e.id===J.id?m:e)),fe(a({},be)),H(!1),Q(null),C.success("å·¥åºæ›´æ–°æˆåŠŸ")}catch(l){C.error("æ›´æ–°å·¥åºå¤±è´¥")}}),className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:"æ›´æ–°"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1422,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1402,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1304,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1303,columnNumber:11},void 0),c.jsxDEV("div",{className:"bg-gray-900 border border-green-400 rounded-lg overflow-hidden",children:p?c.jsxDEV("div",{className:"p-8 text-center text-green-400/60",children:c.jsxDEV("div",{className:"animate-pulse",children:"åŠ è½½ä¸­..."},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1438,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1437,columnNumber:13},void 0):0===We.length?c.jsxDEV("div",{className:"p-8 text-center text-green-400/60",children:S?"æœªæ‰¾åˆ°åŒ¹é…çš„å·¥åº":"æš‚æ— å·¥åºæ•°æ®"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1441,columnNumber:13},void 0):c.jsxDEV("div",{className:"overflow-x-auto",children:c.jsxDEV("table",{className:"w-full",children:[c.jsxDEV("thead",{className:"bg-green-900/30",children:c.jsxDEV("tr",{children:[c.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"åºå·"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1449,columnNumber:21},void 0),c.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"å…¬å¸"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1452,columnNumber:21},void 0),c.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"ç”Ÿäº§çº¿"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1455,columnNumber:21},void 0),c.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"å·¥æ—¶ç±»å‹"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1458,columnNumber:21},void 0),c.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"äº§å“åç§°"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1459,columnNumber:21},void 0),c.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"äº§å“å·¥åº"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1462,columnNumber:21},void 0),c.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"å•ä»·"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1465,columnNumber:21},void 0),c.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"ç”Ÿæ•ˆå¹´æœˆ"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1468,columnNumber:21},void 0),c.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"æ“ä½œ"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1471,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1448,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1447,columnNumber:17},void 0),c.jsxDEV("tbody",{className:"divide-y divide-green-800",children:He.map((e,t)=>c.jsxDEV("tr",{className:"hover:bg-green-900/10",children:[c.jsxDEV("td",{className:"px-4 py-3 whitespace-nowrap",children:c.jsxDEV("span",{className:"text-sm font-mono text-green-300",children:Ue+t+1},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1480,columnNumber:25},void 0)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1479,columnNumber:23},void 0),c.jsxDEV("td",{className:"px-4 py-3 whitespace-nowrap",children:c.jsxDEV("span",{className:"text-sm font-mono text-green-300",title:e.company_name,children:e.company_name},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1485,columnNumber:25},void 0)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1484,columnNumber:23},void 0),c.jsxDEV("td",{className:"px-4 py-3 whitespace-nowrap",children:c.jsxDEV("span",{className:"text-sm font-mono text-green-300",title:e.production_line,children:e.production_line},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1490,columnNumber:25},void 0)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1489,columnNumber:23},void 0),c.jsxDEV("td",{className:"px-4 py-3 whitespace-nowrap",children:c.jsxDEV("span",{className:"text-sm font-mono text-green-300",title:e.production_category||"-",children:e.production_category||"-"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1495,columnNumber:25},void 0)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1494,columnNumber:23},void 0),c.jsxDEV("td",{className:"px-4 py-3 whitespace-nowrap",children:c.jsxDEV("span",{className:"text-sm font-mono text-green-300",title:e.product_name,children:e.product_name},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1500,columnNumber:25},void 0)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1499,columnNumber:23},void 0),c.jsxDEV("td",{className:"px-4 py-3 whitespace-nowrap",children:c.jsxDEV("span",{className:"text-sm font-mono text-green-300",title:e.product_process||"-",children:e.product_process||"-"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1505,columnNumber:25},void 0)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1504,columnNumber:23},void 0),c.jsxDEV("td",{className:"px-4 py-3 whitespace-nowrap",children:c.jsxDEV("span",{className:"text-sm font-mono "+(null==e.unit_price||void 0===e.unit_price?"text-red-400 font-bold":"text-green-300"),title:null!=e.unit_price?`Â¥${e.unit_price.toFixed(3)}`:"æœªå®šä»·",children:null!=e.unit_price?`Â¥${e.unit_price.toFixed(3)}`:"æœªå®šä»·"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1510,columnNumber:25},void 0)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1509,columnNumber:23},void 0),c.jsxDEV("td",{className:"px-4 py-3 whitespace-nowrap",children:c.jsxDEV("span",{className:"text-sm font-mono text-green-300",title:e.effective_date,children:e.effective_date?e.effective_date.substring(0,7):""},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1515,columnNumber:25},void 0)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1514,columnNumber:23},void 0),c.jsxDEV("td",{className:"px-4 py-3 whitespace-nowrap",children:c.jsxDEV("div",{className:"flex justify-center space-x-1",children:[c.jsxDEV("button",{onClick:()=>(e=>{var t;Q(e);let m="";m=e.effective_date?e.effective_date.includes("-")&&e.effective_date.length>=7?e.effective_date.substring(0,7):e.effective_date:(new Date).toISOString().slice(0,7),ye({company_id:e.company_id,production_line:e.production_line,production_category:e.production_category,product_name:e.product_name,product_process:e.product_process,unit_price:(null==(t=e.unit_price)?void 0:t.toString())||"",effective_date:m,work_time_type:e.production_category}),H(!0)})(e),className:"p-1 text-blue-400/60 hover:text-blue-400 hover:bg-blue-900/20 rounded transition-colors",title:"ç¼–è¾‘å·¥åº",children:c.jsxDEV(E,{className:"w-3 h-3"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1526,columnNumber:29},void 0)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1521,columnNumber:27},void 0),c.jsxDEV("button",{onClick:t=>{t.preventDefault(),t.stopPropagation(),Me(e),ke(!0)},className:"p-1 text-red-400/60 hover:text-red-400 hover:bg-red-900/20 rounded transition-colors",title:"åˆ é™¤å·¥åº",children:c.jsxDEV(D,{className:"w-3 h-3"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1538,columnNumber:29},void 0)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1528,columnNumber:27},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1520,columnNumber:25},void 0)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1519,columnNumber:23},void 0)]},e.id,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1478,columnNumber:21},void 0))},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1476,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1446,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1445,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1434,columnNumber:9},void 0),c.jsxDEV("div",{className:"mt-6 text-center text-green-400/60 text-sm",children:["å…± ",We.length," ä¸ªå·¥åº",S&&` (ä» ${s.length} ä¸ªå·¥åºä¸­ç­›é€‰)`,Ie&&c.jsxDEV("span",{className:"ml-2 text-red-400 font-bold",children:"(æ˜¾ç¤ºæœªå®šä»·å·¥åº)"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1555,columnNumber:13},void 0),!Ie&&c.jsxDEV("span",{className:"ml-2 text-orange-400",children:["(æœªå®šä»·: ",s.filter(e=>null==e.unit_price||void 0===e.unit_price).length," ä¸ª)"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1560,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1551,columnNumber:9},void 0),qe>1&&c.jsxDEV("div",{className:"mt-6 flex flex-col sm:flex-row items-center justify-between gap-4",children:[c.jsxDEV("div",{className:"flex items-center gap-2 text-sm text-green-400",children:[c.jsxDEV("span",{children:"æ¯é¡µæ˜¾ç¤º:"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1571,columnNumber:15},void 0),c.jsxDEV("select",{value:_e,onChange:e=>{je(Number(e.target.value)),De(1)},className:"bg-gray-800 border border-green-400/30 rounded px-2 py-1 text-green-400 focus:outline-none focus:border-green-400",children:[c.jsxDEV("option",{value:10,children:"10"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1580,columnNumber:17},void 0),c.jsxDEV("option",{value:20,children:"20"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1581,columnNumber:17},void 0),c.jsxDEV("option",{value:50,children:"50"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1582,columnNumber:17},void 0),c.jsxDEV("option",{value:100,children:"100"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1583,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1572,columnNumber:15},void 0),c.jsxDEV("span",{children:"æ¡"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1585,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1570,columnNumber:13},void 0),c.jsxDEV("div",{className:"text-sm text-green-400/60",children:["æ˜¾ç¤ºç¬¬ ",Ue+1," - ",Math.min(Ge,Ye)," æ¡ï¼Œå…± ",Ye," æ¡"]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1589,columnNumber:13},void 0),c.jsxDEV("div",{className:"flex items-center gap-2",children:[c.jsxDEV("button",{onClick:()=>De(1),disabled:1===Ee,className:"px-3 py-1 bg-gray-800 border border-green-400/30 rounded text-green-400 hover:bg-green-900/20 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"é¦–é¡µ"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1595,columnNumber:15},void 0),c.jsxDEV("button",{onClick:()=>De(e=>Math.max(1,e-1)),disabled:1===Ee,className:"px-3 py-1 bg-gray-800 border border-green-400/30 rounded text-green-400 hover:bg-green-900/20 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"ä¸Šä¸€é¡µ"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1602,columnNumber:15},void 0),c.jsxDEV("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,qe)},(e,t)=>{let m;return m=qe<=5||Ee<=3?t+1:Ee>=qe-2?qe-4+t:Ee-2+t,c.jsxDEV("button",{onClick:()=>De(m),className:"px-3 py-1 border rounded transition-colors "+(Ee===m?"bg-green-600 border-green-600 text-white":"bg-gray-800 border-green-400/30 text-green-400 hover:bg-green-900/20"),children:m},m,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1625,columnNumber:21},void 0)})},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1611,columnNumber:15},void 0),c.jsxDEV("button",{onClick:()=>De(e=>Math.min(qe,e+1)),disabled:Ee===qe,className:"px-3 py-1 bg-gray-800 border border-green-400/30 rounded text-green-400 hover:bg-green-900/20 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"ä¸‹ä¸€é¡µ"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1640,columnNumber:15},void 0),c.jsxDEV("button",{onClick:()=>De(qe),disabled:Ee===qe,className:"px-3 py-1 bg-gray-800 border border-green-400/30 rounded text-green-400 hover:bg-green-900/20 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"æœ«é¡µ"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1647,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1594,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1568,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:883,columnNumber:7},void 0),c.jsxDEV(B,{isOpen:we,title:"ç¡®è®¤åˆ é™¤",message:Ve?`ç¡®å®šè¦åˆ é™¤å·¥åº"${Ve.product_name}"å—ï¼Ÿ\n\næ­¤æ“ä½œä¸å¯æ’¤é”€ï¼`:"",onConfirm:()=>{var e;Ve&&(e=Ve.id,l(void 0,null,function*(){var m;if(!t)return C.error("ç”¨æˆ·æœªç™»å½•ï¼Œè¯·é‡æ–°ç™»å½•"),void n("/login");const o=s.find(t=>t.id===e);if(o)if(M(t.role)||o.company_id===(null==(m=t.company)?void 0:m.id))try{const{error:t}=yield V.from("processes").update({is_active:!1}).eq("id",e);if(t)return void C.error(`åˆ é™¤å·¥åºå¤±è´¥: ${t.message}`);r(s.filter(t=>t.id!==e)),C.success("å·¥åºåˆ é™¤æˆåŠŸ")}catch(a){C.error("åˆ é™¤å·¥åºå¤±è´¥")}else C.error("æ‚¨åªèƒ½åˆ é™¤è‡ªå·±å…¬å¸çš„å·¥åº");else C.error("å·¥åºä¸å­˜åœ¨")}),ke(!1),Me(null))},onCancel:()=>{ke(!1),Me(null)},confirmText:"åˆ é™¤",cancelText:"å–æ¶ˆ",type:"danger"},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1660,columnNumber:7},void 0),c.jsxDEV(L,{isOpen:Pe,onClose:()=>Ce(!1),onImport:e=>l(void 0,null,function*(){var m,s;if(!t)return C.error("ç”¨æˆ·æœªç™»å½•ï¼Œè¯·é‡æ–°ç™»å½•"),void n("/login");let o=0,l=0;const c=[];try{const n=null==(m=t.company)?void 0:m.id;if(!M(t.role)&&!n)return void C.error("æ— æ³•è·å–ç”¨æˆ·å…¬å¸ä¿¡æ¯");const g=[],h=100;for(let m=0;m<e.length;m++){const s=e[m];if(!M(t.role)&&s.company_id!==n){c.push(`ç¬¬ ${m+1} è¡Œ: æ‚¨åªèƒ½å¯¼å…¥è‡ªå·±å…¬å¸çš„å·¥åº`),l++;continue}const r={company_id:M(t.role)?s.company_id:n,production_line:s.production_line,production_category:s.production_category,product_name:s.product_name,product_process:s.product_process,unit_price:s.unit_price,effective_date:s.effective_date?s.effective_date.match(/^\d{4}-\d{2}$/)?`${s.effective_date}-01`:s.effective_date:null,is_active:!0};g.push(r)}if(0===g.length)return void C.error("æ²¡æœ‰æœ‰æ•ˆçš„æ•°æ®å¯ä»¥å¯¼å…¥");for(let e=0;e<g.length;e+=h){const t=g.slice(e,e+h);try{const{data:m,error:n}=yield V.from("processes").insert(t).select("\n              *,\n              companies!inner(\n                name\n              )\n            ");if(n){console.warn("æ‰¹é‡æ’å…¥å¤±è´¥ï¼Œå°è¯•é€æ¡æ’å…¥:",n);for(let m=0;m<t.length;m++)try{const{data:n,error:u}=yield V.from("processes").insert(t[m]).select("\n                    *,\n                    companies!inner(\n                      name\n                    )\n                  ").single();if(u)c.push(`ç¬¬ ${e+m+1} è¡Œ: ${u.message}`),l++;else{const e=i(a({},n),{company_name:(null==(s=n.companies)?void 0:s.name)||"æœªçŸ¥å…¬å¸"});r(t=>[e,...t]),o++}}catch(u){c.push(`ç¬¬ ${e+m+1} è¡Œ: ${u.message||"æœªçŸ¥é”™è¯¯"}`),l++}}else{const e=m.map(e=>{var t;return i(a({},e),{company_name:(null==(t=e.companies)?void 0:t.name)||"æœªçŸ¥å…¬å¸"})});r(t=>[...e,...t]),o+=m.length}}catch(d){console.error("æ‰¹æ¬¡å¤„ç†é”™è¯¯:",d),c.push(`æ‰¹æ¬¡ ${Math.floor(e/h)+1} å¤„ç†å¤±è´¥: ${d.message||"æœªçŸ¥é”™è¯¯"}`),l+=t.length}}o>0&&0===l?C.success(`æ‰¹é‡å¯¼å…¥æˆåŠŸï¼å…±å¯¼å…¥ ${o} æ¡å·¥åº`):o>0&&l>0?(C.warning(`éƒ¨åˆ†å¯¼å…¥æˆåŠŸï¼æˆåŠŸ ${o} æ¡ï¼Œå¤±è´¥ ${l} æ¡`),c.length>0&&console.warn("å¯¼å…¥é”™è¯¯è¯¦æƒ…:",c.slice(0,10))):(C.error(`å¯¼å…¥å¤±è´¥ï¼å…± ${l} æ¡æ•°æ®å¯¼å…¥å¤±è´¥`),c.length>0&&console.error("å¯¼å…¥é”™è¯¯è¯¦æƒ…:",c.slice(0,10)))}catch(g){console.error("æ‰¹é‡å¯¼å…¥å¤±è´¥:",g),C.error(`æ‰¹é‡å¯¼å…¥å¤±è´¥: ${g.message||"æœªçŸ¥é”™è¯¯"}`)}}),companies:o,currentUser:t,existingProcesses:s},void 0,!1,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:1681,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/runner/work/timesheet-management-system/timesheet-management-system/src/pages/ProcessManagement.tsx",lineNumber:882,columnNumber:5},void 0)};export{F as default};
